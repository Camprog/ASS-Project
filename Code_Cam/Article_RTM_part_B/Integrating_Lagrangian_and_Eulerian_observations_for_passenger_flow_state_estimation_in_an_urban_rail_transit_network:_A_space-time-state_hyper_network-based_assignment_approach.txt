"Transportation Research Part B: MethodologicalIntegrating Lagrangian and Eulerian observations for passenger flow state estimation in an urban rail transit network: A space-time-state hyper network-based assignment approachAbstract In this study, we focus on one of practically important research problems of integrating Lagrangian and Eulerian observations for passenger flow state estimation in an urban rail transit network. The task is accomplished by using a triple of flow, density, and speed to construct a discretized passenger flow state, further constructing a space-time-state (STS) hyper network so that we can utilize a better defined three-dimensional solution space to integrate structurally heterogeneous data sources. The monitoring data include passenger transaction records and identification space-time samples observed over a possible range of a few hours from origins to destinations (Lagrangian observations), and time-dependent passenger counts collected at some key bottleneck locations (Eulerian observations). To describe the complex urban-rail passenger flow evolution, passenger traveling and fixed sensor state transition processes can be unified within a STS path representation. To estimate the consistent system internal states between two different types of observations, we formulate a hyper network-based flow assignment model in a generalized least squares estimation framework. For applications in large-scale transportation networks, we decompose the proposed model into three easy-to-solve sub-problems. The proposed model is applied to a real-world case based on the Beijing subway network with complete smart card data for each passenger at his/her origin and destination and time-dependent passenger counts in several key transfer corridors, while the specific space-time trajectories of all passengers and high-resolution time-dependent congestion levels at platforms, in trains, and in transfer corridors are estimated. This proposed passenger flow state inference method can provide a rich set of state inferences for advanced transit planning and management applications, for instance, passenger flow control, adaptive travel demand management, and real-time train scheduling.serial JL 271728 291210 291772 291817 31 Transportation Research Part B: Methodological TRANSPORTATIONRESEARCHPARTBMETHODOLOGICAL 2019-01-19 2019-01-19 2019-01-19 2019-01-19 2019-05-06T08:43:25 1-s2.0-S0191261518304983 S0191-2615(18)30498-3 S0191261518304983 10.1016/j.trb.2018.12.015 S300 S300.2 FULL-TEXT 1-s2.0-S0191261519X00028 2019-05-06T07:57:29.560103Z 0 0 20190301 20190331 2019 2019-01-19T11:27:21.748285Z articleinfo articletitlenorm authfirstinitialnorm authfirstsurnamenorm cid cids contenttype copyright crossmark dateloaded dateloadedtxt datesearch datesort dateupdated dco docsubtype doctype doi eid ewtransactionid hubeid indexeddate issn issnnorm itemstage itemtransactionid itemweight openaccess openarchive pg pgfirst pglast pii piinorm pubdateend pubdatestart pubdatetxt pubyr sectiontitle sortorder srctitle srctitlenorm srctype ssids alllist content subj subheadings suppl tomb volfirst volissue volumelist webpdf webpdfpagecount yearnav figure table body mmlmath acknowledge affil appendices articletitle auth authfirstini authfull authkeywords authlast grantnumber grantsponsor grantsponsorid highlightsabst orcid primabst ref 0191-2615 01912615 true 121 121 C Volume 121 9 135 167 135 167 201903 March 2019 2019-03-01 2019-03-31 2019 Research papers article fla \u00a9 2018 Published by Elsevier Ltd. INTEGRATINGLAGRANGIANEULERIANOBSERVATIONSFORPASSENGERFLOWSTATEESTIMATIONINURBANRAILTRANSITNETWORKASPACETIMESTATEHYPERNETWORKBASEDASSIGNMENTAPPROACH SHANG P 1 Introduction 1.1 Motivation 1.2 Literature review 1.2.1 Passenger assignment models 1.2.2 Data-driven transit system state estimation method 1.3 Contributions and structure of this paper 2 Notations, problem statement, and general operating procedure 2.1 Notations 2.2 Problem statement 2.3 Step-by-step operating procedure 3 Fundamental concepts in a schedule-based urban rail transit network 3.1 Space-time network construction based on physical rail transit network and schedule 3.2 Discretized passenger flow state definition in a schedule-based urban rail transit network 3.3 STS hyper network construction based on discretized passenger flow states 3.3.1 Building STS hyper network for passenger assignment 3.3.2 Building STS hyper network for fixed sensor state transition 4 Model formulation 4.1 Model formulation for schedule- and state-based passenger assignment 4.2 Model formulation for fixed sensor state transition 4.3 A generalized least square estimation framework 4.4 Discussion 4.4.1 Underlying the passenger flow dynamics in the proposed STS hyper network 4.4.2 Intermediate Lagrangian observations: identification passenger space-time samples during a trip 4.4.3 Considering passenger route choice 5 A problem decomposition solution framework for large-scale applications 6 Numerical examples 6.1 A simple rail transit network 6.2 A medium-scale experiment with hypothetic ground-truth data 6.2.1 Description 6.2.2 Solution performance and convergence test 6.2.3 Spatial coverage of fixed sensors 6.2.4 Varying degrees of observation errors from fixed sensors 6.2.5 Different numbers of discretized passenger flow states 6.3 Large-scale experiment for estimating high-resolution passenger flow states in the Beijing subway network 7 Conclusions and future research Acknowledgements Appendix A Algorithms to solve the sub-problems Appendix B Basic input for the simple example Appendix C Basic input for the medium-scale example Appendix D Comparison between the proposed state estimation model and the schedule-based passenger assignment model Scheduled-based passenger assignment model. References AUFFREY 2017 23 33 C BAO 2018 1 12 X BINDER 2017 19 42 S CANCA 2018 494 519 D CANCA 2016 251 267 D CANCA 2017 1 14 D CARREL 2015 224 239 A CEPEDA 2006 437 459 M COMINETTI 2001 250 267 R DAGANZO 1997 C FUNDAMENTALSTRANSPORTATIONTRAFFICOPERATIONS FU 2012 1145 1155 Q GAO 2014 1344 1357 Z GUO 2011 490 506 R HANSELER 2014 60 80 F HANSELER 2017 149 168 F HAMDOUCH 2008 663 684 Y HAMDOUCH 2014 35 67 Y HOOGENDOORN 2017 480 496 S JI 2016 416 434 X JI 2013 1828 1839 X KROON 2014 165 184 L LI 2017 113 137 S LI 2018 228 253 S LIU 2016 225 250 J LIU 2010 753 769 Y LU 2018 1 19 K MA 2012 750 760 X MA 2013 1 12 X MOSKOWITZ 1963 K MUNOZ 2003 3750 3755 L PROCEEDINGS2003AMERICANCONTROLCONFERENCE2003 TRAFFICDENSITYESTIMATIONCELLTRANSMISSIONMODEL NEWELL 1993 281 287 G NGUYEN 1988 176 186 S NGUYEN 2001 238 249 S NIU 2013 212 230 H NIU 2015 117 135 H NUZZOLO 2012 16 33 A PELLETIER 2011 557 568 M POON 2004 343 368 M SEYFRIED 2009 395 406 A SHANG 2018 321 343 P SHI 2018 26 59 J SPIESS 1989 83 102 H STEFFEN 2010 1902 1910 B TENG 2015 35 46 J VANDENHEUVEL 2015 73 82 J TRAFFICGRANULARFLOW13 USINGBLUETOOTHESTIMATEIMPACTCONGESTIONPEDESTRIANROUTECHOICETRAINSTATIONS WANG 2005 141 167 Y WORK 2010 1 35 D WU 2015 1 18 J WU 1994 193 203 J YANG 2017 68 91 L YANG 2002 34 58 M YIN 2016 178 210 J YIN 2017 182 213 J ZENG 2018 130 140 Z ZHANG 2013 1130 1138 J ZHANG 2014 3274 3277 J ZHAO 2017 315 327 Y ZHONG 2015 125 130 C ZHOU 2018 262 265 J ZHOU 2017 J ZHOU 2017 157 181 L ZHOU 2010 254 273 X ZHOU 2007 823 840 X ZHU 2017 Y ZHU 2017 522 542 Y ZHU 2017 211 233 Y SHANGX2019X135 SHANGX2019X135X167 SHANGX2019X135XP SHANGX2019X135X167XP 2021-01-19T00:00:00.000Z 2021-01-19T00:00:00.000Z \u00a9 2018 Published by Elsevier Ltd. item S0191-2615(18)30498-3 S0191261518304983 1-s2.0-S0191261518304983 10.1016/j.trb.2018.12.015 271728 2019-05-06T07:57:29.560103Z 2019-03-01 2019-03-31 1-s2.0-S0191261518304983-main.pdf https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/MAIN/application/pdf/57e9ccc4f4fb6ede355d1c4a471b2924/main.pdf main.pdf pdf true 5505749 MAIN 33 1-s2.0-S0191261518304983-main_1.png https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/PREVIEW/image/png/988b3b0c23d1cb21b02d755cfc628b4e/main_1.png main_1.png png 43482 849 656 IMAGE-WEB-PDF 1 1-s2.0-S0191261518304983-gr1.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr1/THUMBNAIL/image/gif/1c05fab70ad3be99e56923096b69fcdb/gr1.sml gr1 gr1.sml sml 12359 132 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr10.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr10/THUMBNAIL/image/gif/2b81bfd2a16dd5cb6da31556043be267/gr10.sml gr10 gr10.sml sml 10515 158 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr11.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr11/THUMBNAIL/image/gif/7df12035fa9029314d27986d9f178b52/gr11.sml gr11 gr11.sml sml 6810 164 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr12.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr12/THUMBNAIL/image/gif/08cd4523d190e261c3fef3f17dab8e82/gr12.sml gr12 gr12.sml sml 10436 164 151 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr13.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr13/THUMBNAIL/image/gif/3ed8b1649a59b29d02173eff6444e71c/gr13.sml gr13 gr13.sml sml 20077 144 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr14.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr14/THUMBNAIL/image/gif/64b7a4a96b0df431afc5a96b81564e67/gr14.sml gr14 gr14.sml sml 12262 77 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr15.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr15/THUMBNAIL/image/gif/9520861fa5db951eb4283dbef946b857/gr15.sml gr15 gr15.sml sml 7088 133 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr16.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr16/THUMBNAIL/image/gif/c8aeff1bdbc399f6f7298cc26e2315c4/gr16.sml gr16 gr16.sml sml 6563 80 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr17.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr17/THUMBNAIL/image/gif/49801adacbd6403fea341956aa83d88f/gr17.sml gr17 gr17.sml sml 6069 75 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr18.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr18/THUMBNAIL/image/gif/610b859af5f63d4a3c8e156bca78d03d/gr18.sml gr18 gr18.sml sml 6000 70 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr19.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr19/THUMBNAIL/image/gif/7332a0ddc152f25bebceefcdf7c12527/gr19.sml gr19 gr19.sml sml 8204 149 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr2.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr2/THUMBNAIL/image/gif/1efddd3e28987055f82998ec5c669a12/gr2.sml gr2 gr2.sml sml 8666 163 164 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr20.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr20/THUMBNAIL/image/gif/976a70bf7553c7034328c9c018c7ae5a/gr20.sml gr20 gr20.sml sml 6760 163 119 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr21.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr21/THUMBNAIL/image/gif/fcd00955d26cefcd4a41e15e4444fb1e/gr21.sml gr21 gr21.sml sml 9910 163 105 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr22.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr22/THUMBNAIL/image/gif/35bee879dd6610bc231c992f2d92aa2d/gr22.sml gr22 gr22.sml sml 11086 148 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr23.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr23/THUMBNAIL/image/gif/e28c807b6f3cd899c85f253515bd0674/gr23.sml gr23 gr23.sml sml 7970 108 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr3.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr3/THUMBNAIL/image/gif/741cd547bd0a2a0359f174b0aa8510e9/gr3.sml gr3 gr3.sml sml 8362 164 177 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr4.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr4/THUMBNAIL/image/gif/4c0480b23121ece01bd3c574b1a5a788/gr4.sml gr4 gr4.sml sml 9454 123 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr5.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr5/THUMBNAIL/image/gif/d99cdf4056be35f81ab5ef07e9311fc4/gr5.sml gr5 gr5.sml sml 8689 101 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr6.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr6/THUMBNAIL/image/gif/7ffdbce6d6cee5bdac1affddfef5cbf4/gr6.sml gr6 gr6.sml sml 8383 111 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr7.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr7/THUMBNAIL/image/gif/9a6fe4effbdfbfe5bc470866fcece792/gr7.sml gr7 gr7.sml sml 5481 63 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr8.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr8/THUMBNAIL/image/gif/2b7d502bee936bfd8bf45ec9ab97f6f0/gr8.sml gr8 gr8.sml sml 9852 164 170 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr9.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr9/THUMBNAIL/image/gif/f9352c68ee77fa2d96c44f839c64ab5b/gr9.sml gr9 gr9.sml sml 11405 118 219 IMAGE-THUMBNAIL 1-s2.0-S0191261518304983-gr1.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr1/DOWNSAMPLED/image/jpeg/0b92586f76604285981ed87710ab4296/gr1.jpg gr1 gr1.jpg jpg 127701 437 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr10.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr10/DOWNSAMPLED/image/jpeg/222f8367483050621110b4cf2330ae12/gr10.jpg gr10 gr10.jpg jpg 85540 523 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr11.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr11/DOWNSAMPLED/image/jpeg/0944b1408b2f177fd95d4a9371166d08/gr11.jpg gr11 gr11.jpg jpg 33011 427 570 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr12.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr12/DOWNSAMPLED/image/jpeg/2c7d30372aa667dcfd9199fe6e0d8b7b/gr12.jpg gr12 gr12.jpg jpg 180711 788 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr13.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr13/DOWNSAMPLED/image/jpeg/035a254afb4c3eeb384e89a3ce2d1c25/gr13.jpg gr13 gr13.jpg jpg 40199 302 461 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr14.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr14/DOWNSAMPLED/image/jpeg/433e1bde705045182124d281e8451596/gr14.jpg gr14 gr14.jpg jpg 56223 256 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr15.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr15/DOWNSAMPLED/image/jpeg/57739e904ff184e89637eca2e22ecee1/gr15.jpg gr15 gr15.jpg jpg 28854 302 495 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr16.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr16/DOWNSAMPLED/image/jpeg/ae2bb20ff98d98d9b3c32862215fafba/gr16.jpg gr16 gr16.jpg jpg 43982 264 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr17.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr17/DOWNSAMPLED/image/jpeg/9c0426ae2cf9395da42f4628ec2dbc52/gr17.jpg gr17 gr17.jpg jpg 41229 248 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr18.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr18/DOWNSAMPLED/image/jpeg/7db2fc3ed82c7d867da128504d88a0ee/gr18.jpg gr18 gr18.jpg jpg 41413 231 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr19.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr19/DOWNSAMPLED/image/jpeg/dbec1e5b6467266325f632758daf03ad/gr19.jpg gr19 gr19.jpg jpg 66928 494 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr2.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr2/DOWNSAMPLED/image/jpeg/53040412f2829b93ede853f37cc862a4/gr2.jpg gr2 gr2.jpg jpg 101644 722 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr20.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr20/DOWNSAMPLED/image/jpeg/66b9f030cfdbcec64e3a1f22f1865cb7/gr20.jpg gr20 gr20.jpg jpg 118138 885 646 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr21.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr21/DOWNSAMPLED/image/jpeg/c204a7e2f28c2814c556ca482ad29ade/gr21.jpg gr21 gr21.jpg jpg 120409 885 570 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr22.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr22/DOWNSAMPLED/image/jpeg/81662cbbb913b1a697f79d988ca00182/gr22.jpg gr22 gr22.jpg jpg 104534 491 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr23.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr23/DOWNSAMPLED/image/jpeg/e11d0184b33d68b620a69c24847dae03/gr23.jpg gr23 gr23.jpg jpg 44646 285 581 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr3.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr3/DOWNSAMPLED/image/jpeg/1bc643518e9e9892a72592932857bd05/gr3.jpg gr3 gr3.jpg jpg 97987 670 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr4.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr4/DOWNSAMPLED/image/jpeg/9cf2c615d8c88b20b13e04b7eaea5749/gr4.jpg gr4 gr4.jpg jpg 63545 356 636 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr5.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr5/DOWNSAMPLED/image/jpeg/9e84f9263d1fb0be6ff51617d09f307b/gr5.jpg gr5 gr5.jpg jpg 52032 238 515 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr6.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr6/DOWNSAMPLED/image/jpeg/414ce107d7d0b15dfc723e500e1e2257/gr6.jpg gr6 gr6.jpg jpg 45463 329 649 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr7.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr7/DOWNSAMPLED/image/jpeg/0ea8103b0e446ebc834eaf4d029c3102/gr7.jpg gr7 gr7.jpg jpg 28562 209 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr8.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr8/DOWNSAMPLED/image/jpeg/94e9fe64ff0df7d5f20d7964613171ac/gr8.jpg gr8 gr8.jpg jpg 73525 700 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr9.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr9/DOWNSAMPLED/image/jpeg/e8765a4e7663d365169db3a2d8716838/gr9.jpg gr9 gr9.jpg jpg 86164 390 725 IMAGE-DOWNSAMPLED 1-s2.0-S0191261518304983-gr1_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr1/HIGHRES/image/jpeg/8381eceab701b01da12e9e0ac9a94acd/gr1_lrg.jpg gr1 gr1_lrg.jpg jpg 1114402 2322 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr10_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr10/HIGHRES/image/jpeg/57332222313e4b2928a56f92978476d6/gr10_lrg.jpg gr10 gr10_lrg.jpg jpg 811945 2779 3851 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr11_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr11/HIGHRES/image/jpeg/0bf116f0a1c57b44ca817fd5cae635c9/gr11_lrg.jpg gr11 gr11_lrg.jpg jpg 291311 2268 3030 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr12_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr12/HIGHRES/image/jpeg/670b73c084ef5d94991986e6dbfc00b6/gr12_lrg.jpg gr12 gr12_lrg.jpg jpg 1375782 4182 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr13_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr13/HIGHRES/image/jpeg/56e61dcf49aba78313302950bfe7a71d/gr13_lrg.jpg gr13 gr13_lrg.jpg jpg 345879 1339 2043 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr14_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr14/HIGHRES/image/jpeg/fd751e07fa4c01bc4e545ee4c35c2a89/gr14_lrg.jpg gr14 gr14_lrg.jpg jpg 490541 1133 3209 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr15_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr15/HIGHRES/image/jpeg/e4d461283ba2044e9fc00f4e3e88404b/gr15_lrg.jpg gr15 gr15_lrg.jpg jpg 274835 1602 2629 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr16_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr16/HIGHRES/image/jpeg/eaa01000f99ec837a50f8444bc1f0292/gr16_lrg.jpg gr16 gr16_lrg.jpg jpg 398806 1404 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr17_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr17/HIGHRES/image/jpeg/2510caca7d449aa08e89f44a6cfd8525/gr17_lrg.jpg gr17 gr17_lrg.jpg jpg 370412 1319 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr18_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr18/HIGHRES/image/jpeg/9e74453795bae0f361ad7cc19146fcce/gr18_lrg.jpg gr18 gr18_lrg.jpg jpg 423288 1225 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr19_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr19/HIGHRES/image/jpeg/1ee59d1a7a011a60222ea84539566950/gr19_lrg.jpg gr19 gr19_lrg.jpg jpg 615976 2621 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr2_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr2/HIGHRES/image/jpeg/e55eb63180fcaccea46229eb5ed37d1f/gr2_lrg.jpg gr2 gr2_lrg.jpg jpg 724375 3194 3208 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr20_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr20/HIGHRES/image/jpeg/f1a4b80ed8021d41fa8895682cd07947/gr20_lrg.jpg gr20 gr20_lrg.jpg jpg 1210403 4702 3431 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr21_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr21/HIGHRES/image/jpeg/b78588abcffc9a5a9af59a4877632e10/gr21_lrg.jpg gr21 gr21_lrg.jpg jpg 923673 3917 2524 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr22_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr22/HIGHRES/image/jpeg/da7b31740444dc357133fe5495c27bb3/gr22_lrg.jpg gr22 gr22_lrg.jpg jpg 1042356 2609 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr23_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr23/HIGHRES/image/jpeg/68c6c9d2606ac24c6189f238d6fc1b79/gr23_lrg.jpg gr23 gr23_lrg.jpg jpg 389922 1516 3087 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr3_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr3/HIGHRES/image/jpeg/e743687c5275fd73a893e65ae4fa9dfe/gr3_lrg.jpg gr3 gr3_lrg.jpg jpg 1014321 3559 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr4_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr4/HIGHRES/image/jpeg/fcdb865cb4aa703041c55caa5bb8a815/gr4_lrg.jpg gr4 gr4_lrg.jpg jpg 576268 1892 3382 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr5_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr5/HIGHRES/image/jpeg/460c9020bd280b5211aef20cc26745df/gr5_lrg.jpg gr5 gr5_lrg.jpg jpg 481767 1267 2736 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr6_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr6/HIGHRES/image/jpeg/bd661d33a76e18c4c00f37765372ad2c/gr6_lrg.jpg gr6 gr6_lrg.jpg jpg 439692 1748 3447 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr7_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr7/HIGHRES/image/jpeg/8b4d27e26f0252e6ac11e1165efa086e/gr7_lrg.jpg gr7 gr7_lrg.jpg jpg 249414 1111 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr8_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr8/HIGHRES/image/jpeg/f045a27a85eca4ce0465d89c9621504e/gr8_lrg.jpg gr8 gr8_lrg.jpg jpg 713648 3100 3209 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-gr9_lrg.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/gr9/HIGHRES/image/jpeg/759b24c654fe8731bfc24e3b7c3b4a9d/gr9_lrg.jpg gr9 gr9_lrg.jpg jpg 856655 2070 3850 IMAGE-HIGH-RES 1-s2.0-S0191261518304983-si1.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/77ee2a719e89e9eb922ce75fec5c4440/si1.gif si1 si1.gif gif 511 25 75 ALTIMG 1-s2.0-S0191261518304983-si30.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/a88e09133c8a6a42a8d8ae8ae3ccf0cc/si30.gif si30 si30.gif gif 4463 123 605 ALTIMG 1-s2.0-S0191261518304983-si47.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/1123fa56ab22d6b7c86265edcd41ba5f/si47.gif si47 si47.gif gif 1965 44 471 ALTIMG 1-s2.0-S0191261518304983-si48.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/4f59599560858b1ae3f1e782e040e300/si48.gif si48 si48.gif gif 4513 107 632 ALTIMG 1-s2.0-S0191261518304983-si58.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/22cac00f93c759b53884d490c0c924cf/si58.gif si58 si58.gif gif 240 19 35 ALTIMG 1-s2.0-S0191261518304983-si59.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/72d0d0f5286c13a2304a75b84a4e01af/si59.gif si59 si59.gif gif 1408 37 316 ALTIMG 1-s2.0-S0191261518304983-si8.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/a2b64591fe1069a99fee1ad76cabdaea/si8.gif si8 si8.gif gif 1585 25 405 ALTIMG 1-s2.0-S0191261518304983-si22.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/b9bb1faf14a72939bfbd9899fa699e80/si22.gif si22 si22.gif gif 690 21 151 ALTIMG 1-s2.0-S0191261518304983-si29.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/11d20d80eb9957721d0a4d180b068f49/si29.gif si29 si29.gif gif 969 49 166 ALTIMG 1-s2.0-S0191261518304983-si7.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/f7f59f211c461ad9de9406c1ce52394e/si7.gif si7 si7.gif gif 1086 25 261 ALTIMG 1-s2.0-S0191261518304983-si2.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/c4734625d16ce5cf28438decb39849c3/si2.gif si2 si2.gif gif 505 25 75 ALTIMG 1-s2.0-S0191261518304983-si42.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/882da9a135211b7f9493e5cb354ef445/si42.gif si42 si42.gif gif 875 20 229 ALTIMG 1-s2.0-S0191261518304983-si14.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/17f74d356d6b9c001d70baade03c4162/si14.gif si14 si14.gif gif 720 21 157 ALTIMG 1-s2.0-S0191261518304983-si37.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/c6da71fc9868494b353a058974277162/si37.gif si37 si37.gif gif 1681 24 423 ALTIMG 1-s2.0-S0191261518304983-si16.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/091fd39f0792353c0d63511bd3467663/si16.gif si16 si16.gif gif 3408 37 881 ALTIMG 1-s2.0-S0191261518304983-si33.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/c3e888063e49cd7fb1979df98f3a3a38/si33.gif si33 si33.gif gif 1021 40 234 ALTIMG 1-s2.0-S0191261518304983-si44.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/35f28a993298b169b7d3c35dbd3f7987/si44.gif si44 si44.gif gif 846 21 203 ALTIMG 1-s2.0-S0191261518304983-si17.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/5672c4087c63d6142ce30aad86e34d63/si17.gif si17 si17.gif gif 714 20 182 ALTIMG 1-s2.0-S0191261518304983-si46.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/0061f187ccb8452c7bb5ccdbb4b8666a/si46.gif si46 si46.gif gif 1300 69 147 ALTIMG 1-s2.0-S0191261518304983-si23.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/ea786e53ba52751db492a6a039c3307e/si23.gif si23 si23.gif gif 352 16 74 ALTIMG 1-s2.0-S0191261518304983-si32.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/126060fa9f1562470662dd3ba093bdda/si32.gif si32 si32.gif gif 2586 40 621 ALTIMG 1-s2.0-S0191261518304983-si25.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/d41d2ac99505a141e141e1bb5ce78de5/si25.gif si25 si25.gif gif 472 24 70 ALTIMG 1-s2.0-S0191261518304983-si49.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/ea3e1ea825a16688777be0c4767c215d/si49.gif si49 si49.gif gif 138 16 10 ALTIMG 1-s2.0-S0191261518304983-si41.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/8985aaca45026845d0f02cb13c71f9eb/si41.gif si41 si41.gif gif 884 21 214 ALTIMG 1-s2.0-S0191261518304983-si43.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/e05f3a99b17b9fc33420c1bb11f0df2b/si43.gif si43 si43.gif gif 1692 41 448 ALTIMG 1-s2.0-S0191261518304983-si3.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/d8f264a03e405e51c97cc6a0d212b368/si3.gif si3 si3.gif gif 491 23 75 ALTIMG 1-s2.0-S0191261518304983-si26.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/e64e29b4110d66652e3ae94bc162f9da/si26.gif si26 si26.gif gif 472 25 70 ALTIMG 1-s2.0-S0191261518304983-si35.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/aab7aedcbcc82a22525e2096db666c1d/si35.gif si35 si35.gif gif 5998 105 684 ALTIMG 1-s2.0-S0191261518304983-si28.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/0af7d8e0439ef315fcbf301c155b0f14/si28.gif si28 si28.gif gif 550 20 135 ALTIMG 1-s2.0-S0191261518304983-si19.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/b5e280a3e58ac57d17d509178bcd6899/si19.gif si19 si19.gif gif 741 21 157 ALTIMG 1-s2.0-S0191261518304983-si18.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/51da3eb850cc4f0814acf1fa2d8640f8/si18.gif si18 si18.gif gif 740 20 161 ALTIMG 1-s2.0-S0191261518304983-si5.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/acb4541cda2e1cc7141601bad113e1d9/si5.gif si5 si5.gif gif 759 19 156 ALTIMG 1-s2.0-S0191261518304983-si24.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/22bf71b529b5bb2d799ab1455647bf07/si24.gif si24 si24.gif gif 644 17 147 ALTIMG 1-s2.0-S0191261518304983-si45.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/dadddecb741006ee6f49421f0e72bd64/si45.gif si45 si45.gif gif 859 20 208 ALTIMG 1-s2.0-S0191261518304983-si4.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/7390935d22b8d5992b2207d61aa258f8/si4.gif si4 si4.gif gif 726 21 148 ALTIMG 1-s2.0-S0191261518304983-si20.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/cccf200bf5d61a763629b00a624d6e1b/si20.gif si20 si20.gif gif 741 19 161 ALTIMG 1-s2.0-S0191261518304983-si34.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/562e24d1564cf3c574d58f8d2d5dcb5b/si34.gif si34 si34.gif gif 4221 122 583 ALTIMG 1-s2.0-S0191261518304983-si71.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/73d3eb7e3b75f0c6a30d473ee7f317eb/si71.gif si71 si71.gif gif 686 22 165 ALTIMG 1-s2.0-S0191261518304983-si62.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/854db234f293548443078473be57c941/si62.gif si62 si62.gif gif 1954 44 442 ALTIMG 1-s2.0-S0191261518304983-si6.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/609b8710e227201086113803c5752735/si6.gif si6 si6.gif gif 1813 23 513 ALTIMG 1-s2.0-S0191261518304983-si9.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/93a48555695c3ecea01cae344e618b34/si9.gif si9 si9.gif gif 499 21 75 ALTIMG 1-s2.0-S0191261518304983-si39.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/400331f8da0e3cefb62ca0f5682a72d2/si39.gif si39 si39.gif gif 10083 212 766 ALTIMG 1-s2.0-S0191261518304983-si31.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/84fe28cd4ed9e9bb6724e229b37dc9a0/si31.gif si31 si31.gif gif 1315 33 284 ALTIMG 1-s2.0-S0191261518304983-si10.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/7d5e5e34b20332303b14391f274a1d86/si10.gif si10 si10.gif gif 513 18 101 ALTIMG 1-s2.0-S0191261518304983-si21.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/a7ccedbdc33da9e34e6e38c5efc287f8/si21.gif si21 si21.gif gif 4219 40 1084 ALTIMG 1-s2.0-S0191261518304983-si36.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/4b27de6b85d616600d7de4cb89297db8/si36.gif si36 si36.gif gif 7591 104 820 ALTIMG 1-s2.0-S0191261518304983-si11.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/17932a8fbbedfc146638545a8762c611/si11.gif si11 si11.gif gif 806 21 192 ALTIMG 1-s2.0-S0191261518304983-si66.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/2624b923b69ea8e2efce350b78c57c28/si66.gif si66 si66.gif gif 1531 42 333 ALTIMG 1-s2.0-S0191261518304983-si57.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/3723775fb16afa56a532fad3335b38af/si57.gif si57 si57.gif gif 769 19 168 ALTIMG 1-s2.0-S0191261518304983-si68.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/c1b836ac924d2fb1e483028a8650111b/si68.gif si68 si68.gif gif 1702 44 402 ALTIMG 1-s2.0-S0191261518304983-si69.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/6712cf57e43a5e0172d5256364ae7d64/si69.gif si69 si69.gif gif 3340 69 662 ALTIMG 1-s2.0-S0191261518304983-si65.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/24caefb3a04264b4e8009d01ba6afd56/si65.gif si65 si65.gif gif 911 24 216 ALTIMG 1-s2.0-S0191261518304983-si70.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/6e4e5ac0b9a03da0b9f6acf3a5b8acda/si70.gif si70 si70.gif gif 1619 40 391 ALTIMG 1-s2.0-S0191261518304983-si51.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/8a341db405665fc8b95a749433cfba1c/si51.gif si51 si51.gif gif 203 19 20 ALTIMG 1-s2.0-S0191261518304983-si61.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/dbcdc60be6194ef3e78b3fd40e66569a/si61.gif si61 si61.gif gif 1525 53 317 ALTIMG 1-s2.0-S0191261518304983-si64.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/afb295a3c7b0ad8920697772c47f65ad/si64.gif si64 si64.gif gif 4437 123 606 ALTIMG 1-s2.0-S0191261518304983-si12.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/8e351da8b34987aff1ed935800b1bfce/si12.gif si12 si12.gif gif 3947 37 1088 ALTIMG 1-s2.0-S0191261518304983-si67.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/a3a731f4c8ab2af3c6b21c28893c5b82/si67.gif si67 si67.gif gif 1228 16 304 ALTIMG 1-s2.0-S0191261518304983-si27.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/0951a696fe52bf81c1afbe7a91558fa5/si27.gif si27 si27.gif gif 450 21 70 ALTIMG 1-s2.0-S0191261518304983-si60.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/70a2f97d51592c991e4874580c9498fc/si60.gif si60 si60.gif gif 1034 32 252 ALTIMG 1-s2.0-S0191261518304983-si55.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/b692cc784ba63ebaee4fa86425de0280/si55.gif si55 si55.gif gif 764 20 168 ALTIMG 1-s2.0-S0191261518304983-si56.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/80e776ceabcc9f1f682f482c6b08eeb0/si56.gif si56 si56.gif gif 766 21 165 ALTIMG 1-s2.0-S0191261518304983-si40.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/be863f4a6584cbdc6859c4eacb64a951/si40.gif si40 si40.gif gif 10714 176 794 ALTIMG 1-s2.0-S0191261518304983-si50.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/9ec1aeca9efffba882ba3e416581c154/si50.gif si50 si50.gif gif 190 21 17 ALTIMG 1-s2.0-S0191261518304983-si63.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/303d81f0c2e8ed535df0e203076623ce/si63.gif si63 si63.gif gif 3029 64 634 ALTIMG 1-s2.0-S0191261518304983-si13.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/93f800123715e699edeabf122d2ca878/si13.gif si13 si13.gif gif 709 21 178 ALTIMG 1-s2.0-S0191261518304983-si15.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/d28406c78b1b0a4ed0627712f736549e/si15.gif si15 si15.gif gif 823 20 196 ALTIMG 1-s2.0-S0191261518304983-si38.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/6ff3077e0687c4e11d236eea37dd947e/si38.gif si38 si38.gif gif 3228 64 697 ALTIMG 1-s2.0-S0191261518304983-si52.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/f1b515b4cebe1c6e0f31166908fa35c5/si52.gif si52 si52.gif gif 547 18 107 ALTIMG 1-s2.0-S0191261518304983-si53.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/2b0d78057f0e436f428e14e9f811c019/si53.gif si53 si53.gif gif 544 18 108 ALTIMG 1-s2.0-S0191261518304983-si54.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0191261518304983/STRIPIN/image/gif/f420598ccb4f086784d5234c67dbd1b7/si54.gif si54 si54.gif gif 756 21 165 ALTIMG 1-s2.0-S0191261518304983-am.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/egi:1096DTXTLP7/MAIN/application/pdf/907775f32bbbfe0814895b730793bc1c/am.pdf https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/egi:1096DTXTLP7/MAIN/application/pdf/907775f32bbbfe0814895b730793bc1c/am.pdf am am.pdf pdf false 4201466 AAM-PDF TRB 2119 S0191-2615(18)30498-3 10.1016/j.trb.2018.12.015 Fig. 1 Illustration of the proposed state estimation framework for an urban rail transit network. Fig. 1. Fig. 2 Network formulation methodology: (a) Physical rail transit network defines the basic network structure; (b) Space-time network defines pre-determined transit schedules; (c) STS hyper network further considers passenger flow evolution including flow, density, and speed based on the network structure and the pre-determined transit schedules. Fig. 2. Fig. 3 Stationary speed-density and flow-density relations for passenger waiting, riding, and transfer processes, and defined discretized passenger flow states. (For interpretation of the references to color in this figure, the reader is referred to the web version of this article.) Fig. 3. Fig. 4 Illustration of the STS network construction for fixed sensor state transition. Fig. 4. Fig. 5 Conceptual illustration of traffic dynamics modeling framework in our proposed STS hyper network. Fig. 5. Fig. 6 Modeling scale of the urban rail transit system in this study. Fig. 6. Fig. 7 Block description of the proposed model. Fig. 7. Fig. 8 A decomposition framework for the proposed passenger flow state estimation model. Fig. 8. Fig. 9 The estimated passenger flows in the STS hyper network (Green lines for arcs originating from State 1 and Red lines for arcs originating from State 2). (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.) Fig. 9. Fig. 10 The estimated fixed sensor state transitions in the STS hyper network (Green lines for arcs originating from State 1 and Red lines for arcs originating from State 2). (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.) Fig. 10. Fig. 11 A medium-scale urban rail transit network. Fig. 11. Fig. 12 Flow, density, speed, and transfer time relations on transfer links (4,5) and (6,7). Fig. 12. Fig. 13 Ground-truth passenger space-time trajectories (170 passengers). Fig. 13. Fig. 14 Ground-truth time-dependent observations (densities) at platforms and in trains. Fig. 14. Fig. 15 Iterative processes starting from different initial solutions. Fig. 15. Fig. 16 Optimal objective function values and density-MAE values for the scenarios with different coverages of fixed sensors. Fig. 16. Fig. 17 Optimal objective function values and density-MAE values for observation data sets with different degrees of observation errors. Fig. 17. Fig. 18 Optimal objective function values and density-MAE values for scenarios with different numbers of passenger flow states. Fig. 18. Fig. 19 Illustration of the Beijing subway network (17 bi-direction lines, 343 stations, 52 transfer stations). (For interpretation of the references to color in this figure, the reader is referred to the web version of this article.) Fig. 19. Fig. 20 Estimated passenger flow states (densities) at typical platforms in the Beijing subway network. Fig. 20. Fig. 21 Estimated passenger flow states in operating trains on each line in the Beijing subway network. Fig. 21. Fig. 22 Comparison of state estimation models with different levels of boundary conditions. Fig. 22. Fig. 23 Absolute deviation between estimated and observed arrival time of all passengers at their destinations. Fig. 23. Table 1 Parameters and subscripts for the model formulation. Table 1 Notations Definitions i, j Index of nodes, i, j \u2208 Vs ( i, j ) Index of links, (i, j) \u2208 Es t, t\u2032 Index of time intervals, t, t\u2032\u202f=\u202f1, 2, \u2026, T ( i, t ), ( j, t\u2032 ) Index of space-time vertices, (i, t), (j, t\u2032) \u2208 Vst ( i, j, t, t \u2032) Index of space-time arcs, (i, j, t, t\u2032) \u2208 Est m, m\u2032, m\u2032\u2032, m 0 Index of states, m, m\u2032, m\u2032\u2032 \u2208 M, where m 0 is the dummy initial state ( i, t, m ), ( j, t\u2032, m\u2032 ) Index of STS vertices, (i, t, m), (j, t\u2032, m\u2032) \u2208 Vsts ( i, j, t, t\u2032, m, m\u2032 ) Index of STS arcs, (i, j, t, t\u2032, m, m\u2032) \u2208 Ests a Index of passengers, a \u2208 A a \u2032 Index of fixed sensors, a\u2032 \u2208 A\u2032 V s Set of physical nodes in an urban rail transit network E s Set of physical links in an urban rail transit network E s ( a ) Sub-set of physical links in the K shortest routes for passenger a T Length of the study time horizon V st Set of vertices in the space-time network E st Set of arcs in the space-time network M Set of discretized passenger flow states V sts Set of vertices in the STS network E sts Set of arcs in the STS network E sts ( a ) Sub-set of arcs in the STS network for passenger a A Set of passengers in an urban rail transit network A\u2032 Set of fixed sensors in an urban rail transit network \u03a6 a Set of intermediate identification space-time samples for passenger a, (i, t) \u2208 \u03a6 a if passenger a is observed at node i at time t l i,j Length of the physical link (i, j) TT i,j ( m ) Travel time of passengers going through the link (i, j) in state m ref i , j q ( m ) Reference flow of link (i, j) in state m ref i , j k ( m ) Reference density of link (i, j) in state m ref i , j v ( m ) Reference speed of link (i, j) in state m o a , d a Origin and destination node indices of passenger a DT a , AT a Departure and arrival times of passenger a at origin and destination nodes ( i a\u2032 , j a\u2032 ) Observed link index of fixed sensor a\u2032 obs q ( a\u2032,t ) Observed flow of fixed sensor a\u2032 at time t obs k ( a\u2032,t ) Observed density of fixed sensor a\u2032 at time t obs v ( a\u2032,t ) Observed speed of fixed sensor a\u2032 at time t Table 2 Decision variables in the model formulation. Table 2 Notations Definitions x a l ( i , j , t , t \u2032 , m , m \u2032 ) Passenger assignment variable,\u202f=\u202f1 if passenger a is assigned on STS arc (i, j, t, t\u2032, m, m\u2032);\u202f=\u202f0, otherwise x a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) Fixed sensor assignment variable,\u202f=\u202f1 if fixed sensor a\u2032 is assigned on STS arc (i, j, t, t\u2032, m, m\u2032);\u202f=\u202f0, otherwise z ( i, j, t, m ) System internal state variable,\u202f=\u202f1 if the internal system state of link (i, j) at time t is state m;\u202f=\u202f0, otherwise Table 3 Reference flow, density, and speed for example STS arcs. Table 3 STS arcs for passenger assignment/fixed sensor state transition State Flow Density Speed Passenger assignment Fixed sensor state transition Waiting arc Platform state transition arc 1 0 10 0 Waiting arc Platform state transition arc 2 0 20 0 Service arc Train state transition arc 1 50 10 5 Service arc Train state transition arc 2 100 20 5 Transfer arc Transfer corridor state transition arc 1 20 10 2 Transfer arc Transfer corridor state transition arc 2 20 20 1 Table 4 Calculation method of estimation errors based on different types of decision variables. Table 4 Decision variables Estimation error MAE i,j, t Aggregated passenger count | \u03c0 ^ i , j , t \u2212 \u2211 ( i , j ) \u2211 t \u2211 t t \u2032 , m , m t \u2032 ( i , j , t , t t \u2032 , m , m t \u2032 ) \u2208 E s t s \u2211 a x a ( i , j , t , t \u2032 , m , m t \u2032 ) | Estimated system internal state | \u03c0 ^ i , j , t \u2212 z ( i , j , t , m * ) \u00d7 r e f i , j k ( m * ) | Estimated state transition process of corresponding fixed sensor | \u03c0 ^ i , j , t \u2212 \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m * , m \u2032 ) \u00d7 r e f i , j k ( m * ) | Table 5 Eight scenarios with different spatial coverage of fixed sensors. Table 5 Scenario Spatial coverage Number of fixed sensors Scenario 1 All (Platform\u202f+\u202fTrain\u202f+\u202fTransfer corridor) 18 Scenario 2 Platform\u202f+\u202fTrain 16 Scenario 3 Platform\u202f+\u202fTransfer corridors 10 Scenario 4 Train\u202f+\u202fTransfer corridor 10 Scenario 5 Platform 8 Scenario 6 Train 8 Scenario 7 Transfer corridor 2 Scenario 8 None 0 Table 6 Summary of data set in the Beijing subway network. Table 6 Physical nodes Physical links Time period Train trips Number of passengers Number of fixed sensors 1372 3168 7:00\u20139:00 2280 1393,093 228 Table 7 Discretized passenger flow states for application in the Beijing subway network. Table 7 State Density Speed Flow State 1 150 State 2 300 State 3 450 For waiting link (i, j), R e f i , j v ( m ) equals to 0; State 4 600 For service link (i, j), R e f i , j v ( m ) equals to train running speed; Reference flows can be calculated by q\u202f=\u202fkV (k) State 5 750 For transfer link (i, j), R e f i , j v ( m ) equals to calibrated walking speed State 6 900 State 7 1050 State 8 1200 State 9 1350 State 10 1500 Algorithm A1 Sequential dynamic programming algorithm for passenger assignment. Algorithm A1 Step 1: Initialization. Input passenger set A, and Lagrangian observations for each passenger a; Input fixed system internal states { z ^ ( i , j , t , m ) } ; Initialize passenger assignment variables { x a l ( i , j , t , t \u2032 , m , m \u2032 ) = 0 } . Step 2: Passenger assignment. For each passenger a in set A, do Step 2.1 and Step 2.2. Step 2.1. Update arc cost in the STS hyper network. For each STS arc (i, j, t, t\u2032, m, m\u2032), set the arc cost by the following equation: c ( i , j , t , t \u2032 , m , m \u2032 ) = \u03b1 \u00d7 { [ 1 + \u2211 a \u2211 m \u2032 x a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2212 r e f i , j k ( m ) \u00d7 z ^ ( i , j , t , m ) ] 2 \u2212 [ \u2211 a \u2211 m \u2032 x a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2212 r e f i , j k ( m ) \u00d7 z ^ ( i , j , t , m ) ] 2 } . Step 2.2. Sequentially assign passengers in the STS hyper network. For passenger a, find the shortest STS path from vertex (o a\u2032,1, m 0) to (da,DTa,m 0) by dynamic programming algorithm, and set x a l ( i , j , t , t \u2032 , m , m \u2032 ) = 1 for arcs (i, j, t, t\u2032, m, m\u2032) along the shortest STS path. Step 3: Output. Output the passenger assignment results { x a l ( i , j , t , t \u2032 , m , m \u2032 ) } . Algorithm A2 Dynamic programming algorithm for fixed sensor assignment. Algorithm A2 Step 1: Initialization. Input fixed sensor set A\u2032, and the Eulerian observations for each fixed sensor a\u2032; Input fixed system internal states { z ^ ( i , j , t , m ) } ; Initialize fixed sensor assignment variables { x a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) = 0 } . Step 2: Fixed sensor assignment. For each fixed sensor a\u2032 in set A\u2032, do Step 2.1 and Step 2.2. Step 2.1. Set arc cost in the STS hyper network. For each STS arc (i a\u2032,i a\u2032,t, t\u2032, m, m\u2032), set the arc cost by the following equation: c ( i a \u2032 , i a \u2032 , t , t \u2032 , m , m \u2032 ) = \u03b2 \u00d7 { [ o b s k ( a \u2032 , t ) \u2212 r e f i a \u2032 , j a \u2032 k ( m ) ] 2 } + \u03b3 \u00d7 { r e f i a \u2032 , j a \u2032 q ( m ) \u2212 \u2211 m \u2033 z ^ ( i a \u2032 , j a \u2032 , t , m \u2033 ) \u00d7 r e f i a \u2032 , j a \u2032 q ( m \u2033 ) } . Step 2.2. Assign fixed sensor in the STS hyper network. For fixed sensor a\u2032, find the shortest STS path from vertex (i a\u2032,1, m 0) to (i a\u2032,T, m 0) in the separate state-time network located at node i a\u2032 by dynamic programming algorithm, and set x a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) = 1 for arcs (i, j, t, t\u2032, m, m\u2032) along the shortest STS path. Step 3: Output. Output the fixed sensor assignment results { x a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) } . Algorithm A3 Semi-assignment algorithm for state updating. Algorithm A3 Step 1: Initialization. Input given passenger assignment results { x ^ a l ( i , j , t , t \u2032 , m , m \u2032 ) } ; Input given fixed sensor assignment results { x ^ a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) } ; Initialize system internal state variables {z(i, j, t, m)\u202f=\u202f0}. Step 2: Updating state. For each link (i, j) at any time t, find m* in set M with the minimum cost c(i, j, t, m): c ( i , j , t , m ) = \u03b1 \u00d7 { [ \u2211 a \u2211 m \u2032 x ^ a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2212 r e f i , j k ( m ) ] 2 } + \u03b3 \u00d7 { \u2211 a \u2032 \u2211 ( i , j ) = ( i a \u2032 , j a \u2032 ) [ \u2211 m \u2032 \u2208 M x ^ a \u2032 e ( i , i , t , t + 1 , m \u2032 , m \u2033 ) \u00d7 r e f i , j q ( m \u2032 ) \u2212 r e f i , j q ( m ) ] 2 } , and set z(i, j, t, m*)\u202f=\u202f1. Step 3: Output. Table B1 Passenger groups and Lagrangian observations in the simple example. Table B1 Passenger group Origin node Departure time Destination node Arrival time Volume Passenger group 1 1 1 4 4 10 Passenger group 2 1 1 4 6 10 Passenger group 3 2 3 4 6 10 Passenger group 4 3 3 4 5 10 Passenger group 5 1 2 4 7 10 Passenger group 6 3 5 4 7 10 Passenger group 7 1 3 4 8 10 Passenger group 8 3 6 4 8 10 Table B2 Fixed sensors and Eulerian observations in the simple example. Table B2 Fixed sensor Observed link Density Observations Fixed sensor 1 (1, 1): Platform of Station 1 10; 10; 10; 0; 0; 0; 0; 0 Fixed sensor 2 (1, 2): Operating trains on Line 1 10; 10; 10; 10; 0; 0; 0; 0 Fixed sensor 3 (2, 3): Transfer corridor from Line 1 to Line 2 0; 10; 20; 10; 10; 0; 0; 0 Fixed sensor 4 (3, 3): Platform of Station 3 0; 0; 10; 10; 20; 20; 0; 0 Fixed sensor 5 (3, 4): Operating train on Line 2 0; 0; 10; 10; 20; 20; 20; 0 Table C1 Hypothetic transit service arcs. Table C1 Line Service Service link Start time End time Line Service Service link Start time End time Line 1 Service 1 (1,4) 1 7 Line 3 Service 1 (3,7) 13 20 Line 1 Service 1 (4,8) 7 13 Line 3 Service 2 (2,3) 17 23 Line 1 Service 2 (1,4) 11 17 Line 3 Service 2 (3,7) 23 30 Line 1 Service 2 (4,8) 17 23 Line 3 Service 3 (2,3) 27 33 Line 1 Service 3 (1,4) 21 27 Line 3 Service 3 (3,7) 33 40 Line 1 Service 3 (4,8) 27 33 Line 3 Service 4 (2,3) 37 43 Line 1 Service 4 (1,4) 31 37 Line 3 Service 4 (3,7) 43 50 Line 1 Service 4 (4,8) 37 43 Line 4 Service 1 (2,6) 6 13 Line 1 Service 5 (1,4) 41 47 Line 4 Service 1 (6,8) 13 16 Line 1 Service 5 (4,8) 47 53 Line 4 Service 2 (2,6) 16 23 Line 2 Service 1 (1,5) 6 13 Line 4 Service 2 (6,8) 23 26 Line 2 Service 1 (5,7) 13 16 Line 4 Service 3 (2,6) 26 33 Line 2 Service 2 (1,5) 26 33 Line 4 Service 3 (6,8) 33 36 Line 2 Service 2 (5,7) 33 36 Line 4 Service 4 (2,6) 36 43 Line 2 Service 3 (1,5) 46 53 Line 4 Service 4 (6,8) 43 46 Line 2 Service 3 (5,7) 53 56 Line 4 Service 5 (2,6) 46 53 Line 3 Service 1 (2,3) 7 13 Line 4 Service 5 (6,8) 53 56 Table C2 Definition of discretized passenger flow states. Table C2 State Waiting process Riding process Transfer process Density Waiting time Flow Density Riding time Flow Density Transfer time Flow State 1 0 1 0 0 4(5)* State 2 1 1 1 1 4(5) State 3 2 1 2 2 4(5) State 4 3 1 3 3 4(5) State 5 4 1 4 4 4(5) State 6 5 1 5 5 4(5) State 7 6 1 6 6 5(5) State 8 7 1 7 7 6(5) State 9 8 1 q\u202f=\u202fkv 8 Scheduled link travel time q\u202f=\u202fkv 8 7(5) q\u202f=\u202fkv State 10 9 1 9 9 8(6) State 11 10 1 10 10 8(7) State 12 11 1 11 11 9(8) State 13 12 1 12 12 10(9) State 14 13 1 13 13 11(10) State 15 14 1 14 14 12(11) State 16 15 1 15 15 13(12) 4(5)*: The transfer times of transfer links (4,5) and (6,7) are 4 and 5 for State 1. Table C3 Definition of discretized passenger flow states. Table C3 Number of discretized passenger flow states Waiting process Riding process Transfer process 16 9 6 5 4 Density Waiting time Flow Density Riding time Flow Density Transfer time Flow State 1 State 1 State 1 State 1 State 1 0 1 0 Scheduled link travel time 0 4(5)* State 2 \u2212 \u2212 \u2212 \u2212 1 1 1 1 4(5) State 3 State 2 \u2212 \u2212 \u2212 2 1 2 2 4(5) State 4 \u2212 State 2 \u2212 \u2212 3 1 3 3 4(5) State 5 State 3 \u2212 State 2 \u2212 4 1 4 4 4(5) State 6 \u2212 \u2212 \u2212 State 2 5 1 5 5 4(5) State 7 State 4 State 3 \u2212 \u2212 6 1 6 6 5(5) State 8 \u2212 \u2212 \u2212 \u2212 7 1 7 7 6(5) State 9 State 5 \u2212 State 3 \u2212 8 1 q\u202f=\u202fkv 8 q\u202f=\u202fkv 8 7(5) q\u202f=\u202fkv State 10 \u2212 State 4 \u2212 \u2212 9 1 9 9 8(6) State 11 State 6 \u2212 \u2212 State 3 10 1 10 10 8(7) State 12 \u2212 \u2212 \u2212 \u2212 11 1 11 11 9(8) State 13 State 7 State 5 State 4 \u2212 12 1 12 12 10(9) State 14 \u2212 \u2212 \u2212 \u2212 13 1 13 13 11(10) State 15 State 8 \u2212 \u2212 \u2212 14 1 14 14 12(11) State 16 \u2212 State 6 \u2212 State 4 15 1 15 15 13(12) \u2212* State 9 \u2212 State 5 \u2212 16 1 16 16 14(13) \u2013*: This state does not exist. Table D1 Notations of the schedule-based passenger assignment model. Table D1 Notations Definitions ( i, j, t, t\u2032 ) Index of space-time arcs, (i, j, t, t\u2032) \u2208 Est a Index of passengers, a \u2208 A T Length of the study time horizon V st Set of vertices in the space-time network E st Set of arcs in the space-time network A Set of passengers in an urban rail transit network o a , d a Origin and destination node indices of passenger a DT a , AT a Departure and arrival times of passenger a at origin and destination nodes c ( i, j, t, t\u2032) Travel time cost of the space-time arc (i, j, t, t\u2032) Cap ( i, j, t, t\u2032) Capacity of the space-time arc (i, j, t, t\u2032) x a ( i,j, t, t\u2032 ) Passenger assignment variable,\u202f=\u202f1 if passenger a is assigned on space-time arc (i, j, t, t\u2032);\u202f=\u202f0, otherwise Table D2 Comparison between the proposed state estimation model and the schedule-based passenger assignment model. Table D2 Comparison items The proposed state estimation model Schedule-based passenger assignment model Lagrangian observations Origin Origin STS vertex in Eq. (5) Origin space-time vertex (Eq. (D-2)) Departure time Origin STS vertex in Eq. (5) Origin space-time vertex (Eq. (D-2)) Destination Destination STS vertex in Eq. (5) Destination space-time vertex (Eq. (D-2)) Arrival time Destination STS vertex in Eq. (5) Not considered Intermediate space-time samples Intermediate STS vertex in Eq. (15) Not considered Eulerian observations Time-dependent passenger densities at fixed locations Measurement equations for Eulerian observations in Eq. (9) Not considered Passenger flow-density relations Measurement equation for aggregating individual passengers to discretized passenger flow states in Eq. (6) Not considered Capacities of train, platform, and transfer corridor Measurement equation for aggregating individual passengers to discretized passenger flow states in Eq. (6) Capacity constraint in Eq. (D-4) Integrating Lagrangian and Eulerian observations for passenger flow state estimation in an urban rail transit network: A space-time-state hyper network-based assignment approach Pan Shang a shangp16@mails.tsinghua.edu.cn Ruimin Li a \u204e lrmin@tsinghua.edu.cn Jifu Guo b guojf@bjtrc.org.cn Kai Xian b xiank@bjtrc.org.cn Xuesong Zhou b c \u204e xzhou74@asu.edu a Department of Civil Engineering, Tsinghua University, No. 1 Zhongguancun East Road, Haidian District, Beijing, China Department of Civil Engineering Tsinghua University No. 1 Zhongguancun East Road, Haidian District Beijing China b Beijing Transport Institute, No. 9 LiuLiQiao South Road, Fengtai District, Beijing, China Beijing Transport Institute No. 9 LiuLiQiao South Road, Fengtai District Beijing China c School of Sustainable Engineering and the Built Environment, Arizona State University, Tempe, AZ, USA School of Sustainable Engineering and the Built Environment Arizona State University Tempe AZ USA \u204e Corresponding author at: School of Sustainable Engineering and the Built Environment, Arizona State University, Tempe, AZ, USA. School of Sustainable Engineering and the Built Environment, Arizona State University Tempe AZ USA Highlights \u2022 Passenger flow state estimation framework to integrate Lagrangian and Eulerian observations. \u2022 A discretized state definition for the discrete approximation of continuous passenger flow. \u2022 A space-time-state hyper network to integrate structurally heterogeneous data sources. \u2022 A decomposition solution framework for application in large-scale urban rail transit networks. Abstract In this study, we focus on one of practically important research problems of integrating Lagrangian and Eulerian observations for passenger flow state estimation in an urban rail transit network. The task is accomplished by using a triple of flow, density, and speed to construct a discretized passenger flow state, further constructing a space-time-state (STS) hyper network so that we can utilize a better defined three-dimensional solution space to integrate structurally heterogeneous data sources. The monitoring data include passenger transaction records and identification space-time samples observed over a possible range of a few hours from origins to destinations (Lagrangian observations), and time-dependent passenger counts collected at some key bottleneck locations (Eulerian observations). To describe the complex urban-rail passenger flow evolution, passenger traveling and fixed sensor state transition processes can be unified within a STS path representation. To estimate the consistent system internal states between two different types of observations, we formulate a hyper network-based flow assignment model in a generalized least squares estimation framework. For applications in large-scale transportation networks, we decompose the proposed model into three easy-to-solve sub-problems. The proposed model is applied to a real-world case based on the Beijing subway network with complete smart card data for each passenger at his/her origin and destination and time-dependent passenger counts in several key transfer corridors, while the specific space-time trajectories of all passengers and high-resolution time-dependent congestion levels at platforms, in trains, and in transfer corridors are estimated. This proposed passenger flow state inference method can provide a rich set of state inferences for advanced transit planning and management applications, for instance, passenger flow control, adaptive travel demand management, and real-time train scheduling. Keywords Discretized passenger flow state Urban rail transit network Lagrangian and Eulerian observations Space-time-state network Decomposition solution framework 1 Introduction 1.1 Motivation Urban rail transit systems around the world are experiencing rapid expansions in scale and large increases in demand, especially in developing major metropolitan areas. For example, the total length of the metropolitan rail has exceeded 608 km across a total of 22 lines in the Beijing subway network at the end of 2017 (China-Daily, 2018a), and the network will expand to 900 km with 30 lines by 2020 (Bao, 2018). Once completed, the subway network will be able to handle a flow of 15 million passengers a day. With the development of data collection technology, multi-source observation data are available in urban rail transit systems. Recently, a large number of passengers have paid by their mobile phones through scanning the QuickMark code (China-Daily, 2018b), and this emerging technology makes it possible to integrate transaction records from the Automated Fare Collection (AFC) system with other location-based services, such as Smart Phone, Bluetooth, and Wi-Fi for each individual passenger. To offer effective traffic optimization solutions in large-scale and demand-oversaturated urban rail transit networks in the era of large quantities and varying detailed data, the transportation system managers need to (1) fully utilize all available observations from the underlying multi-source sensor networks, to estimate the network-wide passenger flow states, and (2) proactively design control strategies to mitigate estimated or forecasted traffic congestion (Zeng and Li, 2018). However, it is impossible to install fixed sensors everywhere (at platforms, in trains, and in transfer corridors) and trace the specific space-time trajectory for every passenger entering into the urban rail transit system. Therefore, it leads to a practically important research problem of integrating the multi-source observation data for passenger flow state estimation in an urban rail transit network. One of the key methodological challenges in the application of traffic data fusion is to integrate multi-source observation data (Lagrangian and Eulerian observations), with different temporal and spatial resolutions, into a unified modeling framework for high-resolution state estimates. Specifically, in an urban rail transit network, Lagrangian observations denote the transaction records at origin and destination from AFC system and identification space-time samples during a trip obtained from Smart Phone, Bluetooth, and Wi-Fi for each individual passenger (Pelletier et al., 2011; Yang et al., 2002; van den Heuvel et al., 2015; Carrel et al., 2015); and Eulerian observations refer to the time-dependent aggregated or average passenger flow and density measurements at some key bottleneck locations. High-resolution state estimates for individual passenger trajectories and congestion levels at fixed locations can help schedule the system states to reach a higher precision of controllability. Therefore, this study aims to integrate the multi-source and heterogeneous observation data for network-wide passenger flow state estimation at two levels: (1) reconstructing the specific space-time trajectories of all passengers from their origins to destinations; and (2) estimating the high-resolution time-dependent congestion levels at platforms, in trains, and in transfer corridors. 1.2 Literature review 1.2.1 Passenger assignment models In an urban rail transit network, there are several critical and practical problems related to dynamic passenger flow estimates, including estimation and prediction of the passenger distribution over the network, identification of saturated parts of the network, detection of crowded stations and trains on lines. These tasks are accomplished by passenger assignment models in previous studies. In general, there are two types of passenger assignment models (Fu et al., 2012): (1) frequency-based models and (2) schedule-based models. Frequency-based models (Nguyen and Pallottino, 1988; Spiess and Florian, 1989; Wu et al., 1994; Cominetti and Correa, 2001; Cepeda et al., 2006; Teng and Liu, 2015) formulate transit services by lines with train frequencies without considering the capacity of each single vehicle, which focus on predicting passenger route choices from their origins to destinations and offering the corresponding service level and congestion on lines. To further account for passenger waiting queues at stations, single train loads, and oversaturated situations, several scheduled-based models are proposed (Nguyen et al., 2001; Poon et al., 2004; Hamdouch and Lawphongpanich, 2008; Nuzzolo et al., 2012; Hamdouch et al., 2014; Kroon et al., 2014; Liu and Zhou, 2016; Binder et al., 2017; Shang et al., 2018). In scheduled-based models, tight train capacity can be explicitly formulated (Hamdouch and Lawphongpanich, 2008; Nuzzolo et al., 2012), and specific rules for passenger traveling can be considered, such as the boundedly rational decision rule (Liu and Zhou, 2016), the first-in-first-out (FIFO) rule (Kroon et al., 2014; Shang et al., 2018), and other exogenous priority rules (Binder et al., 2017). Recently, the passenger assignment models have been integrated into the transit network design problem (Liu and Zhou, 2016), operational line planning problem (Canca et al., 2017), and tactical transit timetabling and frequency setting problems (Canca et al., 2016; Zhu et al., 2017c; Canca et al., 2018), to coordinately estimate and predict the variable feature of passenger demand and flow dynamics. These previous studies about passenger assignment models have made great contributions to a deep understanding and numerical efficient algorithms for estimating the passenger distribution over the transit network. To the best of our knowledge, few studies have tried to completely handle the oversaturated conditions and reconstruct the passenger space-time trajectories based on the identification samples obtained from the AFC system, especially for the identification samples with large time delays. 1.2.2 Data-driven transit system state estimation method Recent development of advanced communication and data collection technologies enables a wide range of possibilities for data-driven estimation and prediction of travel pattern, train crowded levels, and passengers left behind in urban rail transit networks (Lu et al., 2018). Daily habitual travel patterns are useful for transport planners to forecast how travelers choose among available alternatives (destination, mode, departure time, etc.) under given circumstances, which can be mined from the smart card data (Ma et al., 2013; Zhong et al., 2015; Zhou et al., 2017a). Transit passenger origin-destination data are crucial for transit system planning and route optimization, which can be also inferenced from AFC data (Ma et al., 2012). At operational level in urban rail transit systems, specific crowding at stations and in trains, and passengers left behind are important for operators to (1) measure the network-wide performance of the system in oversaturated situations and (2) develop real-time or short-term strategies to improve capacity utilization. Zhu et al., (2017a) and Zhu et al., (2017b) proposed probabilistic models to estimate the individual train loads, passenger left behind probabilities, time-dependent crowding levels at stations under tight vehicle capacity considerations using (1) transaction records from AFC systems and (2) Automatic Vehicle Location data from train tracking systems. Although previous data-driven methods can offer beneficial information for planners and managers to observe time-varying system states, there is a lack of a general modeling framework to integrate the flow-based Eulerian observations at fixed locations and the disaggregated Lagrangian observations over the network for the problem of passenger flow state estimation in an urban rail transit system. 1.3 Contributions and structure of this paper The availability of multi-source and heterogeneous traffic data brings opportunities and challenges for systematically estimating the network-wide passenger flow states. Different from traditional schedule-based passenger assignment models (Specific comparison can be found in Appendix D), we are actually considering all available full-process Lagrangian observations for each passenger, and integrating Eulerian observation from fixed sensors located at some key locations. The proposed passenger flow state estimation model aims to reconstruct and estimate the specific space-time trajectory for each individual passenger and the time-dependent congestion levels at platforms, in trains, and in transfer corridors. The potential contributions of our work are specifically listed as follows. (1) Derived from the space-time-velocity field v (t, x) (Work et al., 2010; Zhou et al., 2017b), this study extends the velocity dimension of v (t, x) into a general state dimension to construct a space-time-state (STS) hyper network M (t, x). The state dimension is built by the discretization of the continuous passenger flow evolution, referring to a triple of flow q, density k, and speed v (q\u202f=\u202fkV (k)\u202f=\u202f Q (k)), leading to a hyper STS network, so that we can utilize a better defined three-dimensional solution space to integrate structurally heterogeneous data sources. (2) Passenger traveling and fixed sensor state transition processes are unified within a STS path representation. Transaction records obtained from the AFC systems are setting as boundary conditions of the STS path for each passenger, and the identification space-time samples are adopted to reduce the STS searching space. The time-dependent passenger counts collected at some key bottleneck locations are mapped into the STS network to reduce the prism of the STS path. (3) To estimate the internally consistent states between two different types of observations, we propose a hyper network-based flow assignment model in a generalized least squares estimation framework. To handle large-scale applications, the proposed model is finally solved by a heuristic iterative method under the decomposition solution framework. Several issues associated with the proposed model and solution method are analyzed based on a simple network and a medium-scale network with hypothetic ground-truth data. The large-scale experiment is conducted based on the Beijing subway network with real-world data. The remainder of this paper is organized as follows. The notations and the problem statement are presented in Section 2 together with a discussion of general operating procedure. Section 3 describes several fundamental concepts in a schedule-based urban rail transit network. We formally propose a hyper network-based assignment model for the network-wide passenger flow state estimation problem in Section 4. Section 5 provides a decomposition framework for large-scale applications. A simple example, a medium-scale example with hypothetic ground-truth data, and a large-scale real-world case are implemented in Section 6. Finally, conclusions and further research directions are stated in Section 7. 2 Notations, problem statement, and general operating procedure 2.1 Notations In this section, we introduce the notations used in this study for the network-wide passenger flow state estimation problem. The parameters and subscripts are listed in Table 1 , and the decision variables for the model formulation are listed in Table 2 . 2.2 Problem statement Consider an urban rail transit network with a set of physical nodes Vs , a set of physical links Es , and a pre-set study time horizon t\u202f=\u202f1, 2, \u2026, T. The following input data are available: (1) The prior information on the urban-rail passenger flow characteristics for each link (i, j), which is adopted to generate the corresponding discretized passenger flow state with a triple of reference flow, density, and speed. (2) The scheduled transit services presented by space-time arcs (i, j, t, t\u2032) on each link (i, j) for all given services from time t to time t\u2032. (3) The Lagrangian observations for each passenger a, including the origin node oa , departure time DTa , destination node da , and arrival time ATa . It should be noted that we can obtain the complete smart card data for all passengers from the AFC system in an urban rail transit network. (4) The Eulerian observations for each fixed sensor a\u2032, including the observed link index (i a\u2032,j a\u2032) and the corresponding time-dependent observed flows, densities, or speeds. The proposed network-wide passenger flow state estimation model aims to integrate all available Lagrangian and Eulerian observations in the proposed hyper STS network to: (a) reconstruct the specific traveling process { x a l ( i , j , t , t \u2032 , m , m \u2032 ) } for each passenger a; (b) reconstruct the state transition process { x a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) } for each fixed sensor a\u2032; and (c) estimate the most likely system internal state z(i, j, t, m) for each link (i, j) at any time t. Fig. 1 illustrates the state estimation framework for an urban rail transit network. 2.3 Step-by-step operating procedure Based on the proposed framework in Fig. 1, we can describe the following step-by-step instructions to carry out this network-wide passenger flow state estimation procedure. We assume that there exists a unique system internal state for each link during a specific time interval. As there are observation errors and possible inconsistencies between different data sources, we will use a generalized least square estimation framework to obtain the unique system internal state estimates. Step 1: [Prepare discretized passenger flow states ( Section 3.2 )] Generate the corresponding discretized passenger flow states for each type of links in the urban rail transit network; Step 2: [Construct 3-dimensional network ( Section 3.3 )] Construct the STS hyper network based on the physical rail transit network, given schedules, and defined discretized passenger flow states; Step 3: [Map observations into the hyper network ( Section 4 )] Map Lagrangian observations of each passenger as STS vertices in the STS hyper network, and use the Eulerian observations from fixed sensors to limit the possible states at a given time at each location. Step 4: [Enable path finding algorithm ( Section 5 )] Enable the most likely path finding algorithm within constrained search space in the proposed STS hyper network; Step 5: [Problem decomposition and sequential assignment ( Section 5 )] For large-scale applications with numerous variables and constraints, apply a decomposition framework to perform sequential assignment, and obtain the estimated network-wide internal system states iteratively. 3 Fundamental concepts in a schedule-based urban rail transit network In this section, we elaborate the details in building the STS hyper network for a schedule-based urban rail transit system, and procedures to adopt the proposed passenger flow state estimation framework for applications. 3.1 Space-time network construction based on physical rail transit network and schedule Consider a physical rail transit network with a set of nodes (stations) Vs and a set of links (rail segments and transfer corridors) Es as shown in Fig. 2 (a). Each link can be denoted as a directed link (i, j) from upstream node i to downstream node j. A deterministic transit schedule is available for each train. We then construct a space-time network (Est , Vst ), as shown in Fig. 2(b): node i is extended to a set of vertices (i, t) at each time interval t in the study horizon, t\u202f=\u202f1, 2, \u2026, T. The transit schedule from node i to node j from time t to time t\u2032 can be represented by a service arc (i, j, t, t\u2032), where (t\u2032\u202f\u2212\u202ft) is the exact scheduled link travel time. The capacity of each service arc is associated with the train carrying capacity. Waiting arc (i, i, t, t\u202f+\u202f1) is built from vertex (i, t) to vertex (i, t\u202f+\u202f1) at node i with waiting time of 1 time unit and its capacity is defined as the platform storage capacity. In addition, transfer arc (i, j, t, t\u2032) is built from node i to node j from time t to time t\u2032, where (t\u2032\u202f\u2212\u202ft) corresponds to the transfer time. It should be noted that all scheduled link travel times, waiting times, and transfer times should be integer multipliers of one-time interval. For practical applications, the duration of time interval should be properly chosen to reach a balance between modeling details and computational efficiency, according to the requirements in specific operation and management applications. Readers interested in the space-time network formulation of a schedule-based urban rail transit network can find more details in the work by Liu and Zhou (2016). 3.2 Discretized passenger flow state definition in a schedule-based urban rail transit network The fundamental diagram, also known as a speed-density relation, flow-density relation, or flux function, describes the empirical relation among traffic state variables (q, k, v) in stationary traffic (Daganzo, 1997). The application in vehicle traffic management has inspired the related studies to explore the existence and the characteristics of the pedestrian flow. Hoogendoorn et al., (2017) proposed the pedestrian Macroscopic Fundamental Diagram (p-MFD) where the average flow from a pedestrian network is modeled as a function of the average spatial density. Therefore, compared to the vehicle moving process in the urban road network, the passenger traveling process in an urban rail transit network also follows certain flow-density-speed relation from a mesoscopic perspective. In both cases, a triple of state variables (q, k, v) satisfy Eq. (1), or equivalently, Eq. (2). Fig. 3 shows the relations on different processes of passenger traveling in a schedule-based urban rail transit network: (a) waiting at platforms; (b) riding in trains; and (c) transferring between stations on different lines. (1) v = V ( k ) (2) q = k V ( k ) = Q ( k ) In Fig. 3(a), in the riding process (blue lines), passenger flow has a constant moving speed consistent with the scheduled link travel time, corresponding to a horizontal line ending at train storage capacity in the density dimension. During the waiting process (red lines), passenger flow has a zero speed, and the speed-density and flow-density relations have both horizontal lines constrained by the spatial platform storage capacity. During the transfer process, the pedestrian traffic flow has a density-flow-speed relationship similar to the case for vehicle traffic flow (Seyfried et al., 2009; Steffen and Seyfried, 2010; Zhang et al., 2013; Zhang et al., 2014; Zhao and Zhang, 2017). In particular, Ji et al. (2013) and Ji et al. (2016) focused on analyzing pedestrians\u2019 walking through crowds in a transfer station corridor and the same type of pedestrian density-flow relation with that in Fig. 3 was observed. We now further define the discretized passenger flow states, each referring to a triple of reference flow, density, and speed, as reference speed-density points and flow-density points shown in Fig. 3(a) and (b). It should be noted that the reference point should be located within the speed-density and flow-density curves to ensure that the reference density of each discretized passenger flow state does not exceed the corresponding jam density (platform, train, and transfer corridor storage capacities). As part of system state identification and practical applications, the speed-density relations and flow-density relations need to be carefully calibrated. For example, critical parameters of flow-density relation for the passenger riding process include train capacity and scheduled running speed, and a key parameter of the flow-density relation is the platform capacity. Along this line, interested readers are referred to similar calibration procedures carried by pedestrian experiments for the flow-density relation in the transfer process (Zhao and Zhang, 2017). Besides, subway system planners can also use simulation methods to examine the passenger flow-density relation of the transfer process (Gao et al., 2014; Ji et al., 2016). 3.3 STS hyper network construction based on discretized passenger flow states 3.3.1 Building STS hyper network for passenger assignment In a schedule-based urban rail transit network, each passenger is naturally a mobile sensor, whose Lagrangian observations are passenger transaction records from AFC system and identification space-time samples during a trip from Smart Phone, Bluetooth, and Wi-Fi. The taping-in and taping-out data have been used in passenger-to-train assignment models (Zhu et al., 2017a; Zhu et al., 2017b) and scheduled-based passenger assignment models (Liu and Zhou, 2016; Shang et al., 2018). In this study, we further extend the traditional space-time network (Vst , Est ) proposed in Section 3.1 into a STS hyper network (Vsts , Ests ) for schedule- and state-based passenger assignment, in which the traveling process of each passenger and the coupled system internal states can be estimated in a more consistent way. Specifically, a space-time arc (i, j, t, t\u2032), can be extended to a set of STS arcs (i, j, t, t\u2032, m, m\u2032) mapping from state m to state m\u2032 (m, m\u2032 \u2208 M), and the attributes of reference flow r e f i , j q ( m ) , density r e f i , j k ( m ) , and speed r e f i , j v ( m ) are given to each extended STS arc (i, j, t, t\u2032, m, m\u2032). It should be noted that, the second time index t\u2032 should be calculated by Eq. (3) for transfer STS arc (i, j, t, t\u2032, m, m\u2032), where TT i,j (m) is the travel time of link (i, j) at state m. The length l i,j and the reference speed value r e f i , j v ( m ) determine the travel time in Eq. (4). (3) t \u2032 = t + T T i , j ( m ) (4) T T i , j ( m ) = l i , j re f i , j v ( m ) It should be particularly highlight that, in the space-time-cumulative function N (t, x) (Moskowitz and Newman, 1963; Newell, 1993; Daganzo, 1997) and the space-time-velocity field V (t, x) (Work et al., 2010; Zhou et al., 2017b), the underlying road traffic dynamics and related state transition matrices (from time t to time t\u202f+\u202f1) are included in the state estimation framework. In the current version of our proposed STS hyper network M (t, x), we have not fully emphasized how to include the underlying dynamics of passenger flows, due to complex passenger flow evolution. Instead, a steady-state fundamental diagram (speed-density and flow-density relations) is used as a discrete approximation of the continuous passenger flow, mainly for the reason of solving the simplified model through proper problem decomposition. In our related studies, we did also try to incorporate a richer spectrum of traffic state transition processes, within a standard (continuous) Kalman filtering framework (Zhou and Mahmassani, 2007; Zhou and List, 2010). Fig. 2(c) illustrates the STS hyper network with two discretized passenger flow states detailed in Table 3 . Fig. 2(c) depicts a traveling process in which a passenger departs from the origin node 1 at time 1 and arrives at the destination node 4 at time 7. We can attach the space-dependent and time-dependent attributes to the passenger flow representation in the proposed STS network, such as the service level at the platforms and in the trains, and the crowding level and transfer time in transfer corridors. 3.3.2 Building STS hyper network for fixed sensor state transition In an urban rail transit network, the Eulerian observations, including the local passenger flow and density, are available from cameras and automatic count system equipped at platforms, in trains, and in transfer corridors. In our study, STS arcs represent the state transition process of each fixed sensor, in which the most likely state transition path will be estimated. For fixed sensor a\u2032 at position i a\u2032, it has its own separate state-time plane. We build STS arcs (i, i, t, t\u202f+\u202f1, m, m\u2032) to denote that the passenger flow state on link (i, j) transforms from state m at time t to state m\u2032 at time t\u202f+\u202f1, where (i, j)\u202f=\u202f(i a\u2032,j a\u2032). Fig. 4 depicts the selected state transition paths in the STS hyper network of three fixed sensors located at the platform (Station 1), in the transfer corridor, and in the train (Line 2), respectively. 4 Model formulation The passenger flow state estimation problem is formulated as a hyper network-based assignment model in a generalized least squares estimation framework, to select the most likely and consistent states between coupled STS paths for passengers and fixed sensors. 4.1 Model formulation for schedule- and state-based passenger assignment (1) Passenger flow balance constraint. The standard passenger flow balance constraint for each passenger can be listed as Eq. (5). The Lagrangian observations such as taping-in and tapping-out data are mapped as the corresponding origin and destination vertices (origin vertex (oa,DTa,m 0) and destination vertex (da,ATa,m 0)) in the STS hyper network, which is equivalent to the boundary conditions in the general traffic state estimation problem. (5) \u2211 j , t \u2032 , m \u2032 : ( i , j , t , t \u2032 , m , m \u2032 ) \u2208 E sts x a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2212 \u2211 j , t \u2032 , m \u2032 : ( j , i , t \u2032 , t , m \u2032 , m ) \u2208 E sts x a l ( j , i , t \u2032 , t , m \u2032 , m ) = { 1 i = o a , t = D T a , m = m 0 \u2212 1 i = d a , t = A T a , m = m 0 0 otherwise \u2200 a (2) Measurement equation for aggregating individual passengers to discretized passenger flow states. At any time t, we can map the aggregated time-dependent passenger count \u2211 a \u2211 m \u2208 M x a l ( i , j , t , t + T T i , j ( m ) , m , m \u2032 ) on link (i, j) to the system internal state z(i, j, t, m) through reference density r e f i , j k ( m ) in Eq. (6). One can examine the equation across three different types of arcs: waiting ((i, j)\u202f=\u202f(i, i)), service, and transfer. (6) \u2211 a \u2211 m \u2032 \u2208 M x a l ( i , j , t , t + T T i , j ( m ) , m , m \u2032 ) = r e f i , j k ( m ) \u00d7 z ( i , j , t , m ) \u2200 ( i , j ) , \u2200 t , \u2200 m (3) System internal state uniqueness constraint. Again, we assume a unique discretized passenger flow state for each link (i, j) at any time t in Eq. (7). (7) \u2211 m z ( i , j , t , m ) = 1 \u2200 ( i , j ) , \u2200 t 4.2 Model formulation for fixed sensor state transition (1) Fixed sensor flow balance constraint. As the state transition process of each fixed sensor has been embedded into a STS path representation, we formulate the fixed sensor flow balance constraint as Eq. (8). (8) \u2211 t \u2032 , m \u2032 : ( i , i , t , t \u2032 , m , m \u2032 ) \u2208 E sts x a \u2032 e ( i , i , t , t \u2032 , m , m \u2032 ) \u2212 \u2211 t \u2032 , m \u2032 : ( i , i , t \u2032 , t , m \u2032 , m ) \u2208 E sts x a \u2032 e ( i , i , t \u2032 , t , m \u2032 , m ) = { 1 i = i a \u2032 , t = 1 , m = m 0 \u2212 1 i = i a \u2032 , t = T , m = m 0 0 otherwise \u2200 a \u2032 (2) Measurement equations for Eulerian observations. Without loss of generality we assume that the Eulerian observations including local flow obsq (a\u2032,t), density obsk (a\u2032,t), and speed obsv (a\u2032,t) can be obtained from fixed sensor a\u2032 on link (i, j)\u202f=\u202f(i a\u2032,j a\u2032) at time t. If we consider error-free measurements, Eq. (9) maps the external observations to the state transition process of the fixed sensor. The estimated flow, density, or speed (the right side of Eq. (9)) should equal to the corresponding observed ones (the left side of Eq. (9)) without any observation error and approximation error. (9) { o b s q ( a \u2032 , t ) = r e f i , j q ( m ) \u00d7 \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) o b s k ( a \u2032 , t ) = r e f i , j k ( m ) \u00d7 \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) o b s v ( a \u2032 , t ) = r e f i , j v ( m ) \u00d7 \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) \u2200 a \u2032 , \u2200 ( i , j ) = ( i a \u2032 , j a \u2032 ) , \u2200 t , \u2200 m Accordingly, the state transition process of each fixed sensor should be coupled with the system internal states, given as Eq. (10). At any time t, we can map the estimated flow, density, or speed on link (i, j) (the left side of Eq. (10)) to the system internal state z(i, j, t, m) through the corresponding reference flow, density, or speed (the right side of Eq. (10)). (10) { \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) \u00d7 r e f i , j q ( m ) = \u2211 m \u2033 z ( i , j , t , m \u2033 ) \u00d7 r e f i , j q ( m \u2033 ) \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) \u00d7 r e f i , j k ( m ) = \u2211 m \u2033 z ( i , j , t , m \u2033 ) \u00d7 r e f i , j k ( m \u2033 ) \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) \u00d7 r e f i , j v ( m ) = \u2211 m \u2033 z ( i , j , t , m \u2033 ) \u00d7 r e f i , j v ( m \u2033 ) \u2200 a \u2032 , \u2200 ( i , j ) = ( i a \u2032 , j a \u2032 ) , \u2200 t , \u2200 m 4.3 A generalized least square estimation framework Given different types of observation errors and inherent biases or inconsistency between different data sources, we hope to minimize the deviation between the system internal state estimates and the external observations subject to a set of critical constraints listed above. We now consider the measurement equations Eqs. (6), ((9), and (10)) in a generalized least squares estimation framework, which aims to minimize the three items of squares deviations L(Xl,Z), L(Obse,Xe ), and L(Xe,Z) between the system internal states and Lagrangian and Eulerian observations in the objective function (11), where \u03b1, \u03b2, and \u03b3 are the pre-set weights of these three items of square deviations. Passenger flow state estimation model: Objective function, (11) M i n \u03b1 \u00d7 L ( X l , Z ) + \u03b2 \u00d7 L ( O b s e , X e ) + \u03b3 \u00d7 L ( X e , Z ) (12) L ( X l , Z ) = \u2211 ( i , j ) \u2211 t \u2211 m \u2211 t \u2032 = t + \u03c4 i , j ( m ) [ \u2211 a \u2211 m \u2032 x a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2212 r e f i , j k ( m ) \u00d7 z ( i , j , t , m ) ] 2 (13) L ( Ob s e , X e ) = { \u2211 a \u2032 \u2211 ( i , j ) = ( i a \u2032 , j a \u2032 ) { \u2211 t \u2211 m [ ob s q ( a \u2032 , t ) \u2212 re f i , j q ( m ) \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) ] 2 } \u2211 a \u2032 \u2211 ( i , j ) = ( i a \u2032 , j a \u2032 ) { \u2211 t \u2211 m [ ob s k ( a \u2032 , t ) \u2212 re f i , j k ( m ) \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) ] 2 } \u2211 a \u2032 \u2211 ( i , j ) = ( i a \u2032 , j a \u2032 ) { \u2211 t \u2211 m [ ob s v ( a \u2032 , t ) \u2212 re f i , j v ( m ) \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) ] 2 } (14) L ( X e , Z ) = { \u2211 a \u2032 \u2211 ( i , j ) = ( i a \u2032 , j a \u2032 ) { \u2211 t \u2211 m [ \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) \u00d7 r e f i , j q ( m ) \u2212 \u2211 m \u2033 z ( i , j , t , m \u2033 ) \u00d7 r e f i , j q ( m \u2033 ) ] 2 } \u2211 a \u2032 \u2211 ( i , j ) = ( i a \u2032 , j a \u2032 ) { \u2211 t \u2211 m [ \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) \u00d7 r e f i , j k ( m ) \u2212 \u2211 m \u2033 z ( i , j , t , m \u2033 ) \u00d7 r e f i , j k ( m \u2033 ) ] 2 } \u2211 a \u2032 \u2211 ( i , j ) = ( i a \u2032 , j a \u2032 ) { \u2211 t \u2211 m [ \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m , m \u2032 ) \u00d7 r e f i , j k ( m ) \u2212 \u2211 m \u2033 z ( i , j , t , m \u2033 ) \u00d7 r e f i , j k ( m \u2033 ) ] 2 } Subject to, Passenger flow balance constraint: Eq. (5). Fixed sensor flow balance constraint: Eq. (8). System internal state uniqueness constraint: Eq. (7). Binary variable definitions: x a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2208 { 0 , 1 } , x a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) \u2208 { 0 , 1 } , and z ( i, j, t, m ) \u2208 {0, 1}. 4.4 Discussion 4.4.1 Underlying the passenger flow dynamics in the proposed STS hyper network In the general traffic state estimation problem using cell transmission model (CTM) based switching-mode model (Mu\u00f1oz et al., 2003) and the Kalman filter method (Wang and Papageorgiou, 2005), the general type of vehicle conservation equation presented by Eq. (15) is adopted to illustrate the commonly used representation about traffic flow dynamics. Here, \u03c1 i (t) is the density of segment i during the time interval [t, t\u202f+\u202f1), \u2207t is the discrete time interval, li is the length of segment i, qi (t) is the number of vehicles leaving segment i during time period [t, t\u202f+\u202f1), and ri (t)/si (t) is the on-ramp inflow/off-ramp outflow in segment i (if any). (15) \u03c1 i ( t + 1 ) = \u03c1 i ( t ) + \u2207 t l i \u00d7 [ q i \u2212 1 ( t ) \u2212 q i ( t ) + r i ( t ) \u2212 s i ( t ) ] In our formulation, we have two types of state transition variables: the state transition variables X l = { x a l ( i , j , t , t \u2032 , m , m \u2032 ) } along the space-time trajectory of each mobile observer a (passenger a) and the state transition variables X e = { x a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) } at a specific location of each fixed observer a\u2032, which are coupled by the internal system state variables Z\u202f=\u202f{z(i, j, t, m)} at each location for any time. Therefore, the state transition process of our modeling system can be represented by the three groups of equations presented by Eq. (16). (16) { X l = b ( X l ) X e = b ( X e ) X l + X e \u2212 Z = 0 Fig. 5 shows a conceptual mapping from the standard traffic dynamics modeling framework to our proposed STS hyper network. The density variation from time t to time t\u202f+\u202f1 is incorporated in the state transition process of fixed observers. The spatial evolution of traffic dynamics can be captured by the state transition equation of mobile observers in the STS hyper network. The state transition process of mobile observers in the STS network, with the completely observed boundary conditions in our urban rail transit system, corresponds to the external traffic inflow and outflow in the standard form. As an urban rail transit network is really a very complex system, it is import to model the system with a reasonable simplification, referring to a majority of studies focusing on the passenger assignment problem (Nguyen and Pallottino, 1988; Hamdouch and Lawphongpanich, 2008; Binder et al., 2017), transit network design problem (Liu and Zhou, 2016), timetabling and frequency setting problems (Canca et al., 2016; Canca et al., 2018), and network-level train control problem (Li et al., 2018). As shown in Fig. 6 , stations are modeled as nodes, and tracks between adjacent stations are depicted by directed links from the upstream station to the downstream station. One transfer corridor between transfer stations on different lines is also modeled as a single directed link in this study. As a result, we adopt a steady-state fundamental diagram (speed-density and flow-density relations) as a discrete approximation of the continuous passenger flow in waiting, riding, and transfer processes. Specific crowding at platforms and transfer passenger flow dynamics in more details (time-dependent characteristics, interaction between passengers, and congestion and delay propagation) should be addressed by further dividing one link into a number of cells or sub-segments based on CTM (Guo et al., 2011; H\u00e4nseler et al., 2014; H\u00e4nseler et al., 2017) as shown in Fig. 6(b). 4.4.2 Intermediate Lagrangian observations: identification passenger space-time samples during a trip In an urban rail transit network, the origin and destination of each passenger can be obtained from the AFC system, which are formulated as the boundary conditions of the STS path in Eq. (5). Thanks to recent developments of data collection and e-payment technologies, a significant number of passengers start paying transit fares by their mobile phones (China-Daily, 2018b). Along this line, we can also obtain space-time samples by Smart Phone, Bluetooth, and Wi-Fi, which can help reconstruct the passenger space-time trajectories. The intermediate identification space-time samples, can be mapped as vertices in the STS hyper network to reduce the STS path searching space in Eq. (17). In detail, if passenger a is identified at node i at time t, Eq. (17) ensures that the projection of the STS path of passenger a on space-time network goes through the space-time vertex (i, t). (17) \u2211 j , t , \u2032 m , m \u2032 : ( i , j , t , t \u2032 , m , m \u2032 ) \u2208 E s t s x a l ( i , j , t , t \u2032 , m , m \u2032 ) = 1 \u2200 a , \u2200 ( i , t ) \u2208 \u03a6 a 4.4.3 Considering passenger route choice Modeling passenger route choice is a significant and challenging task in an urban rail transit network. Liu et al., (2010) has made a comprehensive review about passenger route choice modeling from the transit assignment perspective, including static transit assignment, within-day dynamic transit assignment, and emerging approaches. Besides routing models, passenger routing information can also be obtained from stated and revealed preference surveys or other data source (i.e., GPS on the smart phone). Route choice in an urban rail transit network is indeed an important factor for the passenger flow state estimation model. A typical logit-based and user utility-maximization oriented route choice preferences are not incorporated in this model, while we do aim to generate a reasonable set of passenger path choice options. Based on a recent questionnaire survey about the passenger route choice in the Beijing subway network, a majority of OD pairs select one route, while there are typically at most 5 potential routes for passengers with long-distance and multi-transfer OD pairs. Accordingly, for practical applications, we can pre-generate a total of K shortest routes in an urban rail transit network for each OD pairs. The physical links, which belong to one of the K shortest routes for the OD pair (oa,da ), can be stored in the sub-set Es (a) for each passenger a. Then, we can generate the corresponding set Ests (a) of STS arcs for each passenger a to be potentially selected. For (i, j) \u2208 Es (a), the corresponding STS arcs (i, j, t, t\u2032, m, m\u2032) are assigned into the sub-set Ests (a). Therefore, the passenger flow balance constraint Eq. (5) can be reformulated into Eq. (18) considering the potential K shortest routes for each passenger a. (18) \u2211 j , t \u2032 , m \u2032 : ( i , j , t , t \u2032 , m , m \u2032 ) \u2208 E s t s ( a ) x a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2212 \u2211 j , t \u2032 , m \u2032 : ( j , i , t \u2032 , t , m \u2032 , m ) \u2208 E s t s ( a ) x a l ( j , i , t \u2032 , t , m \u2032 m ) { 1 i = o a , t = D T a , m = m 0 \u2212 1 i = d a , t = A T a , m = m 0 0 o t h e r w i s e \u2200 a 5 A problem decomposition solution framework for large-scale applications The proposed model is a mixed integer quadratic programming (MIQP) model with a large number of variables and constraints. As shown in Fig. 7 , there are three types of decision variables with their own constraints in our formulation for the passenger flow state estimation problem: (a) system internal state variables Z\u202f=\u202f{z(i, j, t, m)} with state uniqueness constraint, (b) passenger assignment variables X l = { x a l ( i , j , t , t \u2032 , m , m \u2032 ) } with passenger flow balance constraint, and (c) fixed sensor assignment variables X e = { x a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) } with fixed sensor flow balance constraint. The system internal states Z are coupled with the assignment variables of both passengers Xl and fixed sensors Xe in the STS hyper network. Therefore, we can solve the passenger and fixed sensor assignment problems independently with the fixed system internal states; meanwhile we can update the system internal states with the given passenger and fixed sensor assignment results. Then, the proposed model can be decomposed into three sub-problems: (a) passenger assignment problem; (b) fixed sensor assignment problem; and (c) system internal state updating problem as shown in Fig. 8 . We further propose a heuristic iterative method to sequentially solve these sub-problems as follows, where z ^ , x ^ a l , and x ^ a \u2032 e denote the fixed variables at current iteration. Step 1. Initialization. Step 1.1. Initialize the system internal states { z ^ ( i , j , t , m ) } 0 ; Step 1.2. Initialize the iteration number n\u202f=\u202f1. Step 2. Passenger and fixed sensor assignment in the STS hyper network at iteration n . Step 2.1. Solve the sub-problem for passenger assignment in the STS hyper network with fixed system internal states { z ^ ( i , j , t , m ) } n by Algorithm A1, and obtain the passenger assignment decision variables { x a l ( i , j , t , t \u2032 , m , m \u2032 ) } n for this iteration; Step 2.2. Solve the sub-problem for fixed sensor assignment in the STS hyper network with fixed system internal states { z ^ ( i , j , t , m ) } n by Algorithm A2, and obtain the fixed sensor assignment decision variables { x a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) } n for this iteration. Step 3. System internal state updating at iteration n . Solve the sub-problem for state updating with given passenger assignment results { x ^ a l ( i , j , t , t \u2032 , m , m \u2032 ) } n and fixed sensor assignment results { x ^ a \u2032 e ( i , j , t , t \u2032 , m , m \u2032 ) } n , and obtain the system internal state decision variables {z(i, j, t, m)} n for this iteration by Algorithm A3. Step 4. Convergence checking and termination condition. Check if n reaches the pre-set iteration number, terminate; otherwise, set n\u202f=\u202fn\u202f+\u202f1, and go to Step 2. 6 Numerical examples This section examines different aspects of the proposed passenger flow state estimation model and its solution approach. The comparison between CPLEX and the proposed decomposition solution framework is conducted based on a simple transit network in Section 6.1. In Section 6.2, several issues associated with the proposed model are analyzed in a medium-scale experiment with hypothetic ground-truth data, such as the spatial coverage of fixed sensors, the degrees of observation errors, and different numbers of discretized passenger flow states. For large-scale applications, we test our model and algorithm using the Beijing subway network in Section 6.3. The related source codes and test data sets in Section 6.1 and Section 6.2 can be downloaded at the websites: https://www.researchgate.net/publication/327449970_State_estimation_code_and_test_data_set; and https://www.researchgate.net/publication/328899150_Hypothetic_example. 6.1 A simple rail transit network This case examines the simple rail transit network (Fig. 2(a)) with 4 transit services on Line 1 and 5 transit services on Line 2 (Fig. 2(b)). Two discretized passenger flow states are adopted, namely free-flow state (State 1) and congestion-flow state (State 2). The reference flow, density, and speed for the two states have been listed in Table 3. There are 80 passenger samples and 5 fixed sensors. By aggregating passenger samples with the same origin node, departure time, destination node, and arrival time into one passenger group, we obtain 8 passenger groups listed in Tale B1. Table B2 shows the time-dependent observed link densities of each fixed sensor. The model can be solved by the CPLEX solver and the proposed decomposition solution framework (running for 10 iterations) for this simple transit rail network, and the same optimal solution can be obtained. The estimated passenger flows and fixed sensor state transitions are visualized in the STS hyper network as plotted in Fig. 9 and Fig. 10 . The objective value is zero in the optimal solution, which demonstrates that the system internal states can be perfectly estimated based on the input Lagrangian and Eulerian observations without errors and data noises. We can attach the space-dependent and time-dependent attributes to the passenger flow representation in the proposed STS network, such as the service level at the platforms and in the trains, and the crowding level and transfer time for transfer process. For instance, as shown in Fig. 9(b), passengers in Group 2 wait for one time interval at node 1 in the free-flow state; then ride a free-flow train on Line 1 from time 2 to time 3; then transfer from node 2 to node 3 in the congestion-flow state with transfer time being 2 time intervals; finally ride a congestion train on Line 2 from time 5 to time 6 to arrive at their destination. Besides, the time-dependent congestion levels at fixed locations are available from the estimated state transition paths of fixed sensors in the STS network. For instance, as shown in Fig. 10(d), the platform of station 3 on Line 2 keeps in a free-flow state from time 1 to time 4; then turns to a congestion state between time 5 to time 7; finally returns to a free-flow state after time 7. 6.2 A medium-scale experiment with hypothetic ground-truth data 6.2.1 Description In this section, we demonstrate the proposed model by the urban rail transit network shown in Fig. 11 , with four one-direction lines. There are five services on Line 1, three services on Line 2, four services on Line 3, and five services on Line 4, with the corresponding service link, start time, and end time for each service listed in Table C1. Scheduled link travel times are denoted as the sideward numbers in Fig. 11. According to the studies on pedestrian movement analysis in the transfer station corridor by Ji et al., (2013) and Ji et al., (2016), we generate the hypothetic transfer flow-density, transfer speed-density, and transfer time-density relations of transfer links (4,5) and (6,7) as shown in Fig. 12 . The study time horizon is from time 1 to time 60. According to the scale of the network shown in Fig. 11, a total of 2 shortest routes can be possibly selected for passengers of each OD pair. To start the numerical experiment, we offer a set of 170 passengers with their complete information, including origin, destination, arrival time, departure time, and specific space-time trajectory, as the ground-truth data visualized in Fig. 13 . Based on the ground-truth passenger space-time trajectories, the corresponding time-dependent densities at platforms, in trains, and in transfer corridors can be aggregated as the ground-truth observations for fixed sensors. Fig. 14 (a) and (b) show the ground-truth time-dependent observations (densities) at platforms and in trains, respectively. The numbers of passengers assigned on any space-time arcs (waiting, service, and transfer arcs) in the ground-truth data set do not exceed 15 passengers. As a result, we first define 16 discretized passenger flow states with corresponding reference density values being 0, 1, 2,\u2026, 15 to cover all the possible states as the complete discretization for the passenger flow in waiting, riding, and transfer processes. The reference flow, density, and travel time for each state have been listed in Table C2. 6.2.2 Solution performance and convergence test In this study, the mean absolute error (MAE) is adopted to evaluate the estimation performance of the proposed model and the decomposition solution framework. The MAE value can be calculated by Eq. (19), where \u03c0 ^ i , j , t denotes the ground-truth observations (density) for link (i, j) at time t, and \u03c0 i,j, t refers to the corresponding estimated ones. Here, it should be noted that the estimated passenger flow states for each link (i, j) at time t can be represented by different equations listed in the follows based on the three types of decision variables: (1) The aggregated passenger count \u2211 t \u2032 , m , m \u2032 ( i , j , t , t \u2032 , m , m \u2032 ) \u2208 E s t s \u2211 a x a l ( i , j , t , t \u2032 , m , m \u2032 ) ; (2) The estimated system internal state m*, where z(i, j, t, m*)\u202f=\u202f1; (3) The estimated state transition of fixed sensor, represented by state m*, where \u2211 m \u2032 \u2208 M x a \u2032 e ( i , i , t , t + 1 , m * , m \u2032 ) = 1 . Table 4 shows the detailed calculation method of estimation errors. As different components of the consensus constraint, the most likely discretized state m* can be found for link (i, j) at time t, while the aggregated passenger count denotes the exact number of passengers accordingly adopted as the estimated value \u03c0 i,j, t by Eq. (20). (19) M A E = 1 | E s | \u00d7 | T | \u2211 ( i , j ) \u2211 t | \u03c0 ^ i , j , t \u2212 \u03c0 i , j , t | (20) \u03c0 i , j , t = \u2211 ( i , j ) \u2211 t \u2211 t \u2032 , m , m \u2032 ( i , j , t , t \u2032 , m , m \u2032 ) \u2208 E s t s \u2211 a x a l ( i , j , t , t \u2032 , m , m \u2032 ) As the proposed model is formulated in a generalized least squares estimation framework, the objective function (Eq. (11)) denotes the sum of three types of square estimation errors: (a) square errors between the aggregated time-dependent passenger count and the estimated system internal states; (b) square errors between the Eulerian observations and the estimated system internal states; and (c) square errors between the fixed sensor estimates and the estimated system internal states. A smaller value of the objective function denotes that the estimation results have a better match with the input Lagrangian and Eulerian observations. Therefore, besides the density-MAE, the objective function value can be used to measure the estimation accuracy of the proposed model in this section. In this medium-scale experiment, the physical link set Es contains 8 service links, 8 waiting links, and 2 transfer links, and there are 60 one-min time intervals in the study time horizon. In the proposed decomposition solution framework, the iterative process starts from an initial solution of internal system states. For this purpose, we randomly generate a total of 5 initial solutions to test the convergence of the proposed algorithm. Besides, we also directly use the ground-truth system internal states as another initial solution. In the convergence test, we adopt the ground-truth densities from all fixed sensors as input Eulerian observations into the model. The proposed decomposition solution framework is encoded in Python language and runs on a personal computer with a 2.80\u202fGHz CPU and 16 GB memory. We run 5 iterations of the proposed algorithm starting from different initial solutions within 30 s. Fig. 15 shows the iterative processes with different initial solutions. All the iterative processes converge to the unique solution with both the objective values and density-MAE values being zero. Based on this limited set of results, the proposed model and algorithm can reconstruct the passenger space-time trajectories and estimate the passenger flow states at platforms, in trains, and in transfer corridors, which demonstrate the perfect matches with ground-truth data. 6.2.3 Spatial coverage of fixed sensors In an urban rail transit system, fixed sensors are usually not installed everywhere but at some key locations. Operators need to observe the system and estimate the passenger flow states with limited spatial coverage of fixed sensors, which affects the estimation performance. In this section, eight scenarios with different spatial coverage of fixed sensors are designed to demonstrate this issue. Table 5 lists the specific information about the eight scenarios. Fig. 16 shows the optimal objective function values and density-MAE values for the above eight scenarios. Scenario 1 with complete spatial coverage (Platform\u202f+\u202fTrain\u202f+\u202fTransfer corridor) can perfectly reconstruct the passenger space-time trajectories and estimate the passenger flow states at platforms, in trains, and in transfer corridors. Scenarios 2\u20138 all have varying estimation errors depending on their different spatial coverages of fixed sensors. The estimation resutls of the eight scenarios can offer operators beneficial information for improving the observability of the urban transit system with limited fixed sensors. 6.2.4 Varying degrees of observation errors from fixed sensors The time-dependent aggregated (average) passenger densities and flows collected by fixed sensors at platforms, in trains, and in transfer corridors, are likely prone to high error rates. Thus, we purposely generate six observation data sets with varying degrees of errors to evaluate the estimation performance. The six observation data sets are prepared based on the ground-truth observations plus additional errors. The additional errors in different observation data sets are random values which are subjected to the normal distributions with expection being 0 and standard variances being 0.0, 0.5, 0.8, 1.2, 2.0, 3.0, respectively. Accordingly, we can measure the degrees of generated observations errors by the standard variances. Fig. 17 shows the optimal values of the objective function and density-MAE values for observation data sets with different degrees of observation errors. The estimation errors measured by density-MAE values increase with a larger degree of observation errors. From this set of experiment, the estimation result and accuracy depend significantly on the quality of the observation data from fixed sensors, and the system operator can obtain reliable and accurate estimated passenger space-time trajectories and passenger flow states with a combination of fixed and mobile sensor data. 6.2.5 Different numbers of discretized passenger flow states The number of discretized passenger flow states determines the degree of approximation for the continuous passenger flow and the modeling solution space. Here, we design five scenarios with different discretized passenger flow states as shown in Table C3. Fig. 18 shows the optimal objective function values and density-MAE values for the scenarios with different numbers of discretized passenger flow states. The estimation errors measured by density-MAE increases as less discretized passenger flow states are adopted to build the STS network. As expected, the large number of discretized passenger flow states leads to an extensive solution space, which brings challenges for application into large-scale urban rail transit networks. 6.3 Large-scale experiment for estimating high-resolution passenger flow states in the Beijing subway network In order to examine the proposed passenger flow state estimation model in a real world data set, this section considers a test case using the Beijing subway network as shown in Fig. 19 , which contains a total of 18 lines, 343 stations, and 52 transfer stations. In previous studies using the Beijing subway network during peak hours, the major attention is on system service optimization, including timetable synchronization (Wu et al., 2015), passenger flow control (Shi et al., 2018; Li et al., 2017), energy-efficiency timetabling problem (Yin et al., 2017; Yin et al., 2016), and skip-stopping pattern optimization (Shang et al., 2018; Auffrey et al., 2017). Our study focuses on how to utilize multi-source data from the sensor network to infer high-resolution time-dependent passenger flow states at platforms, in trains, and in transfer corridors. This effort is critically important for generating reliable state estimates of the Beijing subway network, especially under dynamically changing and oversaturated traffic conditions. To capture the complex passenger waiting, riding, and transfer process, we construct an extended physical network with totally 1372 nodes and 3168 links. In order to derive the Lagrangian observations for the network, a total of 1393,093 passenger transaction record samples are obtained from the AFC system. The origin and destination of each passenger can be obtained from AFC system in the Beijing subway network on a typical workday, whose departure or arrival times are within the time period from 6:30 to 9:30. The Eulerian observations are obtained from the 228 fixed sensors (CCTV camera-based surveillance sensor systems) equipped at a total of 30 transfer stations denoted by the green triangles in Fig. 19, where we can collect the observed passenger densities every one minute in the key transfer corridors. In this large-scale experiment, the modeling time period is from 6:30 to 9:30, and the passenger flow states of interest cover the morning peak hours from 7:00 to 9:00, and the time interval is set to be 1\u202fmin. The above information is summarized in Table 6 . Based on a recent questionnaire survey conducted by the Beijing Transportation Information Center about the passenger route choice, there is usually only one route for passengers of most OD pairs. The total number of potential routes for passengers with long-distance and multi-transfer OD pairs is within 5. Therefore, we pre-generate a total of 5 shortest routes in the Beijing subway network for passengers of each pair to be potentially selected in this case. We define a total of 10 discretized passenger flow states for passenger waiting, riding, and transfer processes, each type of processes should select states within the maximum storage capacity. The reference speeds of passenger waiting and riding processes are set as zero and train running speed for all discretized passenger flow states with different densities. The reference speeds of passenger transfer process can be calibrated by experiment or empirical pedestrian density-speed sample data. The corresponding reference flows can be derived from q\u202f=\u202fkV(k). Table 7 details the full set of discretized passenger flow states for this large-scale experiment. We implement the proposed decomposition framework to solve the large-scale case for a total of five iterations using a PC (CPU: i7-7700HQ 2.80 GHZ with eight threads, 16 GB RAM) within approximate 6 h. A total number of 760,320 passenger flow states are estimated. Here, we only selected some important stations to show the estimated states in Fig. 20 , with those selected stations being marked in Fig. 19 by red circles. The estimation results of passenger flow states at platforms are beneficial for transit management centers to monitor the operating state of each platform, and the corresponding traffic management strategies can be made, such as high-precision multi-period passenger flow control strategy. For example, we can adopt a passenger flow control strategy between 7:30\u20138:00 at the Pingguoyuan station on Line 1 to mitigate the oversaturated conditions in the platform due to the safety concern as shown in Fig. 20(a); and the Longze station between 7:30\u20138:00 and 8:30\u20139:00 should be paid more attention by operators due to the severe congestion state at the down-direction platform. Passenger flow states in operating trains on each line is also important for not only transit management centers but also passengers. In Fig. 21 , we select 8 time intervals (7:00, 7:15, 7:30, 7:45, 8:00, 8:15, 8:30, and 8:45) from 7:00 to 9:00 to show the corresponding estimated passenger flow states in the operating trains on each line. Based on the estimation results, transit management centers can monitor the service level and crowding degree of all operating trains on each line, and accurately evaluate congestion mitigation strategies, such as train frequency adjustment and train unit updating. Transit management centers can also publish the passenger flow states to enable informed path and departure time choice of passengers. Further, the estimated network-wide passenger flow states can serve as a firm foundation to predict the time-dependent travel time and its reliability (Yang and Zhou, 2017) between different origin-destination pairs. To assess the estimation performance of the proposed model in the Beijing subway network due to the limitation of data sources, we consider a model which is consistent with the existing smart card data mining practice. That is, we do not consider the destination boundary conditions of the flow balance constraint Eq. (5), so the virtual sink vertex in Eq. (22) can be accessed from any time of final arrival, through additional dummy arcs at destination nodes Liu and Zhou, 2016). Then, the following model (Objective function: Eq. (21); Subject to Eqs. (22) and (23) can be solved with given estimated system internal states { z ^ ( i , j , t , m ) } . (21) min \u2211 ( i , j ) \u2211 t \u2211 m \u2211 t \u2032 = t + \u03c4 i , j ( m ) [ \u2211 a \u2211 m \u2032 x a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2212 r e f i , j k ( m ) \u00d7 z ^ ( i , j , t , m ) ] 2 (22) \u2211 j , t \u2032 , m \u2032 : ( i , j , t , t \u2032 , m , m \u2032 ) \u2208 E s t s x a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2212 \u2211 j , t \u2032 , m \u2032 : ( j , i , t \u2032 , t , m \u2032 , m ) \u2208 E s t s x a l ( j , i , t \u2032 , t , m \u2032 , m ) = { 1 i = o a , t = D T a , m = m 0 \u2212 1 i = d a , t = T , m = m 0 0 o t h e r w i s e \u2200 a (23) x a l ( i , j , t , t \u2032 , m , m \u2032 ) \u2208 { 0 , 1 } Here, we introduce EATa as the variable to denote the estimated arrival time of passenger a at his/her destination node which can be obtained from solving the above model (Eq. (24)). The estimation error of each passenger can be measured by the absolute deviation between estimated and observed arrival time at his/her destination presented by Eq. (25). (24) E A T a = \u2211 t , m x a l ( d ( a ) , d ( a ) , t , T , m , m 0 ) \u00d7 t (25) A b s o l u t e d e v i a t i o n ( a ) = | A T a \u2212 E A T a | Fig. 22 gives a comparison in details between the three models at different levels. In short, the model with only origin boundary conditions in Eq. (22) is denoted as Model level 1 (the above model), in which the origin Lagrangian observations are set as boundary conditions and the estimation errors are the time deviations between estimated and observed arrival time of each passenger at his/her destination. The proposed original passenger flow state estimation model in this study is the model with both origin and destination boundary conditions, denoted as Model level 2, so that we aim to minimize the square deviation between the system internal states and the Lagrangian and Eulerian observations inside the solution space. In the future, more accurate semi-continuous Lagrangian observation space-time samples are available due to the prolific growth of Smart Phone, Bluetooth, Wi-Fi, and the datasets they generate, which can be integrated into the passenger flow state estimation framework as intermediate indemnification space-time samples to further decrease the state solution space in the model with the triple of origin, destination, and intermediate boundary conditions (Model level 3). For Model level 1, Fig. 23 shows the number of passengers within different ranges of absolute deviation times and the corresponding cumulative percent curve. Specifically, the absolute deviations of 65% passengers are within 3\u202fmin and the absolute deviations of 82% passengers are within 5\u202fmin. In contract, Model level 2 can match more than 95% of arrival and departure time stamps, while the unmatched records could be due to many special conditions (Zhou et al., 2018). 7 Conclusions and future research The developments presented in this paper aim to provide a theoretical framework for formulating and solving the passenger flow state estimation problem, especially for applications in an urban rail transit network integrating Lagrangian and Eulerian observations. Different from schedule-based passenger assignment models (Nuzzolo et al., 2012; Hamdouch et al., 2014; Binder et al., 2017), passenger transaction records (origin, departure time, destination, arrival time) are mapped as vertices in the STS hyper network to be the boundary conditions for passenger traveling process. Compared with the passenger-to-train assignment models (Zhu et al., 2017a; Zhu et al., 2017b), we further integrate the time-dependent passenger counts collected at some key bottleneck locations as Eulerian observations to reduce the feasible state space of the system internal states. Passenger traveling and fixed sensor state transition processes are coupled through an internally consistent representation of states, which are estimated under an offline generalized least squares estimation framework. Our research constructs a hyper network-based assignment model, leading to the most likely path finding as a key optimization algorithm for both passengers and fixed sensors. By developing a decomposition solution framework suitable for large-scale applications, we can utilize efficient and exact solution algorithms for the three sub-problems. Several issues associated with the proposed model are analyzed in a medium-scale experiment with hypothetic ground-truth data, such as the spatial coverage of fixed sensors, the degrees of observation errors, and different numbers of discretized passenger flow states. For large-scale applications, we test our model and algorithm using the Beijing subway network, herein demonstrate the benefits of the proposed methodology and potentials for data-driven decision making in urban transit management centers. It should be remarked that, there may exist several solutions of the system internal states in which all the observations can be matched. Specifically, different passenger assignment results can lead to the same aggregated measurements (densities at platforms). As a result, it will be our further research direction to answer the questions that how to measure the system observability when multi-source and heterogeneous data sources are available. Several important aspects in the proposed passenger flow estimation model need to be further addressed in our future work. As we aim to estimate the passenger flow state over an urban rail transit network from the mesoscopic perspective, a stationary fundamental diagram is adopted as an approximation method to handing the passenger flow dynamics. The flow-density curve should depend on the specific geometric design and varies as a function of time of day, especially for the incident conditions. From a standard Kalman filtering perspective (Zhou and Mahmassani, 2007; Zhou and List, 2010), the passenger flow-density dynamic evolution processes under different conditions and corresponding time-dependent characteristics should be further considered. Finally, the time dependent arrival and departure curves are very useful tools to analyze the local passenger flow state (arrival rate, departure rate, loading passengers of a train, waiting queue, and delay) in a single station or for a specific OD pair in an urban rail transit line from a microscopic point of view (Niu and Zhou, 2013; Niu et al., 2015). Therefore, how to apply the queue theory and the cumulative arrival and departure curves in our passenger flow estimation problem in large scale and complex network is another important research direction in the future. Acknowledgements This research project, especially the large-scale Beijing Subway network and smart card data set, has been supported through Beijing Key Laboratory of Urban Traffic Operation Simulation and Decision Support and Beijing International Science and Technology Cooperation Base of Urban Transport. The first author would like to thank the support from the China Scholarship Council and the Innovative Practice Program for Graduate Students of Tsinghua University \u2013 China. The last author is partially funded by National Science Foundation\u2013United States under NSF Grant No. CMMI 1538105 \u201cCollaborative Research: Improving Spatial Observability of Dynamic Traffic Systems through Active Mobile Sensor Networks and Crowdsourced Data\u201d and NSF Grant No. CMMI 1663657. \u201cReal-time Management of Large Fleets of Self-Driving Vehicles Using Virtual Cyber Tracks\u201d. The authors thank Dr. Bo Wang from the Beijing Transportation Information Center, for sharing the information about the passenger route choice survey in the Beijing subway network. Appendix A Algorithms to solve the sub-problems Algorithms A1 \u2212 A3 . Appendix B Basic input for the simple example Tables B1 and B2 . Appendix C Basic input for the medium-scale example Tables C1 \u2212C3 . Appendix D Comparison between the proposed state estimation model and the schedule-based passenger assignment model We propose a schedule-based passenger assignment model based on the space-time network representation (Liu and Zhou, 2016) in the follows as a benchmark with its notations shown in Table D1 . The model can be easily solved by the network loading algorithm with priority rules (Binder et al., 2017). Then, we make a specific comparison between our proposed state estimation model and the schedule-based passenger assignment model listed in Table D2 . Scheduled-based passenger assignment model. Objective function: (D-1) min Z = \u2211 a \u2211 ( i , j , t , t \u2032 ) \u2208 E s t [ c ( i , j , t , t \u2032 ) \u00d7 x a ( i , j , t , t \u2032 ) ] Subject to: Passenger flow balance constraint: (D-2) \u2211 j , t \u2032 : ( i , j , t , t \u2032 ) \u2208 E s t x a ( i , j , t , t \u2032 ) \u2212 \u2211 j , t \u2032 : ( j , i , t \u2032 , t ) \u2208 E s t x a ( j , i , t \u2032 , t ) = { 1 \u2212 1 0 i = o a , t = D T a i = d a , t = T o t h e r w i s e \u2200 a \u2208 A Capacity constraint: (D-3) \u2211 a x a ( i , j , t , t \u2032 ) \u2264 C a p ( i , j , t , t \u2032 ) \u2200 ( i , j , t , t \u2032 ) \u2208 E s t Binary variable definition: (D-4) x a ( i , j , t , t \u2032 ) \u2208 { 0 , 1 } In the schedule-based passenger assignment model, passengers are loading into the network from their origins at departure times, considering passenger path choice, schedule, and train capacity, to estimate the specific passenger space-time trajectories and arrival times at their destinations with minimum total system cost. In our proposed framework, the destinations and corresponding arrival times are directly mapped in the STS network as boundary conditions to reconstruct the space-time trajectories for passengers, which makes the proposed model can estimate the space-time trajectories for passengers in a closed solution space as shown in Fig. 22. If more intermediate identification space-time samples during a trip from the Smart Phone, Bluetooth, and Wi-Fi are available, the proposed state estimation framework can be easily extended into model level 3 as shown in Fig. 22, which can estimate the space-time trajectories for passengers in a tight solution space. In an urban rail transit network, there are several fixed sensors at platforms, in trains, and in transfer corridors, which can offer rich information about the aggregated passenger counts at key locations (Eulerian observations). The Eulerian observations are usually not utilized in the passenger assignment model, which can help increase the estimation accuracy. As shown in Fig. 16, the estimation accuracy can be improved with more available Eulerian observations. Therefore, integrating Lagrangian and Eulerian observations into a unified state estimation framework is another forward step of this study than traditional passenger assignment model. Further, we implement a network loading algorithm according to the study by Binder et al. (2017). The data set in Section 6.2 is used as the input for the schedule-based passenger assignment model. The density-MAE obtained from solving the above schedule-based passenger assignment model is 1.80, which is larger than that in all test scenarios in Sections 6.2.3 and 6.2.5. The specific input data set and output results of the schedule-based passenger assignment model are available at the website: https://www.researchgate.net/publication/328917711_Schedule-based_passenger_assignment. References Auffrey et al., 2017 C. Auffrey Fu X. Wang X. A.W. McClearnon Enhancing Beijing's resilience by improving Tongzhou's access to high-speed rail transportation Urban Rail Transit 3 1 2017 23 33 Bao, 2018 X. Bao Urban rail transit present situation and future development trends in China: overall analysis based on national policies and strategic plans in 2016\u20132020 Urban Rail Transit 4 1 2018 1 12 Binder et al., 2017 S. Binder Y. Maknoon M. Bierlaire Exogenous priority rules for the capacitated passenger assignment problem Transp. Res. Part B: Methodol. 105 2017 19 42 Canca et al., 2018 D. Canca J.L. Andrade-Pineda A. De los Santos M. Calle The Railway Rapid Transit frequency setting problem with speed-dependent operation costs Transp. Res. Part B: Methodol. 117 2018 494 519 Canca et al., 2016 D. Canca E. Barrena A. De-Los-Santos J.L. Andrade-Pineda Setting lines frequency and capacity in dense railway rapid transit networks with simultaneous passenger assignment Transp. Res. Part B: Methodol. 93 2016 251 267 Canca et al., 2017 D. Canca A. De-Los-Santos G. Laporte J.A. Mesa An adaptive neighborhood search metaheuristic for the integrated railway rapid transit network design and line planning problem Comput. Oper. Res. 78 2017 1 14 Carrel et al., 2015 A. Carrel Lau P.S. R.G. Mishalani R. Sengupta J.L. Walker Quantifying transit travel experiences from the users\u2019 perspective with high-resolution smartphone and vehicle location data: Methodologies, validation, and example analyses Transp. Res. Part C: Emerg. Technol. 58 2015 224 239 Cepeda et al., 2006 M. Cepeda R. Cominetti M. Florian A frequency-based assignment model for congested transit networks with strict capacity constraints: characterization and computation of equilibria Transp. Res. Part B: Methodol. 40 6 2006 437 459 China-Daily 2018a China-Daily http://africa.chinadaily.com.cn/a/201804/28/WS5ae42ec5a3105cdcf651b2f5.html 2018 China-Daily 2018b China-Daily More than half billion Chinese pay by mobile phones: report http://usa.chinadaily.com.cn/a/201807/19/WS5b506b16a310796df4df7817.html 2018 Cominetti and Correa, 2001 R. Cominetti J. Correa Common-lines and passenger assignment in congested transit networks Transp. Sci. 35 3 2001 250 267 Daganzo, 1997 C. Daganzo Fundamentals of Transportation and Traffic Operations 1997 Pergamon Oxford Fu et al., 2012 Fu Q. Liu R. S. Hess A review on transit assignment modelling approaches to congested networks: a new perspective Proc. Soc. Behav. Sci. 54 2012 1145 1155 Gao et al., 2014 Gao Z. Qu Y. Li X. Long J. Huang H.-J. Simulating the dynamic escape process in large public places Oper. Res. 62 6 2014 1344 1357 Guo et al., 2011 Guo R.-Y. Huang H.-J. Wong S. Collection, spillback, and dissipation in pedestrian evacuation: a network-based method Transp. Res. Part B: Methodol. 45 3 2011 490 506 H\u00e4nseler et al., 2014 F.S. H\u00e4nseler M. Bierlaire B. Farooq T. M\u00fchlematter A macroscopic loading model for time-varying pedestrian flows in public walking areas Transp. Res. Part B: Methodol. 69 2014 60 80 H\u00e4nseler et al., 2017 F.S. H\u00e4nseler Lam W.H. M. Bierlaire G. Lederrey M. Nikoli\u0107 A dynamic network loading model for anisotropic and congested pedestrian flows Transp. Res. Part B: Methodol. 95 2017 149 168 Hamdouch and Lawphongpanich, 2008 Y. Hamdouch S. Lawphongpanich Schedule-based transit assignment model with travel strategies and capacity constraints Transp. Res. Part B: Methodol. 42 7-8 2008 663 684 Hamdouch et al., 2014 Y. Hamdouch W. Szeto Jiang Y. A new schedule-based transit assignment model with travel strategies and supply uncertainties Transp. Res. Part B: Methodol. 67 2014 35 67 Hoogendoorn et al., 2017 S.P. Hoogendoorn W. Daamen V.L. Knoop J. Steenbakkers M. Sarvi Macroscopic fundamental diagram for pedestrian networks: theory and applications Transp. Res. Proc. 23 2017 480 496 Ji et al., 2016 Ji X. Zhang J. Hu Y. Ran B. Pedestrian movement analysis in transfer station corridor: Velocity-based and acceleration-based Physica A 450 2016 416 434 Ji et al., 2013 Ji X. Zhou X. Ran B. A cell-based study on pedestrian acceleration and overtaking in a transfer station corridor Physica A 392 8 2013 1828 1839 Kroon et al., 2014 L. Kroon G. Mar\u00f3ti L. Nielsen Rescheduling of railway rolling stock with dynamic passenger flows Transp. Sci. 49 2 2014 165 184 Li et al., 2017 Li S. M.M. Dessouky Yang L. Gao Z. Joint optimal train regulation and passenger flow control strategy for high-frequency metro lines Transp. Res. Part B: Methodol. 99 2017 113 137 Li et al., 2018 Li S. Zhou X. Yang L. Gao Z. Automatic train regulation of complex metro networks with transfer coordination constraints: A distributed optimal control framework Transp. Res. Part B: Methodol. 117 2018 228 253 Liu and Zhou, 2016 Liu J. Zhou X. Capacitated transit service network design with boundedly rational agents Transp. Res. Part B: Methodol. 93 2016 225 250 Liu et al., 2010 Liu Y. J. Bunker L. Ferreira Transit Users\u2019 Route\u2010Choice Modelling in Transit Assignment: A Review Transp. Rev. 30 6 2010 753 769 Lu et al., 2018 Lu K. Han B. Zhou X. Smart urban transit systems: from integrated framework to interdisciplinary perspective Urban Rail Transit 2018 1 19 Ma et al., 2012 Ma X.-l. Wang Y.-h. Chen F. Liu J.-f. Transit smart card data mining for passenger origin information extraction J. Zhejiang Univ. Sci. C 13 10 2012 750 760 Ma et al., 2013 Ma X. Wu Y.-J. Wang Y. Chen F. Liu J. Mining smart card data for transit riders\u2019 travel patterns Transp. Res. Part C: Emerg. Technol. 36 2013 1 12 Moskowitz and Newman, 1963 K. Moskowitz L. Newman Notes on freeway capacity Highw. Res. Record 27 1963 Mu\u00f1oz et al., 2003 L. Mu\u00f1oz X. Sun R. Horowitz L. Alvarez Traffic density estimation with the cell transmission model Proceedings of the 2003 American Control Conference 2003 2003 IEEE 3750 3755 Newell, 1993 G.F. Newell A simplified theory of kinematic waves in highway traffic, part I: General theory Transp. Res. Part B: Methodol. 27 4 1993 281 287 Nguyen and Pallottino, 1988 S. Nguyen S. Pallottino Equilibrium traffic assignment for large scale transit networks Eur. J. Oper. Res. 37 2 1988 176 186 Nguyen et al., 2001 S. Nguyen S. Pallottino F. Malucelli A modeling framework for passenger assignment on a transport network with timetables Transp. Sci. 35 3 2001 238 249 Niu and Zhou, 2013 Niu H. Zhou X. Optimizing urban rail timetable under time-dependent demand and oversaturated conditions Transp. Res. Part C: Emerg. Technol. 36 2013 212 230 Niu et al., 2015 Niu H. Zhou X. Gao R. Train scheduling for minimizing passenger waiting time with time-dependent demand and skip-stop patterns: nonlinear integer programming models with linear constraints Transp. Res. Part B: Methodol. 76 2015 117 135 Nuzzolo et al., 2012 A. Nuzzolo U. Crisalli L. Rosati A schedule-based assignment model with explicit capacity constraints for congested transit networks Transp. Res. Part C: Emer. Technol. 20 1 2012 16 33 Pelletier et al., 2011 M.-P. Pelletier M. Tr\u00e9panier C. Morency Smart card data use in public transit: a literature review Transp. Res. Part C: Emerg. Technol. 19 4 2011 557 568 Poon et al., 2004 Poon M. Wong S. Tong C. A dynamic schedule-based model for congested transit networks Transp. Res. Part B: Methodol. 38 4 2004 343 368 Seyfried et al., 2009 A. Seyfried O. Passon B. Steffen M. Boltes T. Rupprecht W. Klingsch New insights into pedestrian flow through bottlenecks Transp. Sci. 43 3 2009 395 406 Shang et al., 2018 Shang P. Li R. Liu Z. Yang L. Wang Y. Equity-oriented skip-stopping schedule optimization in an oversaturated urban rail transit network Transp. Res. Part C: Emerg. Technol. 89 2018 321 343 Shi et al., 2018 Shi J. Yang L. Yang J. Gao Z. Service-oriented train timetabling with collaborative passenger flow control on an oversaturated metro line: an integer linear optimization approach Transp. Res. Part B: Methodol. 110 2018 26 59 Spiess and Florian, 1989 H. Spiess M. Florian Optimal strategies: a new assignment model for transit networks Transp. Res. Part B: Methodol. 23 2 1989 83 102 Steffen and Seyfried, 2010 B. Steffen A. Seyfried Methods for measuring pedestrian density, flow, speed and direction with minimal scatter Physica A 389 9 2010 1902 1910 Teng and Liu, 2015 Teng J. Liu W.-R. Development of a behavior-based passenger flow assignment model for urban rail transit in section interruption circumstance Urban Rail Transit 1 1 2015 35 46 van den Heuvel et al., 2015 J. van den Heuvel A. Voskamp W. Daamen S.P. Hoogendoorn Using Bluetooth to estimate the impact of congestion on pedestrian route choice at train stations Traffic and Granular Flow'13 2015 Springer 73 82 Wang and Papageorgiou, 2005 Wang Y. M. Papageorgiou Real-time freeway traffic state estimation based on extended Kalman filter: a general approach Transp. Res. Part B: Methodol. 39 2 2005 141 167 Work et al., 2010 D.B. Work S. Blandin O.-P. Tossavainen B. Piccoli A.M. Bayen A traffic model for velocity data assimilation Appl. Math. Res. Express 2010 1 2010 1 35 Wu et al., 2015 Wu J. Liu M. Sun H. Li T. Gao Z. Wang D.Z.W. Equity-based timetable synchronization optimization in urban subway network Transp. Res. Part C: Emerg. Technol. 51 2015 1 18 Wu et al., 1994 Wu J.H. M. Florian P. Marcotte Transit equilibrium assignment: a model and solution algorithms Transp. Sci. 28 3 1994 193 203 Yang and Zhou, 2017 Yang L. Zhou X. Optimizing on-time arrival probability and percentile travel time for elementary path finding in time-dependent transportation networks: Linear mixed integer programming reformulations Transp. Res. Part B: Methodol. 96 2017 68 91 Yang et al., 2002 Yang M.-H. D.J. Kriegman N. Ahuja Detecting faces in images: a survey IEEE Trans. Pattern Anal. Mach. Intell. 24 1 2002 34 58 Yin et al., 2016 Yin J. Tang T. Yang L. Gao Z. Ran B. Energy-efficient metro train rescheduling with uncertain time-variant passenger demands: an approximate dynamic programming approach Transp. Res. Part B: Methodol. 91 2016 178 210 Yin et al., 2017 Yin J. Yang L. Tang T. Gao Z. Ran B. Dynamic passenger demand oriented metro train scheduling with energy-efficiency and waiting time minimization: mixed-integer linear programming approaches Transp. Res. Part B: Methodol. 97 2017 182 213 Zeng and Li, 2018 Zeng Z. Li T. Analyzing congestion propagation on urban rail transit oversaturated conditions: a framework based on SIR Epidemic Model Urban Rail Transit 4 3 2018 130 140 Zhang et al., 2013 Zhang J. W. Mehner E. Andresen S. Holl M. Boltes A. Schadschneider A. Seyfried Comparative analysis of pedestrian, bicycle and car traffic moving in circuits Proc. Soc. Behav. Sci. 104 2013 1130 1138 Zhang et al., 2014 Zhang J. W. Mehner S. Holl M. Boltes E. Andresen A. Schadschneider A. Seyfried Universal flow-density relation of single-file bicycle, pedestrian and car motion Phys. Lett. A 378 44 2014 3274 3277 Zhao and Zhang, 2017 Zhao Y. Zhang H.M. A unified follow-the-leader model for vehicle, bicycle and pedestrian traffic Transp. Res. Part B: Methodol. 105 2017 315 327 Zhong et al., 2015 Zhong C. E. Manley S.M. Arisona M. Batty G. Schmitt Measuring variability of mobility patterns from multiday smart-card data J. Comput. Sci. 9 2015 125 130 Zhou et al., 2018 Zhou J. Li Y. Yang Y. Familiar strangers: visualising potential metro encounters in Beijing Environ. Plan. A: Econ. Space 50 2 2018 262 265 Zhou et al., 2017a Zhou J. N. Sipe Ma Z. D. Mateo-Babiano S. Darchen Monitoring transit-served areas with smartcard data: a Brisbane case study J. Transp. Geogr. 2017 In Press Zhou et al., 2017b Zhou L. Tong L.C. Chen J. Tang J. Zhou X. Joint optimization of high-speed train timetables and speed profiles: A unified modeling approach using space-time-speed grid networks Transp. Res. Part B: Methodol. 97 2017 157 181 Zhou and List, 2010 Zhou X. G.F. List An information-theoretic sensor location model for traffic origin-destination demand estimation applications Transp. Sci. 44 2 2010 254 273 Zhou and Mahmassani, 2007 X. Zhou H.S. Mahmassani A structural state space model for real-time traffic origin\u2013destination demand estimation and prediction in a day-to-day learning framework Transp. Res. Part B: Methodol. 41 8 2007 823 840 Zhu et al., 2017a Zhu Y. H.N. Koutsopoulos N.H. Wilson Inferring left behind passengers in congested metro systems from automated data Transp. Res. Part C: Emerg. Technol. 2017 Zhu et al., 2017b Zhu Y. H.N. Koutsopoulos N.H. Wilson A probabilistic passenger-to-train assignment model based on automated data Transp. Res. Part B: Methodol. 104 2017 522 542 Zhu et al., 2017c Zhu Y. Mao B. Bai Y. Chen S. A bi-level model for single-line rail timetable design with consideration of demand and capacity Transp. Res. Part C: Emerg. Technol. 85 2017 211 233"
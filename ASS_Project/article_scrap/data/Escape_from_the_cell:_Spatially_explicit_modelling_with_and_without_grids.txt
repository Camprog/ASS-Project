"Ecological ModellingEscape from the cell: Spatially explicit modelling with and without gridsAbstract This paper is concerned with the representation of individuals embedded in a two- (or three-) dimensional environment, and with the techniques that can be used to simulate the evolution of the spatial patterns both of the populations of those individuals and of their environment. Its scope is therefore that of individual based or agent based modelling, of a general type, including herbivore populations, predator-prey models or any other type that is concerned with the spatial patterning evolving from recruitment, interaction and/or movement of discrete individuals. The aim is to discuss a modelling technique that allows more flexibility in the representation of the positions of individuals than is typically the case for cellular automata (CA), but which also deals efficiently with the problem of searching for neighbours when individual positions can vary nearly continuously. A scaling problem is discussed that arises when the range over which individuals interact is much smaller than the size of the domain. It is argued that validation of CA models involving discrete individuals is made more difficult when the system scale exceeds the size of individuals by a large factor. However, even when the domain size is small, if interaction between individuals is mediated by their size, imposition of a fixed grid upon the dynamics may cause important phenomena to be misrepresented or missed altogether. We suggest that cellular automata, as usually formulated, do not deal adequately with this type of problem, and introduce a particle-in-cell (PIC) method to deal with it in intermediate cases. Alternative data structures are discussed for dealing with more extreme cases, including the possibility of modelling an indefinitely large domain using a changing set of cells (PIC:SI).serial JL 271743 291210 291728 291780 291840 31 Ecological Modelling ECOLOGICALMODELLING 2006-09-20 2006-09-20 2010-10-08T02:45:02 1-s2.0-S0304380006003425 S0304-3800(06)00342-5 S0304380006003425 10.1016/j.ecolmodel.2006.07.031 S300 S300.1 FULL-TEXT 1-s2.0-S0304380006X04295 2015-05-14T06:43:49.314216-04:00 0 0 20070110 2007 2006-09-20T00:00:00Z articleinfo crossmark dco dateupdated tomb dateloaded datesearch indexeddate issuelist volumelist yearnav articletitlenorm authfirstinitialnorm authfirstsurnamenorm cid cids contenttype copyright dateloadedtxt docsubtype doctype doi eid ewtransactionid hubeid issfirst issn issnnorm itemstage itemtransactionid itemweight openaccess openarchive pg pgfirst pglast pii piinorm pubdatestart pubdatetxt pubyr sectiontitle sortorder srctitle srctitlenorm srctype subheadings volfirst volissue webpdf webpdfpagecount figure body mmlmath affil appendices articletitle auth authfirstini authfull authkeywords authlast primabst ref alllist content subj ssids 0304-3800 03043800 200 200 1 2 1 2 Volume 200, Issues 1\u20132 6 59 78 59 78 20070110 10 January 2007 2007-01-10 2007 Research papers article fla Copyright \u00a9 2006 Elsevier B.V. All rights reserved. ESCAPECELLSPATIALLYEXPLICITMODELLINGWITHOUTGRIDS BITHELL M 1 Introduction 2 Difficulties with cellular modelling 3 Alternatives 3.1 Construction of PIC models 4 Simulations 4.1 Example one: diffusion and pattern locking in a crowded environment 4.2 Example two: population dynamics and resource gathering 4.3 Example 3 forest simulation 5 Conclusion Appendix A Java code for the PIC:SI method References BEREC 2002 55 81 L BIRDSALL 1991 C PLASMAPHYSICSVIACOMPUTERSIMULATION BOWYER 1981 162 166 A BLAKE 2001 178 186 S CHAVE 1999 233 254 J CONWAY 1970 120 123 J DEANGELIS 1992 67 87 D ININDIVIDUALBASEDMODELSAPPROACHESINECOLOGY INDIVIDUALBASEDAPPROACHMOSTAPPROPRIATEFORAGIVENPROBLEM DEUTSCHMAN 1997 1684 D DURRETT 1994 363 394 R EPSTEIN 1996 J GROWINGARTIFICIALSOCIETIESSOCIALSCIENCEBOTTOMUP FRISCH 1986 1505 1508 U GINOT 2002 23 41 V GRIMM 2005 V INDIVIDUALBASEDMODELINGECOLOGY HARLOW 1957 137 142 F HARLOW 1964 319 343 F HELBING 2001 361 383 D HOGEWEG 1988 81 100 P HOLT 1995 20 27 R JAMES 2004 107 113 R KEELING 1999 64 99 M ADVANCEDECOLOGICALTHEORYPRINCIPLESAPPLICATIONS SPATIALMODELSINTERACTINGPOPULATIONS KEELING 1997 1589 1601 M KNUTH 1998 D ARTCOMPUTERPROGRAMMING KREFT 2001 2897 2912 J KREFT 1998 3275 3287 J KOUMOUTSAKOS 2005 457 487 P MUNJIZA 2004 A COMBINEDFINITEDISCRETEELEMENTMETHOD VONNEUMANN 1966 J THEORYSELFREPRODUCINGAUTOMATA PACALA 1996 1 43 S PHIPPS 1992 165 187 M INDIVIDUALBASEDMODELSAPPROACHESINECOLOGY LOCALGLOBALLESSONCELLULARAUTOMATA PAUSAS 2003 365 374 J SAKODA 1971 119 132 J SCHELLING 1969 488 493 T SCHELLING 1971 143 186 T SCHWEITZER 2003 F BROWNIANAGENTSACTIVEPARTICLESCOLLECTIVEDYNAMICSINNATURALSOCIALSCIENCES SHEWCHUK 1997 305 363 J TIPPER 1990 155 160 J WATSON 1981 167 172 D WISSEL 2000 C INGEOMETRYECOLOGICALINTERACTIONSIMPLIFYINGSPATIALCOMPLEXITYCAMBRIDGESTUDIESADAPTIVEDYNAMICS1 GRIDBASEDMODELSTOOLSFORECOLOGICALRESEARCH WOLFRAM 2002 S BITHELLX2007X59 BITHELLX2007X59X78 BITHELLX2007X59XM BITHELLX2007X59X78XM item S0304-3800(06)00342-5 S0304380006003425 1-s2.0-S0304380006003425 10.1016/j.ecolmodel.2006.07.031 271743 2010-11-08T17:29:59.237798-05:00 2007-01-10 1-s2.0-S0304380006003425-main.pdf https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/MAIN/application/pdf/ff133a33d79a8a84fe2abe179d7c87ca/main.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/MAIN/application/pdf/ff133a33d79a8a84fe2abe179d7c87ca/main.pdf main.pdf pdf true 1945453 MAIN 20 1-s2.0-S0304380006003425-main_1.png https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/PREVIEW/image/png/799d541aa49c1f3faf2eb9aefe227f59/main_1.png https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/PREVIEW/image/png/799d541aa49c1f3faf2eb9aefe227f59/main_1.png main_1.png png 53349 849 656 IMAGE-WEB-PDF 1 1-s2.0-S0304380006003425-si3.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/STRIPIN/image/gif/e3dcec024818736d7b3f103833a9f990/si3.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/STRIPIN/image/gif/e3dcec024818736d7b3f103833a9f990/si3.gif si3 si3.gif gif 976 20 230 ALTIMG 1-s2.0-S0304380006003425-si2.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/STRIPIN/image/gif/a2e09ecd88292ad9eff7236d199d8021/si2.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/STRIPIN/image/gif/a2e09ecd88292ad9eff7236d199d8021/si2.gif si2 si2.gif gif 713 18 173 ALTIMG 1-s2.0-S0304380006003425-si1.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/STRIPIN/image/gif/643701e641fc530c6c6feae25ef4f4ca/si1.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/STRIPIN/image/gif/643701e641fc530c6c6feae25ef4f4ca/si1.gif si1 si1.gif gif 159 14 17 ALTIMG 1-s2.0-S0304380006003425-fx6d.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6d/DOWNSAMPLED/image/gif/1d616c937fd282e6db5cdf4694ada867/fx6d.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6d/DOWNSAMPLED/image/gif/1d616c937fd282e6db5cdf4694ada867/fx6d.gif fx6d fx6d.gif gif 49938 1022 561 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx6d.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6d/THUMBNAIL/image/gif/4382b24819f232c35fdd8bf161c65392/fx6d.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6d/THUMBNAIL/image/gif/4382b24819f232c35fdd8bf161c65392/fx6d.sml fx6d fx6d.sml sml 797 93 51 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr6.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr6/DOWNSAMPLED/image/jpeg/aaf52e56c1f292355979420e1be0e0f4/gr6.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr6/DOWNSAMPLED/image/jpeg/aaf52e56c1f292355979420e1be0e0f4/gr6.jpg gr6 gr6.jpg jpg 15784 261 368 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr6.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr6/THUMBNAIL/image/gif/6adbd7a90255434db09fb1e63bd069d8/gr6.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr6/THUMBNAIL/image/gif/6adbd7a90255434db09fb1e63bd069d8/gr6.sml gr6 gr6.sml sml 1507 89 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr8.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr8/DOWNSAMPLED/image/jpeg/0748b6d45b206a25e37c4bc028974792/gr8.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr8/DOWNSAMPLED/image/jpeg/0748b6d45b206a25e37c4bc028974792/gr8.jpg gr8 gr8.jpg jpg 13367 255 356 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr8.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr8/THUMBNAIL/image/gif/c1c4bcddb2c287f0afc402144d0c1d45/gr8.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr8/THUMBNAIL/image/gif/c1c4bcddb2c287f0afc402144d0c1d45/gr8.sml gr8 gr8.sml sml 1214 89 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr3.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr3/DOWNSAMPLED/image/jpeg/044bd8a060764f33b5676a13a51ca81a/gr3.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr3/DOWNSAMPLED/image/jpeg/044bd8a060764f33b5676a13a51ca81a/gr3.jpg gr3 gr3.jpg jpg 18032 258 366 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr3.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr3/THUMBNAIL/image/gif/46bd00fe44c501fd18e89a6f3884b400/gr3.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr3/THUMBNAIL/image/gif/46bd00fe44c501fd18e89a6f3884b400/gr3.sml gr3 gr3.sml sml 1471 88 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr4.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr4/DOWNSAMPLED/image/jpeg/4b328c87e4ea2273ec63944107c9964b/gr4.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr4/DOWNSAMPLED/image/jpeg/4b328c87e4ea2273ec63944107c9964b/gr4.jpg gr4 gr4.jpg jpg 116551 333 333 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr4.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr4/THUMBNAIL/image/gif/55a2333ed45d1d35e394c916e00893fe/gr4.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr4/THUMBNAIL/image/gif/55a2333ed45d1d35e394c916e00893fe/gr4.sml gr4 gr4.sml sml 5681 93 93 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-fx1.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx1/DOWNSAMPLED/image/gif/2c8f47974d7ede6d0d27ecc2b37c593c/fx1.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx1/DOWNSAMPLED/image/gif/2c8f47974d7ede6d0d27ecc2b37c593c/fx1.gif fx1 fx1.gif gif 3367 232 205 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx1.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx1/THUMBNAIL/image/gif/afd489f87917562265bd07f55079788e/fx1.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx1/THUMBNAIL/image/gif/afd489f87917562265bd07f55079788e/fx1.sml fx1 fx1.sml sml 949 93 82 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-fx2.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx2/DOWNSAMPLED/image/gif/5376c6f3e0a95af8ba2b9c68ac9ccce9/fx2.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx2/DOWNSAMPLED/image/gif/5376c6f3e0a95af8ba2b9c68ac9ccce9/fx2.gif fx2 fx2.gif gif 5002 320 314 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx2.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx2/THUMBNAIL/image/gif/2e0458d485d53a7e87efdb5146182b1e/fx2.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx2/THUMBNAIL/image/gif/2e0458d485d53a7e87efdb5146182b1e/fx2.sml fx2 fx2.sml sml 844 93 91 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr13.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr13/DOWNSAMPLED/image/jpeg/27ca10050d737c1f525017cd52825b9d/gr13.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr13/DOWNSAMPLED/image/jpeg/27ca10050d737c1f525017cd52825b9d/gr13.jpg gr13 gr13.jpg jpg 77038 558 362 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr13.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr13/THUMBNAIL/image/gif/fdcd454ed18186bd5652ebf9c2801854/gr13.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr13/THUMBNAIL/image/gif/fdcd454ed18186bd5652ebf9c2801854/gr13.sml gr13 gr13.sml sml 2590 93 60 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-fx3.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx3/DOWNSAMPLED/image/gif/24a67c7ac9b425fa559e24d460b26378/fx3.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx3/DOWNSAMPLED/image/gif/24a67c7ac9b425fa559e24d460b26378/fx3.gif fx3 fx3.gif gif 5044 277 297 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx3.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx3/THUMBNAIL/image/gif/91bf224bbfa72f6fa3a7ac6e1f1132b1/fx3.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx3/THUMBNAIL/image/gif/91bf224bbfa72f6fa3a7ac6e1f1132b1/fx3.sml fx3 fx3.sml sml 1054 93 100 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-fx4.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx4/DOWNSAMPLED/image/gif/674187ce9f4360704f3d1e9a5250bfa1/fx4.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx4/DOWNSAMPLED/image/gif/674187ce9f4360704f3d1e9a5250bfa1/fx4.gif fx4 fx4.gif gif 8937 345 376 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx4.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx4/THUMBNAIL/image/gif/a1cf8e56d11d44d9c21acb0f30338be5/fx4.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx4/THUMBNAIL/image/gif/a1cf8e56d11d44d9c21acb0f30338be5/fx4.sml fx4 fx4.sml sml 1057 93 102 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-fx5.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx5/DOWNSAMPLED/image/gif/c5ef1dcfb57c17df4cf50e04f95e20f2/fx5.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx5/DOWNSAMPLED/image/gif/c5ef1dcfb57c17df4cf50e04f95e20f2/fx5.gif fx5 fx5.gif gif 2318 102 237 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx5.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx5/THUMBNAIL/image/gif/8f912a3f58cee0e37fb164f2fd7ef70f/fx5.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx5/THUMBNAIL/image/gif/8f912a3f58cee0e37fb164f2fd7ef70f/fx5.sml fx5 fx5.sml sml 1002 54 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-fx6b.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6b/DOWNSAMPLED/image/gif/2b455fb31639ced3b4396e68f99e6e18/fx6b.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6b/DOWNSAMPLED/image/gif/2b455fb31639ced3b4396e68f99e6e18/fx6b.gif fx6b fx6b.gif gif 55254 1021 543 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx6b.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6b/THUMBNAIL/image/gif/c7e113cc8a496ef5359c71f7715f3ee6/fx6b.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6b/THUMBNAIL/image/gif/c7e113cc8a496ef5359c71f7715f3ee6/fx6b.sml fx6b fx6b.sml sml 813 92 49 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr2.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr2/DOWNSAMPLED/image/jpeg/db28f9863976c9d63864a1b856ac0ee0/gr2.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr2/DOWNSAMPLED/image/jpeg/db28f9863976c9d63864a1b856ac0ee0/gr2.jpg gr2 gr2.jpg jpg 23912 450 284 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr2.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr2/THUMBNAIL/image/gif/4afdbd7e5d88cf3177d1e0a04c0123d8/gr2.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr2/THUMBNAIL/image/gif/4afdbd7e5d88cf3177d1e0a04c0123d8/gr2.sml gr2 gr2.sml sml 1708 93 59 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr5.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr5/DOWNSAMPLED/image/jpeg/fe6a1456320bbf9edb9a608d390a025d/gr5.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr5/DOWNSAMPLED/image/jpeg/fe6a1456320bbf9edb9a608d390a025d/gr5.jpg gr5 gr5.jpg jpg 15159 255 342 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr5.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr5/THUMBNAIL/image/gif/26425e45eabab89589617884986500f1/gr5.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr5/THUMBNAIL/image/gif/26425e45eabab89589617884986500f1/gr5.sml gr5 gr5.sml sml 1312 93 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr10.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr10/DOWNSAMPLED/image/jpeg/a1ab6754d584721505dc1e2b95c03ace/gr10.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr10/DOWNSAMPLED/image/jpeg/a1ab6754d584721505dc1e2b95c03ace/gr10.jpg gr10 gr10.jpg jpg 61035 476 365 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr10.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr10/THUMBNAIL/image/gif/f7336769e177c39b79b3366297b2fd64/gr10.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr10/THUMBNAIL/image/gif/f7336769e177c39b79b3366297b2fd64/gr10.sml gr10 gr10.sml sml 2240 93 71 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr7.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr7/DOWNSAMPLED/image/jpeg/5391f230172047cf216c2d8d4dcaf107/gr7.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr7/DOWNSAMPLED/image/jpeg/5391f230172047cf216c2d8d4dcaf107/gr7.jpg gr7 gr7.jpg jpg 15695 254 356 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr7.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr7/THUMBNAIL/image/gif/bc9cee313539e55faf73199be148a759/gr7.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr7/THUMBNAIL/image/gif/bc9cee313539e55faf73199be148a759/gr7.sml gr7 gr7.sml sml 1302 89 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-fx6c.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6c/DOWNSAMPLED/image/gif/79ef491135c0691998a2225847b4896f/fx6c.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6c/DOWNSAMPLED/image/gif/79ef491135c0691998a2225847b4896f/fx6c.gif fx6c fx6c.gif gif 64306 1019 479 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx6c.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6c/THUMBNAIL/image/gif/0186446b84f3cb646f9c5ec0f53bbe21/fx6c.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6c/THUMBNAIL/image/gif/0186446b84f3cb646f9c5ec0f53bbe21/fx6c.sml fx6c fx6c.sml sml 899 94 44 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr1.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr1/DOWNSAMPLED/image/jpeg/0382999a02a6b3d9db4d74bcba8b3ffa/gr1.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr1/DOWNSAMPLED/image/jpeg/0382999a02a6b3d9db4d74bcba8b3ffa/gr1.jpg gr1 gr1.jpg jpg 32933 367 357 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr1.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr1/THUMBNAIL/image/gif/993af5c48784f64f260be4badf3277a0/gr1.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr1/THUMBNAIL/image/gif/993af5c48784f64f260be4badf3277a0/gr1.sml gr1 gr1.sml sml 2289 94 91 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr12.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr12/DOWNSAMPLED/image/gif/e0434b423d587276491cff40d6ce4857/gr12.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr12/DOWNSAMPLED/image/gif/e0434b423d587276491cff40d6ce4857/gr12.gif gr12 gr12.gif gif 25570 523 723 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr12.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr12/THUMBNAIL/image/gif/769e7d669c23e15afb2c24b026666953/gr12.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr12/THUMBNAIL/image/gif/769e7d669c23e15afb2c24b026666953/gr12.sml gr12 gr12.sml sml 1861 90 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr9.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr9/DOWNSAMPLED/image/jpeg/18cb6716c503593c95b77289c0324097/gr9.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr9/DOWNSAMPLED/image/jpeg/18cb6716c503593c95b77289c0324097/gr9.jpg gr9 gr9.jpg jpg 50715 525 376 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr9.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr9/THUMBNAIL/image/gif/d956542d2fa044fe0cb28d0d1fbe0316/gr9.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr9/THUMBNAIL/image/gif/d956542d2fa044fe0cb28d0d1fbe0316/gr9.sml gr9 gr9.sml sml 2001 94 67 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-fx6a.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6a/DOWNSAMPLED/image/gif/fd03a632a21ce3cb15153c511abf89fe/fx6a.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6a/DOWNSAMPLED/image/gif/fd03a632a21ce3cb15153c511abf89fe/fx6a.gif fx6a fx6a.gif gif 47681 1021 445 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx6a.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6a/THUMBNAIL/image/gif/d8dc67828a02afb0193c39c25e23ff0b/fx6a.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6a/THUMBNAIL/image/gif/d8dc67828a02afb0193c39c25e23ff0b/fx6a.sml fx6a fx6a.sml sml 738 92 40 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-fx6e.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6e/DOWNSAMPLED/image/gif/49364e96c2c1c9fed8015ddc060b7859/fx6e.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6e/DOWNSAMPLED/image/gif/49364e96c2c1c9fed8015ddc060b7859/fx6e.gif fx6e fx6e.gif gif 37974 957 361 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-fx6e.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/fx6e/THUMBNAIL/image/gif/7f75bb3873dadc798f738c22fcbdf94d/fx6e.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/fx6e/THUMBNAIL/image/gif/7f75bb3873dadc798f738c22fcbdf94d/fx6e.sml fx6e fx6e.sml sml 718 93 35 IMAGE-THUMBNAIL 1-s2.0-S0304380006003425-gr11.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr11/DOWNSAMPLED/image/jpeg/b6d8642a4849880685a70b48f0030369/gr11.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr11/DOWNSAMPLED/image/jpeg/b6d8642a4849880685a70b48f0030369/gr11.jpg gr11 gr11.jpg jpg 39866 514 358 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006003425-gr11.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006003425/gr11/THUMBNAIL/image/gif/670746cc9e0fc4306515292b408b416a/gr11.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006003425/gr11/THUMBNAIL/image/gif/670746cc9e0fc4306515292b408b416a/gr11.sml gr11 gr11.sml sml 1810 93 65 IMAGE-THUMBNAIL ECOMOD 4466 S0304-3800(06)00342-5 10.1016/j.ecolmodel.2006.07.031 Elsevier B.V. Fig. 1 Data structures for organizing irregularly distributed points in space. Top left: Delaunay triangulation, bottom left: quad-tree, top right: particle in cell (PIC) with irregular cell shapes, bottom right: particle in cell with sequential instantiation (PIC:SI) and rectangular cells \u2013 only those cells with the heavy border are kept in memory \u2013 dotted cells have been used but subsequently deleted. Others may be created when required, allowing for extension of the model domain. Fig. 2 Mean square values of possible step length (in the absence of collisions) for two cellular cases and the continuous case. Top: von Neumann neighbourhood\u2014the individual can remain stationary or jump to one of four positions distance away with equal probability. The mean square step length is thus 4a2/5. Middle: as for von Neumann but now including the corners distance 2 \u00af a away, leading to a mean square step length of ( 4 a 2 + 4 ( 2 a ) 2 ) / 9 = 4 a 2 / 3 . Bottom: Uniformly distributed movement over the square of side 2a, with mean square value equal to 2 / a 2 \u222b 0 a \u222b 0 x ( x 2 + y 2 ) d y d x = 2 a 2 / 3 . Fig. 3 Mean square distance diffused per step divided by mean square single step size (as given in Fig. 2) plotted against individual diameter/initial spacing. With this scaling all of the PIC curves starting from a regular grid with the fraction of voids as shown, lie on top of each other. Fig. 4 Size eight diameter individuals after 20 steps coloured with initial left (blue)\u2013right (pink) starting position. Particles initially are distributed on a uniform grid with 50% voids. Chains and clumps of particles are evident, restricting the possibilities of further movement. Fig. 5 Comparison of PIC and CA movement. On the vertical axis is a measure of the PIC diffusion rate (size/initial mean spacing) and on the horizontal axis a measure of the CA diffusion rate (the filling factor, or percentage of space occupied). Above the solid line, the diffusion rate of the PIC case is lower than the CA because of increased numbers of collisions when the individual size is large. Below the line, the greater freedom of movement of the PIC leads to more rapid overall movement. Fig. 6 Population growth rate as a function of timestep for size five diameter individuals at birthrate 0.0025, PIC case. The population mean stabilizes at approximately 42 individuals. Fig. 7 Mean equilibrium population as a function of birthrate for CA and PIC cases. In the PIC case the individuals are five units in diameter (i.e. one half the CA cell length). At low birthrates the PIC individuals make more collisions than the CA case (upper half of Fig. 5) and therefore have lower population, as they are lees able to reach resources owing to interference from other individuals. At higher birthrates, the greater availability of places for new individuals and the ability to move more freely allows the PIC population to grow to larger values than the CA case. Fig. 8 PIC case: scaling of mean population size with individual diameter at birth rate 0.0025. As the size on individuals decreases relative to the domain size the number of collisions falls and the room to give birth increases, leading to much larger populations at small sizes. Fig. 9 (a) Basal area per hectare as a function of time for the SORTIE model using the original PIC method. The total for all species is shown in black, and the breakdown by species type in colour as given by the key. (b) The corresponding numbers of stems per hectare, key as for (a). Note that although the basal area for less shade tolerant species such as Yellow Birch exceeds that of Beech and Hemlock at early times, this is not true for the number of stems. Fig. 10 (a) Total basal area as a function of time for the PIC method and a set of CA spacings (shown in metres). Convergence to the PIC method is only achieved for CA spacings below 1m. (b) Total number of stems per hectare, key as for (a). Note that the convergence of CA to PIC is slower here than for basal area. Fig. 11 (a) Basal area as a function of CA spacing at year 1800. No simple scaling of the area with CA spacing is evident. (b) Number of stems per hectare as a function of CA spacing at the same time, showing the best fit power-law scaling in this case. Fig. 12 (a) Fraction of trees per age range vs. age for the PIC case (solid line) and the CA case with 5m spacing (dot-dash line with stars). All plots in this figure are shown near the end of the run at year 1800. The PIC model trees tend to be younger, although both models have more young than old trees. (b) Number of stems per dbh per hectare vs. dbh. Symbols as for (a). The CA model has a distinct lack of small trees compared with PIC, and a dip in the number centred between 0.1 and 0.2m. Above 0.4m the two distributions are nearly identical. (c) Fraction of trees per age range in the size range 0.1\u20130.35mdbh, symbols as for Fig. 12a. In this size range the CA model contains significantly more young trees than the PIC case. (d) Basal area per hectare per dbh as a function of dbh. Small trees contribute very little to the total basal area, so that the CA and PIC distributions are very similar. The plot shows the larger total basal area for the CA case is generated by trees with dbh>0.75m. Fig. 13 (a) Distribution of basal area broken down by species at year 1800. (b) Distribution of stem number broken down by species at year 1800. CA spacings are denoted in metres (i.e. CA4 denotes the CA model with 4m spacing). Note that in both cases we plot species fraction rather then absolute number. The similarity between the two sets of distributions is evident (although note in particular differences at CA4) as is convergence to the PIC case. Escape from the cell: Spatially explicit modelling with and without grids M. Bithell a \u204e Mike.Bithell@geog.cam.ac.uk W.D. Macmillan b B.Macmillan@uea.ac.uk a Department of Geography, University of Cambridge, Downing Place, Cambridge CB2 3EN, United Kingdom b University of East Anglia, Norwich NR4 7TJ, United Kingdom \u204e Corresponding author. Tel.: +44 1223 333361; fax: +44 1223 333392. Abstract This paper is concerned with the representation of individuals embedded in a two- (or three-) dimensional environment, and with the techniques that can be used to simulate the evolution of the spatial patterns both of the populations of those individuals and of their environment. Its scope is therefore that of individual based or agent based modelling, of a general type, including herbivore populations, predator-prey models or any other type that is concerned with the spatial patterning evolving from recruitment, interaction and/or movement of discrete individuals. The aim is to discuss a modelling technique that allows more flexibility in the representation of the positions of individuals than is typically the case for cellular automata (CA), but which also deals efficiently with the problem of searching for neighbours when individual positions can vary nearly continuously. A scaling problem is discussed that arises when the range over which individuals interact is much smaller than the size of the domain. It is argued that validation of CA models involving discrete individuals is made more difficult when the system scale exceeds the size of individuals by a large factor. However, even when the domain size is small, if interaction between individuals is mediated by their size, imposition of a fixed grid upon the dynamics may cause important phenomena to be misrepresented or missed altogether. We suggest that cellular automata, as usually formulated, do not deal adequately with this type of problem, and introduce a particle-in-cell (PIC) method to deal with it in intermediate cases. Alternative data structures are discussed for dealing with more extreme cases, including the possibility of modelling an indefinitely large domain using a changing set of cells (PIC:SI). Keywords Cellular automata Computational techniques Individual based models Population dynamics 1 Introduction Since its inception in the second half of the 20th century (von Neumann, 1966; Sakoda, 1971; Conway, 1970; Schelling, 1969, 1971) the cellular automaton (CA) has proved to be a remarkably powerful method for simulating spatial patterns, so much so that considerable claims have been made about its ability as a modelling technique (Wolfram, 2002) and it has been suggested that CA have advantages for simulating spatial processes (Hogeweg, 1988, Hegselmann and Flache, 1998). Ginot et al. (2002) suggest that where the environment itself is represented as an individual (in their case as an agent in an agent based model) then it must be cellular. It is true that, since we are representing the world computationally, that we are limited in the accuracy with which we can subdivide space, unless we use expensive techniques that allow exact precision arithmetic (see e.g. Shewchuk, 1997). However, even for two byte integers, we are able to do this to one part in 65,536, which is adequate to discretise the motion of most animals to a small fraction of their physical size even in a relatively large domain, and therefore to treat our model domain as effectively continuous\u2014an assumption commonly made implicitly in much individual-based model (IBM) work. In typical CA, however, most of this potential accuracy is discarded in the name of simplicity\u2014in a domain of 100 by 100 or even 1000 by 1000 cells we do not use even the accuracy of two byte integers effectively. Not only is this unnecessarily restrictive (the modelling exercise is not that much more simple), but it introduces artifacts that are tied to the form of the grid (see below, but also Flache and Hegselmann, 2001) and restricts the scale on which models can operate. Furthermore, where more than one spatial scale is operating, for example, individual size and individual separation, the pure CA approach may not be appropriate (we discuss this in detail below, see De angelis and Rose, 1992 Figure 4.5 for an early example involving growth of sessile organisms). This is not to say that modelling in (effectively) continuous space is without its problems\u2014the principle one being that of search, and the associated scaling of the search process with number of individuals. If we wish to be able to identify the number of neighbours of a given animal as it moves across a landscape, we can give it a search radius within which it will identify neighbours for interaction (e. g. James et al., 2004). However, if each individual carries with it the knowledge of the locations of all other individuals for the purposes of this identification, then we have a process that scales as the square of individual numbers, and the problem rapidly becomes intractable once the number of individuals rises above a few thousands, even on modern machines. In this paper these two scaling problems, for CA, and for (almost) continuous space models, are addressed and an approach is introduced that unifies the best elements of the two modelling techniques. A number of different data structures are discussed that can be used to represent the movement of individuals across a landscape. A tile-based or particle-in-cell (PIC) approach is described for intermediate-scale modelling, that makes use of cells for organization of search when large numbers are involved, while retaining the flexibility and generality of the continuous approach. We are not aware of the PIC method being explicitly discussed elsewhere in the ecological literature, although we will consider one model below that seems to make use of it implicitly. Three examples are discussed to compare the PIC approach to that of CA. First it is shown how cellular modelling can lead to the missing of pattern locking in crowded environments, but is not sufficiently diffusive in low density cases without introducing large numbers of cells. The impact of this on population dynamics is then investigated in a simple consumer-resource model where crowding restricts the access to two spatially separated resource patches. We show that coarse-gridded cellular models do not have the same scaling behaviour with birthrate as PIC models with finite-sized individuals. It is argued that an approach that takes into account the physical size of individuals and their range of movement relative to the landscape they occupy is desirable, and that the finiteness of step length or discreteness of movement should be a property of the individuals themselves. Thirdly we investigate a forest model in which the individuals are fixed in space but change in size over time and are able to propagate by dispersion of seeds. The individuals compete for light and have restricted growth or may die if shaded severely by competitors. We examine a PIC model (namely the SORTIE model of Pacala et al., 1996) and show that a version where individuals are constrained to lie on a square grid creates a significantly different forest even when the grid spacing is sufficiently fine in principle to accommodate as many individuals as the original PIC version. Section 2 introduces some of the problems associated with modelling on a grid, and Section 3 discusses alternative data structures, and gives some details on programming the PIC method. Examples simulations are given in Section 4 and conclusion in Section 5. 2 Difficulties with cellular modelling For the purposes of the discussion below we regard a CA as a computational system in which: (a) There is a fixed neighbour geometry \u2013 cells and neighbourhoods are often regular in shape, but need not be (see e.g. Berec, 2002, Flache and Hegselmann, 2001) \u2013 the neighbour relationships are not determined by the dynamics of the system, but by the cell configuration. (b) The local spatial scales are determined by the cell size and the interaction neighbourhood, rather than being determined by the properties of the individuals being modelled (although one can make provision at least for the interaction range to depend on the individual, as we allow in the forest model below). (c) Typically numbers in each cell are prescribed, often a few or only one occupant being permitted. Where there is more than one occupant, there is no spatial information within the cell regarding their locations. Included in this, then, are those where there are individuals moving across a grid such as interacting particle systems (see e.g. Keeling, 1999; Durrett and Levin, 1994) and artificial ecologies (Keeling, 1999), as well as those where individuals are sessile but able to compete for resources. In the following we will largely be considering CA that use only a fixed rectangular grid with single occupancy. However, we do not anticipate that our conclusions would be altered significantly in the more general CA case, as the main point concerns the fixity of the CA neighbourhood, and its possible mismatch with the appropriate dynamical scales. Doubts about the utility of the CA approach for modelling real world systems of discrete individuals were expressed some time ago (Phipps, 1992) and the shortcomings of modelling individuals effectively by area pointed out (Hogeweg, 1988). Despite the apparent simplicity of the cellular paradigm, it has a number of disadvantages from a modelling point of view. First of all, it is very rare that the structures we encounter in the real world themselves lie on the sort of regular grid that is generally employed for cellular modelling. Although such a grid is not a requirement, Flache and Hegselmann (2001) show that the results of some kinds of simulation can vary when the grid pattern is changed. This is clearly undesirable when the grid is purely a device for organizing the model's spatial structure: we would like the results to be independent of our grid structures, except in cases where they reflect some spatial patterning that exists in the physical environment, and will affect individual behaviour\u2014habitat patches in a metapopulation model, for example, or field boundaries in the representation of farming systems. Wissel (2000), for example, describes a model in which a grid with 0.5m spacing is used explicitly to separate plants, in a model of a dwarf shrub community where there is typically a large amount of bare ground between shrubs (although this would seem to preclude modelling the dynamics that actually creates this spacing, however). Secondly, the very existence of a grid of cells defines a spatial scale. This has a number of consequences, depending on the way in which the cells and the individuals in the population are related to each other. Consider, for example, the case of a population of large herbivores roaming a landscape and consuming food that is more or less continuously distributed, but with varying density or quality from place to place. Suppose we choose to represent the food source on a grid, with the value in each cell being the quantity of food available at that location. What now are we to do with the herbivores? As a first idea, we might try putting a maximum of one herbivore in each cell: how large should the cells then be? In the case of a large herbivore such as, say, an elephant, a cell of a few metres across would be the minimum size. Since the animal in this case has a range of nearly a 100km, we would require something like 1010 cells of a few metres across to make model that could adequately describe the animal's full movement range over a period of a few weeks (see e.g. Blake et al., 2001). Even for a very large herd, most of these cells would be empty of animals for most of the time, and unless the spatial resolution is required to represent the gradients in the food source adequately, this is very wasteful of computational resources (and not easily achievable in any case with current technology). The alternative is to make the cells much larger \u2013 perhaps a kilometre across. Now we only need 10,000 cells \u2013 a comfortable number that we can easily handle. However, there is now a different problem \u2013 because of our single cell occupancy, the animals are constrained to be spaced with an average density of one per square kilometre \u2013 we have artificially placed an upper bound on the population density that the model can achieve. Clearly this will affect not only the breeding probability, but the impact on the food source and its recovery from herbivore damage. How do we get animals in their separate cells to meet for breeding purposes? Where will new individuals be placed (especially if all surrounding cells are occupied)? We have lost the density dependent effects that we need to be sure of getting a good population model. To recover the situation we need to allow our cells to contain more than one animal at a time. There are a number of ways we could achieve this. We could study only aggregated groups or herds of animals \u2013 but this loses us most of the point of making an individual based model \u2013 the possibility of studying the way in which the dynamics of interacting individuals gives rise to emergent structure is lost, along with any other dynamics within the group. In a slightly different context, aggregation of this type has a poor effect on the representation of species diversity in at least one individual-based forest model (the SORTIE model, see Holt et al., 1995). This problem (that of appropriate cell size in a given domain) is touched upon but not elaborated by Keeling (1999) and Berec (2002). Note that this is different from the problem imposed by the existence of a boundary at the edge of the domain, and the associated necessity for making the model domain large enough to capture the essentials of the dynamics, or the correlation scale at which interesting collective dynamics might be observed (Keeling, 1999; Keeling et al., 1997). Alternatively, we could assign probability distributions to the locations of individuals within a cell (and thus to the pattern of within-cell damage of vegetation), while allowing movement between cells to dependent on the proximity to the cell boundary and probability of moving beyond it. However, now we are dependent on probability distributions for which we do not have a-priori forms, and for which the evolution equations are not necessarily available. We could allow individuals to \u201cjump\u201d cells (as in Rand and Wilson, 1995 for example), so that their interactions are not limited to a single cell and its immediate neighbourhood, but can encompass several layers of cells around. This implies a violation of temporal scale (since the jump is instantaneous) that may not only introduce artificial structure into the model, but may lead to smearing of spatial patterns and inadequate estimates of the costs involved either in travelling or communicating with individuals at large spatial separation. The above problems, which relate both to the (coupled) temporal and spatial scale of the model and how this relates to the real temporal and spatial scales of the individuals under study, are not restricted to the above herbivore example, but apply to all cellular models that try to deal with discrete individuals whose position can vary to an arbitrarily small degree. It even applies to social simulation models such as the sugarscape (Epstein and Axtell, 1996; Ginot et al., 2002), where the grid is only large enough to fit a few thousand individuals into the whole landscape before it is completely filled. So we need a method that will cope with a large ratio between individual range of movement (which defines how much of the landscape can be sampled) and individual size (which defines the scale at which individual interactions take place). A third problem with cellular models is the inflexibility of representation of both the individuals and the environment. To begin with, cells restrict the possibility of interacting with other individuals. If we use a regular rectangular grid, then for single cell occupancy, any individual can meet directly with eight others at any time (if we allow interaction via the corner cells in addition to those at the side\u2014the so called \u201cMoore\u201d neighbourhood). This may be adequate in some situations, but could be too large a number (even in a confined space its quite hard to get nine humans directly in contact) or too small a number. We can vary the number of neighbours somewhat by changing the grid geometry, the obvious example being a hexagonal grid, but we rapidly run out of simple ways on which to do this, and in any case the maximum number of neighbours is a fixed property of the grid, where in reality it can vary depending on the ratio of individual sizes. Some of the effects of this can be seen in our discussion of forest modelling below. Matching structures with different spatial scale and pattern is also difficult. If there are several different types of structure in a landscape\u2014linear features such as rivers or extended ones such as mountains or gradients in soil type, possibly available at a range of resolutions, then in order to fit them to a fixed grid on which individuals move, we are forced to interpolate them in some way that may not fit the (possibly different) orientations of significant landscape structures. When positions of individuals can vary continuously this is less of a problem, as each feature can be separately sampled in a way appropriate to the accuracy and scale of each; we are not obliged to force the different datasets into a single spatial framework. 3 Alternatives The key point is that in the real world we have a relatively small number of individuals (maybe we need to deal with several hundreds of thousands, or a few millions) that can have arbitrary spatial locations. So, we need to allow for discrete spatial data that is potentially completely unstructured, and to discover within it patterns of neighbourhood relationships between the discrete individuals. Simply searching over all the members of a population has N 2 scaling, and while this might be good enough for a few individuals, when there are many thousands it becomes extremely inefficient and unusably slow. Four possibilities for solving this kind of problem are shown in Fig. 1 . First there is Delaunay triangulation, which is a well known method for finding nearest neighbours (Bowyer, 1981; Watson, 1981), at least for two dimensionally distributed objects. Each triangle has the property that no other point in the triangulations lies within that triangle's circumcircle. The triangulation is complete (in the sense that it tiles the whole space occupied by the points being triangulated) and optimal (in the sense that all the triangles have the largest possible minimum angle). Fast methods exist for constructing the triangulation (e.g. Tipper, 1990), but they scale at best as N log N (where N is the number of points), and the pattern is relatively complex to update. Furthermore, once the triangulation is constructed, a search is still required to find any neighbours beyond the immediate set of triangles. An additional problem is that the three-dimensional analogue (Delaunay tetrahedralization) is more difficult to construct, owing to the possibility of sliver tetrahedra that are almost two-dimensional. A second possibility is a quad-tree (or in 3D an oct-tree). Here an initial square is subdivided into four smaller squares whenever it contains more than a fixed number of individuals (possibly one, or perhaps more). Again construction is generally O (N log N). A tree search is required to find sets of neighbours. Both of these two structures are dynamic; they have to be re-constructed as individuals move (and are sometimes known for this reason as moving-mesh methods), but can cope with arbitrary variations in density in a numerically efficient way. Still more sophisticated dynamic data structures can be built that allow for overlapping and non-uniform-sized regions to be indexed and searched. An example is the R-tree method devised by Guttman (1984), which although efficient does not have an upper bound on the search time. Recent extensions by, for example Arge et al. (2004) place upper bounds on R-tree searches. The method has been used in ecological contexts by Hildenbrandt (2003); see Grimm and Railsback (2005). Although efficient, such tree data structures are complex to program. We will focus instead on a simple method that can be easily extended to make it dynamic, and which can be understood simply as an extension of CA modelling, namely tile-based or particle-in-cell (PIC) modelling. Here a fixed set of cells is used, but each cell can contain any number of individuals. PIC is not by any means a new method\u2014it seems to have been first employed in the late 1950s/early 1960s by Harlow (1957, 1964) for fluid modelling, and has since been expanded to cover a wide range of physical problems, particularly those in which discrete particles are present in a flow (e.g. Birdsall and Langdon, 1991) or in which the particles themselves determine the flow explicitly (e.g. Munjiza, 2004), and those for which \u201cmesh free\u201d simulation is necessary such as smooth particle hydrodynamics (Koumoutsakos, 2005). Note that although we might expect in principle that the results of CA would converge to those of PIC as the size of the cells in the CA grid become smaller, the way in which this happens may not be straightforward, as the scaling properties of the CA may be geometry and problem dependent (see the examples below). In any case it will not, in general, be possible to choose the correct grid scale a priori, but may require an expensive sensitivity study to find the appropriate size of CA grid for which the dynamics do not \u201cfeel\u201d the cell size. Searching for neighbours in the PIC method becomes a problem that scales as ck 2, where c is now the number of search cells and k the number of individuals in any one cell. So, if all the individuals can fit in a single cell, we are left with a method that again scales as the square of the population. However, in general, although the position of the individuals we want to study is in principle unrestricted, they will usually have a finite size. This imposes a real physical limit on the individual density, so that the number that can actually fit in a cell is bounded. If, for example, we have individuals that are roughly 1m in size, then a cell of 30m dimension will fit at most 1000 or so individuals when standing as close as possible. Although we will still need about 1,000,000 cells to cover a 30km square domain, it still is better by a factor 1000 than using single cell occupancy at a scale of one metre, and we can represent individual interactions correctly, at the expense of having to detect interactions (taking care to search across cell boundaries as appropriate). Furthermore, the results of the simulation do not depend on the grid scale or shape (cells need not be rectangular); they are determined directly by the properties of the individuals, which can be varied as appropriate to the individuals under study. The grid simply organizes the search process\u2014behaviour depends on interaction properties of individuals only. Although here we discuss only interactions that are size limited, the type and range of interaction can be variable depending on circumstance. The distance for interaction can even be larger than the PIC cell, or there can be several different scales of interaction if necessary. The interaction area can be any shape, and can move with the individual (as in James et al., 2004). These advantages are shared by the moving mesh methods. Provided the minimum size of individuals is fixed, and the cell areas are all nearly the same, the scaling is linear in population size. However, we still cannot cope with very large range/size ratios (e.g. 100,000:1\u2014a 1m animal in a 100km landscape), and for these either one of the above dynamic data structures would still be required, or else a refinement of the PIC method could be used, in which only those cells that are occupied are actually represented. This kind of system has already been used in particle simulation methods (see e.g. Munjiza, 2004). The idea is that we can save on memory and time by only keeping in memory those cells that are actually occupied\u2014cells are created in memory (in the terminology of object oriented programming, they are instantiated) only as individuals move into or are recruited within them. We denote this the particle-in-cell with sequential instantiation or PIC:SI method. We describe one way of achieving this in the next section. 3.1 Construction of PIC models In this section we provide some more detail on the construction of PIC models in order to illustrate the algorithmic differences entailed between PIC and CA for those that might be unfamiliar with the PIC technique. Because of the necessity to dynamically keep track of the set of individuals in each cell, PIC is slightly more complex to code than CA, but as we have indicated, and illustrate further below, this brings benefits in terms of the greater potential realism of the model results. The most basic requirement for coding PIC, then, is a dynamic list. Such lists are available in all modern programming languages (although the provision is generally somewhat richer in object oriented languages such as C++ or Java than in older languages such as FORTRAN). Facilities are generally provided to add and delete members from the list as required, and to loop over all members of the list performing some action on each. Given this we can straightforwardly extend a typical CA algorithm to make it PIC, with the single-cell occupancy typical of CA included as a special case. Consider the following pseudo-code that might form the basis of a general loop in a CA simulation Data (nx, ny) here is an array of cells that effectively defines the CA grid, with nx cells in the x direction and ny cells in the y direction. To convert this to PIC we need only change the data structure from an array of data to an array of lists of data, and add a further loop: When each list is limited to a single member, this clearly reduces to CA provided each individual is additionally restricted to have only one possible location within each cell. Note that in the PIC case, in addition to keeping the data identifying each individual, we need also to keep track of individual positional data, as this is now not fully determined by the cell in which the individual is located. In a language with user-defined data types (again, a feature of most modern languages, particularly those that are object-oriented) it is straightforward to package the location of each individual into a single variable that contains all the information relevant to that individual. This is in any case convenient, as it allows us to store other relevant data such as age, sex, size, species, and so on. In general several loops of the above kind will be needed: Typically we will require that updates of the data for individuals that include interaction with neighbours, movement from place to place and birth/death of individuals. Then these generally require definition of a neighbourhood, which in the PIC case could be as small as a single cell (but clearly need not be limited to this), since this will often contain a set of neighbours that are closest to the individual concerned (not necessarily true of course for those near the cell boundary). In the CA case we would typically use the Moore or von Neumann neighbourhoods as described above. In the CA case with Moore neighbourhood, our update function might typically look like: Note that this includes self-interaction when i = j =0, a case not normally needed for most CA. However, in the PIC case we need it, as there may be many individuals in a cell. PIC interaction code therefore includes a loop over the lists in each cell. Additionally, the PIC neighbourhood is not necessarily limited to a particular set of cells, but will usually involve looking for all individuals that lie within some interaction region\u2014a further list is thus needed to store those cells that could include individual within the interaction radius of the current individual: Similar code is needed for movement from cell to cell\u2014replacing the interaction with removal from the list of individuals in the current cell and adding to the list of individuals in the cell into which movement is required. For births we need to define the location of new individuals and then allocate them to the appropriate cell to which they will belong, having first checked the neighbouring cells for any overcrowding or other interactions with existing neighbours. This is necessarily more complex than the CA case, where we generally just need to test if the target grid location is occupied or not. Death simply requires we remove the individual from all the lists to which it currently belongs. The above allows for the extension of CA code with minimal additions, but where the occupation of the grid is sparse this might not be the best way to organize the code\u2014a lot of time could be spent looping over empty cells, examining lists that have no members. A slightly different way to organize things is to make all loops iterate over the individuals themselves, only referring to the cells where necessary. This also allows for the easy incorporation of tilings of the domain that are not based on a rectangular grid and simplifies the code. The basic idea is to have a single list on which all individuals are placed. All loops for updating the model now look like We now just need a function to return the relevant list (and lists from neighbouring cells) for each individual, given its current location\u2014easily calculated from the individual's position data in the case of a rectangular array, or else we can store a reference to the cell currently occupied by adding it to the data structure defining each individual. If we have a non-rectangular tiling, or a rectangular array in which only occupied cells are actually instantiated and stored in memory (the PIC:SI case) then we need an extra data-structure as a container for cells. This is most easily done using a hashtable (see e.g. Knuth, 1998)\u2014essentially a list from which cells can be recovered efficiently by using a unique key. For example, in a rectangular grid we can simply label the cells as \u201crow, column\u201d, and then recover the relevant cell, if it exists, by presenting this as a key to the hashtable. A set of functions is required to add and delete cells from the hashtable, in the former case where a cell is needed that has yet to be manufactured, and in the latter case to delete cells that are empty. In non-rectangular tilings each cell needs to keep stored with it a list of keys that define its neighbouring cells to allow recovery of the neighbourhood from the hashtable as required. Note that a flexible system such as this allows for a grid to move across a landscape, potentially indefinitely, dynamically following the individuals either as they move or as they are born and die, only creating grid cells where they are needed. Periodic boundaries can thus be avoided in some cases, particularly those where it simply serves to avoid individuals wandering out of the domain. In Appendix A we give code in Java that makes the above explicit and show how the PIC implementation works in more detail. 4 Simulations In the following a series of simulations were made to examine how the interaction of individuals with finite size, but continuous position (PIC) compare with those of individuals confined to a grid, but with no representation of a size or interaction radius (CA). In the latter case we add the restriction that each cell may only contain a single individual, an assumption common to many CA simulations. In the first two examples we look at movement in a relatively small domain. For the CA case the movement is restricted only when a neighbouring cell is occupied. In the PIC case we use a grid only for organizing the search process, and limit movement only when individuals are liable to collide. The CA in these cases thus looks like interacting particle systems, which are the ecological equivalent of lattice gas automata (Frisch et al., 1986) that have been used for modelling of fluids. Note that unlike lattice gas automata, though, movement is not constrained by the physical processes of momentum and energy conservation, as these can be determined by processes internal to the particles (see e.g. Schweitzer, 2003). Although the second example has some resemblances to the biofilm models of Kreft et al. (1998, 2001), those models do not allow for explicit movement (although there is some shoving to allow cell division)\u2014the individuals are not therefore limited for access to resources by having to navigate around other individuals (their resource being provided by the substrate on which they grow). 4.1 Example one: diffusion and pattern locking in a crowded environment We look first at the effect of individual size on the diffusion properties of a set of identical individuals moving in a bounded two-dimensional domain. To make our comparison we define a pixel unit by considering the CA grid to always have square cells of side 10 units. Sizes in the PIC case may be any fraction or multiple of this unit, as described below. We compare two cellular automaton cases (Moore neighbourhood and von Neumann neighbourhood; see Fig. 2 ) with the continuous-space finite-sized-individual case (individual positions are floating point, so are discretized to approximately on part in 107). For this example we use a relatively small 50\u00d750 grid, and examine rate of diffusion of individuals moving at random in the domain, as represented by the mean square displacement after 25 steps. This allows us to largely eliminate boundary effects by only including those individuals that start more than eight cells from the boundary. Individuals can in all cases only move if they will not conflict with another individual as a result. For the CA case this means that the cell targeted for movement must be empty, and for the continuous (PIC) case that no collision with a neighbour is detected. Movement direction is selected at random. For the PIC case the distance moved is also random, and distributed uniformly to give the same mean square displacement per step as the cellular cases (see Fig. 2). Note that this means that the comparison is model dependent; if we wanted to compare some property other than diffusion, we would need a different scale factor (see the second example below). Initially we lay out the individuals in a grid pattern with uniform spacing in each direction. To allow for some possibility of movement in the cellular cases, we allow some percentage of the initial sites to be unoccupied. This is already a clear difference between the cellular and PIC cases\u2014obviously the PIC individuals can move unless they are completely surrounded by contacting individuals, no matter what the initial void density. In fact as we will see, the diffusion rate depends only on the ratio of individual size to mean initial spacing. For the cellular case, the diffusion coefficient depends instead on the initial void fraction. Note that a change in void fraction is equivalent to re-scaling the grid. For example, a change in the grid scale of a factor of two (and hence increasing the number of grid points by a factor of 4), without changing the number or location of individuals, moves the void fraction from 0 (if all the sites were originally occupied) to 0.25. Fig. 3 shows the PIC diffusion coefficient (as the actual mean square distance diffused per step divided by the potential mean step length (as in Fig. 2)) as a function of the ratio of individual size to mean initial spacing for a series of model runs with initial spacing of 10 units, individual diameters ranging from 0.2 to 10 units, and initial site voidage fraction from 0.1 to 0.9. Each case was run between 10 and 30 times with varying random seed for the individual movement. The curves for all cases lie nearly on top of each other when plotted against (individual size)/(mean initial spacing). At small sizes, individual interactions are very few; the low collision rate means that all individuals can move the full mean step length on nearly every step. However, at large sizes, collisions dominate, and eventually no movement is possible. It might be thought that the arbitrary step length and direction would still lead to faster net movement than the cellular case, but in fact this is not so. The reason can be seen in Fig. 4 ; in the intermediate size range, collisions lead to clumps and chains of particles that form barriers to further movement; these patterns lock the particles in place for a short while (a milder case of the more extreme forms that occur in very restricted environments\u2014Helbing et al., 2001), and make them less mobile than those moving on a fixed grid, where the density cannot rise as high. Fig. 5 makes this comparison explicit. On the vertical axis we plot individual size per mean initial spacing for the PIC case, and on the horizontal filling factor (i.e. the fraction of sites occupied) for the CA. Above the dividing line collisions between PIC individuals are very frequent, and they move less rapidly than in the cellular case. Below the line the PIC mobility is higher, as the small size leads to few collisions, where the restriction of cellular individuals to the grid makes them less able to move easily. The type of neighbourhood for the cellular case proved to make negligible difference to the diffusion provided that the results were scaled as described in Fig. 2. 4.2 Example two: population dynamics and resource gathering The above example shows that there is a non-trivial difference in the ability of gridded and non-gridded individuals to move about a landscape, largely as a result of the formation of clumps and chains of particles in the non-gridded case, arising because the density fluctuations in the non-grid case can be larger. Does this have any real consequences for a model in which the population can change? In this section we present a spatial consumer-resource model similar in form to the sugarscape of Epstein and Axtell (1996), but with some significant differences. We imagine two resource patches separated by a significant distance. Individuals must consume both resources to survive (we might for example think of them as food and water). In each timestep they use up a fixed amount of each resource. They can carry with them a stored amount of each resource, up a maximum amount. Running out of either resource results in death. The result is that they must visit each resource regularly in order to survive, but if they can do this, they survive indefinitely. Since the resource patches are spatially separated, this leads to regular journeys back and forth between the patches. In addition, there is a finite probability in each time step that each individual will \u201cgive birth\u201d, provided space exists. The new individual has to occupy a location next to its progenitor, but not overlapping with it or any other individual. In the CA case this means that there must be an empty cell next to the individual about to give birth. For the PIC case there must simply be room anywhere next to the progenitor. This gives the PIC case much more flexibility in producing new individuals. The birth probability per step is fixed for the duration of the model run: although in practice for large animals the birth rate should probably depend upon the individual encounter rate, the birth probability gives a parameter that can be varied independently in order to find out how the different collision rates in the CA and continuous cases change the population dynamics. New individuals cannot themselves give birth until \u201cmaturity\u201d which is fixed by requiring that they visit each resource patch at least once before producing young. New individuals are given the maximum amount of each resource at the outset. Each model run starts with a single individual. We thus expect there to be quasi-logistic growth of the population; an initial exponential population increase, followed by saturation from two effects: the reduction of space in which to give birth, and the difficulty of reaching the resource patches in a crowded environment, leading to death. In the struggle to reach the resource patches, individuals head as directly as possible for the resource of which they have least. If they collide in this process with another member of the population, they can \u201csidestep\u201d by trying to move at 90\u00b0 randomly left or right, either by one grid cell (in the CA) or one individual diameter (PIC case). If this still leads to collision they stay put for one timestep and then try again. Again, the cellular case (this time using just the Moore neighbourhood) was compared with a continuous movement case using the PIC method. Since movement is now not random, but directed, each step in the cellular case takes the individual one step closer to the required resource patch, unless a sidestep is needed. The PIC case uses random steps uniformly distributed between zero and two CA grid spacings, to give a mean step length of one grid spacing, again in the direction of the required resource unless a sidestep is needed (note the difference from the diffusive case above). To make the model definite, the following sets of parameters were chosen. The resource patches were squares of side 100 units, separated by 200 units. The cell length was 10 units, making the patches 20 model timesteps apart. Maximum resource values for the individuals were set at 80 units for each resource, allowing them to last for four between-resource journey times before running out. We ran the model with birth probability per timestep per individual varying from 0.0005 to 0.25 for approximately 5000 timesteps. For the PIC cases sizes of individuals ranged from 0.2 to 30 units in diameter. The resulting population curves were indeed logistic-like (Fig. 6 ), with rapid initial growth followed by oscillation about a steady mean. To compare the scaling of the two cases with birthrate, we first compare the cellular case with a PIC individual size of five units. In this case the equilibrium mean populations are of similar sizes. In Fig. 7 we plot the steady mean population size as a function of birthrate for these two cases. The figure illustrates two things. Firstly, at low birthrate, the cellular population is larger than the PIC population, and scales upward more rapidly. This is because the PIC collision rate is higher, owing to the smaller sidestepping distance, and the tendency to form clumps. As the birthrate increases above 1/80, however, (the point at which the birthrate per resource consumption time exceeds one) both curves scale more slowly, and the PIC scaling becomes the more rapid as the ability to give birth is less limited by space considerations than in the cellular case. Eventually at very high birthrates (0.1) the PIC model becomes more populous than the cellular case. Notice that there is no saturation at a fixed carrying capacity\u2014the population continues to scale upward with birthrate, indicative of a case where the birth and death rate parameters are controlled by independent processes. The case just discussed was chosen so that the mean populations were of similar size. What happens, however, when the individual size is changed? The results are shown in Fig. 8 ; in the range given, the final mean PIC population scales almost as the inverse power of the individual size. At sizes less then four units the PIC population exceeds the (fixed) CA population of about 40, by a steadily larger amount. The drop in collision rate and the increased availability of space to give birth both allow for the presence of larger populations. However, what sizes should we realistically expect in this problem? If we imagine each timestep to be a day, and each individual to be able to travel 10km in a day, then the resource patch separation would be 200km, and individuals would be able to last just less than three months without one or other resource (perhaps a little optimistic!). With this scaling, the individual size should be about 0.001 units (to give an actual size of about 1m). A more realistic scaling might have individuals able to last about 8 days without either resource. Then the timestep is about 2.4h, and the patches are 20km apart, with a grid cell corresponding to 1km and individual sizes should be 0.01units. For a reasonable birthrate (less than about one per year or so) this implies we are looking at the far left of Fig. 7. Even so, these are much smaller sizes than we have discussed above, implying much larger populations (cf. far left of Fig. 8). Some further investigation suggests that the inverse diameter scaling breaks down below size 0.3, and the equilibrium population at size 0.1 and birthrate 0.0025 exceeds 4000 in the PIC case\u2014a factor over 50 larger than the 10 unit CA grid. Given that in a more detailed model the birthrate probability would be varying with time, the scaling difference between the PIC case and the CA case means that there is no one grid scale that will reproduce the continuous case; the finite size of the individuals introduces a real difference between the two. 4.3 Example 3 forest simulation Up to this point we have looked at examples that are rather small in size and deal with individuals that are capable of movement, with many of the differences between CA and PIC controlled by the existence of finite individual sizes for the PIC case that are ignored in the CA. Here we will examine a much larger model but with individuals fixed to a given location, namely a forest model. A number of individual-based models of forests have become available in recent years, able to track the spatial patterning and time evolution of a number of species, or functional types, over several thousand simulated years. We will use one of these models as an examples for discussing the differences between CA and PIC modelling for forest models. In particular we will look at the changes induced in SORTIE (SORTIE\u2014Pacala et al., 1996) by using PIC or CA methods, using a fixed regular grid as an example of CA, and we will investigate how CA converges to PIC at small cell sizes. In these models the primary mechanism for competition is through shading\u2014each individual affects its neighbours\u2019 access to light and thereby can reduce a neighbour's growth rate and enhance its probability of death. A similar question arises for these models as does for models with moving individuals, namely do any significant differences arise when the locations of individuals are fixed to a subset of possible locations (as in CA, this is the method used, for example, by another forest model, TROLL\u2014Chave, 1999) or are allowed positions that are able to vary down to machine precision (i.e. scales much smaller than the individuals being represented\u2014this is the SORTIE method). According to Chave (1999), the stem density is little affected by grid spacings varying between 0.33 and 2m, but Holt et al. (1995) refer to unpublished studies of the SORTIE model for which re-gridding the tree positions definitely makes a difference. We note here that examination of the code given by Deutschman et al. (1997) for SORTIE reveals that, at least in that version of the code, a PIC system was being used to limit the search process to a sub-area of the domain when calculating shading. Fixing the locations of trees to a grid in this kind of model can have a number of effects. First of all as the grid spacing increases the amount of light available between trees increases, thereby favouring the shade intolerant species (SORTIE) or functional types (TROLL). However, increased spacing between trees allows them to grow to larger sizes, so reducing the available light. The outcome is therefore not immediately apparent without running the model, as it again depends upon the interplay between the spacing between individuals (now fixed once the seedlings have established, although, of course, new seedlings can affect the near neighbour distribution of a given tree) and their relative sizes (now dynamically changing with time). Secondly the trees have species dependent dispersal functions which determine the number and distance distribution of new seedlings relative to the parent. This can be handled in a number of different ways\u2014both SORTIE and TROLL, for example, include tree-species-dependent spatial distribution functions for seedlings, but TROLL includes a seed bank in which seeds may lie dormant for a number of years, whereas SORTIE immediately introduces a new 5-year-old sapling wherever a seedling is required by the distribution function (SORTIE timesteps are 5 years, but in TROLL they are 1 year). The treatment in CA with a seedbank could therefore allow for a single individual to be present as an adult at a given grid location, but have a number of seeds in the seed bank at the same location ready to take over on the adult's death (this method is also used on the fire spread model of Pausas, 2003, for example). Other effects may be apparent: For example where the light is directional the orientation of the grid relative to the direction of maximum sky brightness might play a role. Most obviously, the density of grid-cells in the CA case will limit the density of trees. This may be important only when the typical tree density determined from the competition dynamics could be higher than that provided by the CA\u2014something which may not be known prior to running the model, and then only computable in the CA case by using sensitivity studies with different cell sizes. In this paper we will examine a fairly large domain for this kind of model, namely a square region 2km along each edge, therefore constituting an area of 400ha. It will turn out that this is large enough contain more than 3/4 million tree stems. We will adopt the SORTIE model and first run it in PIC mode as in the original papers, and then fix the trees to a grid with the grid spacing varying from 20m down to 0.5m. So, for the uniform gridded CA, we will need 16 million cells in the latter case. Note that differences between CA and PIC here only arise as a result of fixing the trees to a regular grid\u2014different sizes of tree are permitted in both cases, and the same growth and light extinction rules are used in both cases. For the seedling distribution we will adopt the same distance distribution function for CA and PIC. We will sample the distance distribution function randomly, choose a random angle, and establish the recruit at the resulting co-ordinates if it does not happen to be inside a neighbouring tree trunk. In the CA case this means finding the nearest grid point and establish a new recruit if the grid location is unoccupied. Clearly for the 20m CA grid spacing this will result in a very much reduced number of trees (only 10,000 at a maximum), but we include such cases so that we can examine the effects this has both on the distribution of tree sizes and the relative numbers of the different tree species. In Fig. 9 we plot the total number of stems per hectare, total basal area per hectare and the basal area per hectare broken down by species from the PIC version of SORTIE, run for 1800 years. This should reproduce the results of Pacala et al. (1996) (cf. their Figs. 6 and 7), and indeed it gets the same kind of functional form and the same distribution of species dominance at year 1000 as in their model, although our basal area numbers for Hemlock peak at a slightly larger value than theirs: some differences might be expected as their figures show the average of many runs with varying parameter sets on a smaller domain (9ha), whereas here we show results from a large (400ha) single run. The total basal area curve shows the typical form for this kind of model with a large pulse peaking near year 300, followed by a long slow decline over the next 1000 years or so. By comparison the total number of stems rises gradually to peak much later in the run (near year 1200) and then drops by a small amount (less than 5%) toward year 1800. Thus, the average tree size peaks at about year 100 and declines thereafter. The distribution of basal area by species shows the gradual dominance of shade tolerant species over shade intolerant. In SORTIE yellow birch is the species with the widest dispersal but is shade intolerant, although it shows relatively rapid growth in its early years. It thus tends to serve as a pioneer species, able to colonize gaps in the canopy fairly efficiently. However, it is gradually crowded out by species with short range dispersal (Hemlock and Beech) but high shade tolerance. Hemlock produces more seedlings per unit time than Beech, but has the shortest range dispersal and is less shade tolerant than Beech and is therefore eventually overtaken after about 1800 years. Note, however, that although there are fewer Birch than Beech in early years, the basal area for Birch is larger up to about year 600, indicating larger tree sizes on average. The reader is referred to Pacala et al. (1996) for more detail. In Fig. 10 we show the differences that arise in the tree numbers and basal areas that occur as a result of requiring the trees to take locations fixed to a regular grid as a function of the grid spacing. The first point to note is that the total basal area and number of tree stems is severely decreased at large CA grid spacings. This is to be expected, but the basal area and of the number of stems behave quite differently. In Fig. 10a we can see that for CA spacings greater than 4m the initial surge in area before year 300 is suppressed, leading to a more monotonic area increase. On the other hand, the final basal area after year 1500 for CA spacings of 3\u20135m actually exceeds the PIC value, in spite of the fact that the number of trees is reduced by a factor between 2 and 7. As the area converges toward the PIC case with decreasing separation, the initial surge is recovered, and the final basal area reduced. The number of stems, by contrast, gradually approaches the PIC case, acquiring the slight decrease at later times once the CA spacing is below 1m. Even for grid spacings of 0.5m, however, where the basal area is almost identical to that of the PIC case (Fig. 10a), the number of stems is still reduced by 6% at 1800 years (Fig. 10b), despite the fact that the grid in this last case could easily accommodate the number of stems seen in the PIC run (where the mean tree spacing peaks at approximately 2.5m). In Fig. 11 we plot out the behaviour at year 1800 explicitly. The peak in basal area is clearly visible for spacings less than 5m. The number of stems shows power law behaviour with a best fit slope of approximately 0.36. However, the area per stem scales almost exactly as the square of CA spacing once the CA spacing is below 5m (not shown). This behaviour contrasts with that of TROLL, where the number of stems is nearly constant with grid spacing between 0.5 and 2m (Chave, 1999), possibly as a result of the existence of a seed bank in the TROLL model. Examination of the distribution of tree sizes and ages provides some explanation for this behaviour. We show examples for the PIC and the 5m CA spacing if Fig. 12 . In the CA models, the trees are in general older than in the PIC case (Fig. 12a) as a result of the reduced competition for light. However, the number of trees with dbh less than 0.35m is very much reduced in the CA cases, with a pronounced dip in the size distribution between 0.1 and 0.35m, and very many fewer trees than the PIC case at less than 0.1m (Fig. 12b). The mean age of trees in this case with dbh between 0.1m and 0.35m is near 100 years for PIC, but only 60 years for CA (Fig. 12c). The origin of the dip in size in this range is again reduction in competition\u2014trees in SORTIE grow most rapidly in the intermediate size range, but slow once they become mature. In the CA case they therefore move rapidly through intermediate size ranges and accumulate as mature trees. In the PIC case, the slower intermediate growth rates in the reduced light environment allow this gap in tree sizes to fill in. However, PIC also allows there to be very many more very small trees. These small trees, however, contribute almost nothing to the basal area, which is largely provided by trees with mean dbh 1m (Fig. 12c). Indeed the distribution of contribution to basal area as a function of dbh is almost identical in the two cases. The distribution of trees by species is also affected by the fixing of trees to a grid. In Fig. 13 we show (normalized) histograms of species distribution near year 1800 by basal area and number of stems. The effect of extreme CA spacing is to promote the growth of shade intolerant but rapid growing and widely dispersing trees such as Yellow Birch and White Pine. This is similar to the effect of clear felling portions of the forest in the PIC case, which also benefits the shade intolerant species\u2014see e.g. Deutschman et al. (1997). The shade tolerant trees rapidly take over as CA spacings are reduced, however, and are completely dominant by CA spacings of 3m, both for area and stems, although yellow birch maintains a slightly higher area than Beech up to 4m spacing. Final agreement with PIC is not reached until 0.5m spacing though, at which point, as noted above, the total number of stems is still somewhat less than PIC. 5 Conclusion Although cellular automata are convenient and easy to program, the presence of a fixed grid that bears no relation to the system being modelled may introduce unexpected artifacts. The limitation on the density that can be achieved in individual based models in particular has effects for population dynamics of individuals in crowded environments. Furthermore, it is difficult to achieve the range of scale necessary to both study individuals at their true scale while also allowing them their full range of movement (for animals) or dispersal (for trees), unless one introduces extremely large numbers of cells. In particular, for animals the rate of individual movement as a fraction of their size needs to be explicitly modelled if encounters between individuals are expected. Some of the difficulties of CA can be overcome here if individuals are given a size independent of the grid and the grid is itself only used to restrict movement, but then some of the simplicity of CA (which is, after all, one of its main attractions) is already lost. For intermediate scales of model, a particle-in-cell approach is almost as easy to code, although for moving individuals it requires the addition of a collision detection algorithm. The pay-off is that one can study large numbers of individuals with linear scaling in neighbour detection and interactions where the properties of the individuals determine the dynamics rather than the grid. This also means that direct validation of spatial structures against real world cases can be considered even though large numbers of individuals may be involved, and ranges of movement may be large. However, for large numbers of moving individuals with small sizes relative to their range of movement, dynamic data structures such as the computational-tree structures or PIC:SI are likely to be required. Even so, if there is no way to put a sensible lower limit on the cell size, or if very large differences in the relative sizes of individuals need to be covered, or local spatial interactions are not important in driving the dynamics, other methods than PIC might need to be employed. Other kinds of long range interaction, such as that mediated by sound, long range vision or wind-blown scents are also not easily covered in the method as it stands. Although here we largely compare the PIC method with CA that only allow single cell occupancy, CA with multiple cell occupancy is really rather close to the PIC method, but with the spatial information within the cell discarded. This may be justified in some cases, although it seems, at least for the SORTIE model, to introduce problems (Holt et al., 1995). We would advocate keeping the spatial information and using PIC where possible. One thereby avoids the necessity for sensitivity studies to find out how the model results depend on grid spacing (as in example 3 above). That said, for some kinds of simulation, particularly those where there are so many individuals that they effectively comprise a continuum (e.g. for some kinds of grassland modeling), or where modelling the system using a single density field is appropriate, or where simplicity of implementation remains the overriding consideration, CA methods retain their usefulness. Appendix A Java code for the PIC:SI method We describe a small piece of example code that implements the PIC:SI method. It is written in the Java language, since this provides a convenient set of list/collection classes, and provides garbage collection, so that memory management with the dynamic data structures used here is not much of an issue. Java code still tends to run somewhat more slowly than compiled languages such as C++, but considerably more care may be required with compiled languages to avoid memory leakage. The code comprises four classes \u2014a definition of cells, a container structure to hold the cells (here called \u201cgrid\u201d although it need not be regular in any way, and the cells may have any shape), an individual class to define the objects of ecological interest (e.g. trees or animals) and a control class to run the model. We give only one possible structure for the code required to make the dynamical creation and destruction of cells, and do not go into any detail of interaction between individuals, as this will be specific to the system under consideration. We will give the particular case of an indefinitely large rectangular array of rectangular cells here for illustration, but we indicate how this can be changed for other applications. The implementation does assume, however, that cells tile the domain without overlapping (i.e. no individual can occupy more than one cell, but it must occupy at least one). We assume that only 2D spatial information is required, although the extension to 3D is straightforward. Comments are given in italics and Java keywords in bold. Variables private to a given class are denoted with an initial underscore. We start with cell.java: References Arge et al., 2004 Arge, L., deBerg, M., Haverkort, H.J., Yi, K., 2004. The priority R-tree: a practically efficient and worst case optimal R-tree. Proc. 2004 ACM SIGMOD international conference on Management of data. ACM press, New York, pp. 347\u2013358. Berec, 2002 L. Berec Techniques of spatially explicit individual-based models: construction, simulation, and mean field analysis Ecol. Model. 150 2002 55 81 Birdsall and Langdon, 1991 C.K. Birdsall A.B. Langdon Plasma Physics via Computer Simulation 1991 McGraw-Hill New York Bowyer, 1981 A. Bowyer Computing dirichlet tesselations Comput. J. 24 1981 162 166 Blake et al., 2001 S. Blake I. Douglas-Hamilton W.B. Karesh GPS telemetry of forest elephants in Central Africa: results of a preliminary study Afr. J. Ecol. 39 2001 178 186 Chave, 1999 J. Chave Study of structural, successional and spatial patterns in tropical rain forests using TROLL, a spatially explicit forest model Ecol. Model. 124 1999 233 254 Conway, 1970 J.H. Conway quoted in Gardner, M. The fantastic combinations of John Conway's new solitaire game \u201clife\u201d Sci. Am. 223 1970 120 123 De angelis and Rose, 1992 D.L. De angelis K.A. Rose Which individual based approach is most appropriate for a given problem? D.L. De Angelis L.J. Gross In Individual-Based models and approaches in ecology 1992 Chapman and Hall 67 87 Deutschman et al., 1997 D.H. Deutschman S.A. Levin C. Devine L.A. Buttel Scaling from trees to forest: analysis of a complex simulation model Science 277 1997 1684 Durrett and Levin, 1994 R. Durrett S. Levin The importance of being discrete (and spatial) Theor. Popul. Biol. 46 1994 363 394 Epstein and Axtell, 1996 J.M. Epstein R.L. Axtell Growing Artificial Societies. Social Science from the Bottom Up 1996 MIT Press Flache and Hegselmann, 2001 Flache, A., Hegselmann, R. 2001. Do irregular grids make a difference? Relaxing the spatial regularity assumption in models of social dynamics. Journal of artificial societies and social simulation 4, no. 4, http://www.soc.surrey.ac.uk/JASSS/4/4/6.html. Frisch et al., 1986 U. Frisch B. Hasslacher Y. Pomeau Lattice gas automata for the Navier Stokes equation Phys. Rev. Lett. 56 1986 1505 1508 Ginot et al., 2002 V. Ginot C. Le Page S. Souissi A multi-agents architecture to enhance end-user individual-based modelling Ecol. Model. 157 2002 23 41 Grimm and Railsback, 2005 V. Grimm S.F. Railsback Individual-Based Modeling and Ecology 2005 Princeton University Press Guttman, 1984 Guttman, A., 1984. R-trees: a dynamic index structure for spatial searching. Proc. 1984 ACM SIGMOD international conference on Management of data. ACM press, New York, pp. 47\u201357. Harlow, 1957 F.H. Harlow Hydrodynamic problems involving large fluid distortions J. Assoc. Comp. Mach. 4 2 1957 137 142 Harlow, 1964 F.H. Harlow Particle-in-cell computing method for fluid dynamics Methods Comput. Phys. 3 1964 319 343 Helbing et al., 2001 D. Helbing P. Molnar I.J. Farkas K. Bolay Self organising pedestrian movement Environ. Plan. B: Plan. Des. 28 2001 361 383 Hegselmann and Flache, 1998 Hegselmann, R., Flache, A., 1998. Understanding complex social dynamics: A plea for cellular automata based modelling. J. Artif. Societies Social Simulation 1, no. 3, http://www.soc.surrey.ac.uk/JASSS/1/3/1.html. Hildenbrandt, 2003 Hildenbrandt, H., 2003. Simulationsmodelle zur Untersuchung der Dynamik von Mangrovenwaeldern. PhD. Thesis. Universitaet Bremen. Hogeweg, 1988 P. Hogeweg Cellular Automata as a paradigm for ecological modelling Appl. Math. Comput. 27 1988 81 100 Holt et al., 1995 R.D. Holt S.W. Pacala T.W. Smith J. Liu Linking contemporary vegetation models with spatially explicit animal population models Ecol. Appl. 5 1995 20 27 James et al., 2004 R. James P.G. Bennet J. Krause Geometry for mutualistic and selfish herds: the limited domain of danger J. Theor. Biol. 228 2004 107 113 Keeling, 1999 M.J. Keeling Spatial models of interacting populations J. McGlade Advanced Ecological Theory, Principles and Applications 1999 Blackwell Science 64 99 Keeling et al., 1997 M.J. Keeling I. Mezic R.J. Hendry J. McGalde D.A. Rand Phil. Trans. Biol. Sci. 352 1361 1997 1589 1601 Knuth, 1998 D.E. Knuth The Art of Computer Programming second ed. 1998 Addison-Wesley Kreft et al., 2001 J.-U. Kreft C. Picioreanu J.W. Wimpenny M.C. van Loosdrecht Individual-based modelling of biofilms Microbiology 147 2001 2897 2912 Kreft et al., 1998 J.-U. Kreft G. Booth J.W. Wimpenny BacSim, a simulator for individual-based modelling of bacterial colony growth Microbiology 144 1998 3275 3287 Koumoutsakos, 2005 P. Koumoutsakos Multiscale flow simulations using particles Ann. Rev. Fluid Mech. 37 2005 457 487 Munjiza, 2004 A. Munjiza The Combined Finite-Discrete Element Method 2004 John Wiley & Sons Limited Chichester 348 pp. von Neumann, 1966 J. von Neumann W. Arthur Burks Theory of self-reproducing automata 1966 University of Illinois Press Urbana, IL Pacala et al., 1996 S.W. Pacala C.D. Canham J. Saponara J.A. Silander R.K. Kobe E. Ribbens Forest models defined by field measurements: estimation error analysis and dynamics Ecol. Monogr. 66 1996 1 43 Phipps, 1992 M.J. Phipps From local to global: the lesson of cellular automata D.L. De Angelis L.J. Gross Individual-Based Models and Approaches in Ecology 1992 Chapman and Hall 165 187 Pausas, 2003 J.G. Pausas The effect of landscape pattern on mediterranean vegetation dynamics: a modelling approach using functional types J. Vegetation Sci. 14 2003 365 374 Rand and Wilson, 1995 Rand, D.A., Wilson, H.B., 1995. Using spatio-temporal chaos and intermediate-scale determinism to quantify spatially-extended ecosystems, Proc. R. Soc. Lond., B 259, 111\u2013117. Sakoda, 1971 J.M. Sakoda The checkerboard model of social interaction J. Math. Sociol. 1 1971 119 132 Schelling, 1969 T. Schelling Models of segregation Am. Econ. Rev. 59 1969 488 493 Schelling, 1971 T. Schelling Dynamic models of segregation J. Math. Sociol. 1 1971 143 186 Schweitzer, 2003 F. Schweitzer Brownian Agents and Active Particles: Collective Dynamics in the Natural and Social Sciences 2003 Springer 434 pp. Shewchuk, 1997 J.R. Shewchuk Adaptive precision floating point arithmetic and fast robust geometric predicates Discrete Comput. Geom. 18 1997 305 363 Tipper, 1990 J.C. Tipper A straightforward iterative algorithm for the planar Voronoi diagram Inf. Proc. Lett. 34 1990 155 160 Watson, 1981 D.F. Watson Computing the n-dimensional Delaunay tesselation with application to Voronoi polytopes Comput. J. 24 1981 167 172 Wissel, 2000 C. Wissel Grid-based models as tools for ecological research U. Dieckmann R. Law J.A.J. Metz In the Geometry of Ecological Interaction: Simplifying Spatial Complexity, Cambridge Studies of Adaptive Dynamics 1 2000 Cambridge University Press Wolfram, 2002 S. Wolfram A new kind of science Wolfram media 2002"
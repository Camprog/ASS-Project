"Ecological ModellingUsing artificial neural network for reservoir eutrophication predictionAbstract Reservoirs provide approximately 70% of water supply for domestic and industrial use in Taiwan. The water quality of reservoirs is now one of the key factors in the operation and water quality management of reservoirs. Transient weather patterns result in highly variable magnitudes of precipitation and thereby sharp fluctuations in the surface elevation of the reservoirs. In addition, excessive watershed development in the past two decades has contributed to continuing increase in nutrient loads to the reservoirs. The difficulty in quantifying watershed nutrient loads and uncentainties in kinetic mechanism in the water column present a technical challenge to the mass balance based modeling of reservoir eutrophication. This study offers an alternative approach to quantifying the cause-and-effect relationship in reservoir eutrophication with a data-driven method, i.e., capturing non-linear relationships among the water quality variables in the reservoir. A commonly used back-propagation neural network was used to relate the key factors that influence a number of water quality indicators such as dissolved oxygen (DO), total phosphorus (TP), chlorophyll-a (Chl-a), and secchi disk depth (SD) in a reservoir in central Taiwan. Study results show that the neural network is able to predict these indicators with reasonable accuracy, suggesting that the neural network is a valuable tool for reservoir management in Taiwan.serial JL 271743 291210 291728 291780 291840 31 Ecological Modelling ECOLOGICALMODELLING 2006-09-07 2006-09-07 2010-10-08T02:45:02 1-s2.0-S0304380006002985 S0304-3800(06)00298-5 S0304380006002985 10.1016/j.ecolmodel.2006.06.018 S300 S300.1 FULL-TEXT 1-s2.0-S0304380006X04295 2015-05-14T06:43:49.314216-04:00 0 0 20070110 2007 2006-09-07T00:00:00Z articleinfo crossmark dco dateupdated tomb dateloaded datesearch indexeddate issuelist volumelist yearnav articletitlenorm authfirstinitialnorm authfirstsurnamenorm cid cids contenttype copyright dateloadedtxt docsubtype doctype doi eid ewtransactionid hubeid issfirst issn issnnorm itemstage itemtransactionid itemweight openaccess openarchive pg pgfirst pglast pii piinorm pubdatestart pubdatetxt pubyr sectiontitle sortorder srctitle srctitlenorm srctype subheadings volfirst volissue webpdf webpdfpagecount figure table body mmlmath affil articletitle auth authfirstini authfull authkeywords authlast primabst ref alllist content subj ssids 0304-3800 03043800 200 200 1 2 1 2 Volume 200, Issues 1\u20132 16 171 177 171 177 20070110 10 January 2007 2007-01-10 2007 Research papers article fla Copyright \u00a9 2006 Elsevier B.V. All rights reserved. USINGARTIFICIALNEURALNETWORKFORRESERVOIREUTROPHICATIONPREDICTION KUO J 1 Introduction and purpose 2 Literature review 3 Modeling approach 4 Study area and water quality data 5 Theory of back-propagation neural network 6 Model descriptions 6.1 The parameters of ANNs 6.2 Parameters of training and testing 7 Model results 7.1 TP model results 7.2 SD model results 7.3 DO model results 7.4 Chl-a model results 8 Summary and conclusions References BRION 2001 99 105 G CARLSON 1977 361 369 R CHAPRA 1997 S SURFACEWATERQUALITYMODELING CHEN 1970 1085 1097 C CLAIR 1996 921 927 T DITORO 1971 131 180 D FRENCH 1994 87 94 M COMPUTERTECHNIQUESINENVIRONMENTALSTUDIESVVOLIIENVIRONMENTSYSTEMS MODELINGALGALBLOOMSINFRESHWATERSUSINGARTIFICIALNEURALNETWORKS KARUL 2000 145 152 C LEE 2003 179 210 LEK 1999 65 73 S LEK 1996 36 52 S LUNG 2001 W WATERQUALITYMODELINGFORWASTELOADALLOCATIONSTMDLS MAIER 1998 257 272 H MARTIN 1999 J HYDRODYNAMICSTRANSPORTFORWATERQUALITYMODELING MELESSE 2005 305 314 A 1983 518 MATHEMATICALMODELINGWATERQUALITYSTREAMSLAKESRESERVOIRS RECKNAGEL 1997 11 28 F THOMANN 1987 R PRINCIPLESSURFACEWATERQUALITYMODELINGCONTROL YABUNAKA 1997 89 97 K KUOX2007X171 KUOX2007X171X177 KUOX2007X171XJ KUOX2007X171X177XJ item S0304-3800(06)00298-5 S0304380006002985 1-s2.0-S0304380006002985 10.1016/j.ecolmodel.2006.06.018 271743 2010-11-08T17:29:59.237325-05:00 2007-01-10 1-s2.0-S0304380006002985-main.pdf https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/MAIN/application/pdf/6b7d8524f9ff59495b00ca21fb3312dc/main.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/MAIN/application/pdf/6b7d8524f9ff59495b00ca21fb3312dc/main.pdf main.pdf pdf true 1067979 MAIN 7 1-s2.0-S0304380006002985-main_1.png https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/PREVIEW/image/png/18218c3cc822903b4f247f08ed2cf606/main_1.png https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/PREVIEW/image/png/18218c3cc822903b4f247f08ed2cf606/main_1.png main_1.png png 53317 849 656 IMAGE-WEB-PDF 1 1-s2.0-S0304380006002985-si4.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/STRIPIN/image/gif/739b3f6cf9968d50160fe34bbda16ddb/si4.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/STRIPIN/image/gif/739b3f6cf9968d50160fe34bbda16ddb/si4.gif si4 si4.gif gif 316 16 73 ALTIMG 1-s2.0-S0304380006002985-si3.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/STRIPIN/image/gif/5a787e7b231db16df04d9cc2a7290142/si3.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/STRIPIN/image/gif/5a787e7b231db16df04d9cc2a7290142/si3.gif si3 si3.gif gif 583 37 136 ALTIMG 1-s2.0-S0304380006002985-si2.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/STRIPIN/image/gif/ca479db518433f5ef4f152f737cee224/si2.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/STRIPIN/image/gif/ca479db518433f5ef4f152f737cee224/si2.gif si2 si2.gif gif 566 47 95 ALTIMG 1-s2.0-S0304380006002985-si1.gif https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/STRIPIN/image/gif/522dd137e3985bdb5bf4782d7c3455d7/si1.gif https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/STRIPIN/image/gif/522dd137e3985bdb5bf4782d7c3455d7/si1.gif si1 si1.gif gif 177 13 21 ALTIMG 1-s2.0-S0304380006002985-gr1.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr1/DOWNSAMPLED/image/jpeg/f2bfee7a98c0eabe68dec5086bb6234a/gr1.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr1/DOWNSAMPLED/image/jpeg/f2bfee7a98c0eabe68dec5086bb6234a/gr1.jpg gr1 gr1.jpg jpg 50078 368 648 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006002985-gr1.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr1/THUMBNAIL/image/gif/63763e99ac5354c7a38a9bed3a98d430/gr1.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr1/THUMBNAIL/image/gif/63763e99ac5354c7a38a9bed3a98d430/gr1.sml gr1 gr1.sml sml 1530 71 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006002985-gr2.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr2/DOWNSAMPLED/image/jpeg/bd6b8f10ed66aa640e819fe7ea1d5c68/gr2.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr2/DOWNSAMPLED/image/jpeg/bd6b8f10ed66aa640e819fe7ea1d5c68/gr2.jpg gr2 gr2.jpg jpg 47943 273 559 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006002985-gr2.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr2/THUMBNAIL/image/gif/2fbcb9f4ef05a1b8f884521b4837c205/gr2.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr2/THUMBNAIL/image/gif/2fbcb9f4ef05a1b8f884521b4837c205/gr2.sml gr2 gr2.sml sml 3178 61 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006002985-gr3.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr3/DOWNSAMPLED/image/jpeg/a9225a950c3ebf43398efa997b95c279/gr3.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr3/DOWNSAMPLED/image/jpeg/a9225a950c3ebf43398efa997b95c279/gr3.jpg gr3 gr3.jpg jpg 110648 383 493 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006002985-gr3.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr3/THUMBNAIL/image/gif/54b355d2f4dfa08841dd1aaf631d6778/gr3.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr3/THUMBNAIL/image/gif/54b355d2f4dfa08841dd1aaf631d6778/gr3.sml gr3 gr3.sml sml 5117 93 120 IMAGE-THUMBNAIL 1-s2.0-S0304380006002985-gr4.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr4/DOWNSAMPLED/image/jpeg/dd69aa49a9fd3d72839b23ed88c22c45/gr4.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr4/DOWNSAMPLED/image/jpeg/dd69aa49a9fd3d72839b23ed88c22c45/gr4.jpg gr4 gr4.jpg jpg 51211 349 482 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006002985-gr4.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr4/THUMBNAIL/image/gif/15f3d89e87fcf34473bda5d8271dd1a8/gr4.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr4/THUMBNAIL/image/gif/15f3d89e87fcf34473bda5d8271dd1a8/gr4.sml gr4 gr4.sml sml 3125 90 125 IMAGE-THUMBNAIL 1-s2.0-S0304380006002985-gr5.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr5/DOWNSAMPLED/image/jpeg/03cf8ded0542b9aaa3e8bf01c87b7137/gr5.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr5/DOWNSAMPLED/image/jpeg/03cf8ded0542b9aaa3e8bf01c87b7137/gr5.jpg gr5 gr5.jpg jpg 41880 352 466 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006002985-gr5.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr5/THUMBNAIL/image/gif/35e382a67af8d30eb2bb9f91af522bc0/gr5.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr5/THUMBNAIL/image/gif/35e382a67af8d30eb2bb9f91af522bc0/gr5.sml gr5 gr5.sml sml 2482 94 124 IMAGE-THUMBNAIL 1-s2.0-S0304380006002985-gr6.jpg https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr6/DOWNSAMPLED/image/jpeg/ded1c8f57a1bec344cadfc46f56e797c/gr6.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr6/DOWNSAMPLED/image/jpeg/ded1c8f57a1bec344cadfc46f56e797c/gr6.jpg gr6 gr6.jpg jpg 36296 360 464 IMAGE-DOWNSAMPLED 1-s2.0-S0304380006002985-gr6.sml https://s3.amazonaws.com/prod-ucs-content-store-us-east/content/pii:S0304380006002985/gr6/THUMBNAIL/image/gif/387d7772087cf12a0c6db2744a990c58/gr6.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0304380006002985/gr6/THUMBNAIL/image/gif/387d7772087cf12a0c6db2744a990c58/gr6.sml gr6 gr6.sml sml 1908 93 120 IMAGE-THUMBNAIL ECOMOD 4451 S0304-3800(06)00298-5 10.1016/j.ecolmodel.2006.06.018 Elsevier B.V. Fig. 1 The Te-Chi Reservoir and Water Quality Sampling Stations. Fig. 2 Carlson Index of trophic state for the Te-Chi Reservoir (1983\u20131999). Fig. 3 Landuse of the Te-Chi Reservoir Watershed. Fig. 4 ANN structures of TP, SD, DO, and Chl-a models for the Te-Chi Reservoir. Fig. 5 Training results of TP, SD, DO, and Chl-a models. Fig. 6 Test results of TP, SD, DO, and Chl-a models. Table 1 Neural network parameters MODEL SD TP DO Chl-a Learning rate 0.2\u20130.01 0.2\u20130.01 0.2\u20130.01 0.2\u20130.01 Momentum 0.5 0.5 0.5 0.5 Iteration 2000 2500 4000 5000 Input nodes 2 2 6 8 Output nodes 1 1 1 1 Hidden nodes 4 10 16 20 Using artificial neural network for reservoir eutrophication prediction Jan-Tai Kuo a \u204e kuoj@ntu.edu.tw Ming-Han Hsieh b Wu-Seng Lung c Nian She d a Department of Civil Engineering and Hydrotech Research Institute, National Taiwan University, Taipei 106, Taiwan b Department of Civil Engineering, National Taiwan University, Taipei 106, Taiwan c Department of Civil Engineering, University of Virginia, Charlottesville, Virginia, USA d Seattle Public Utilities, 700 5th Ave. Suite 4900, P.O. Box 34018, Seattle, WA 98124-4018, USA \u204e Corresponding author. Tel.: +886 223621841; fax: +886 223661725. Abstract Reservoirs provide approximately 70% of water supply for domestic and industrial use in Taiwan. The water quality of reservoirs is now one of the key factors in the operation and water quality management of reservoirs. Transient weather patterns result in highly variable magnitudes of precipitation and thereby sharp fluctuations in the surface elevation of the reservoirs. In addition, excessive watershed development in the past two decades has contributed to continuing increase in nutrient loads to the reservoirs. The difficulty in quantifying watershed nutrient loads and uncentainties in kinetic mechanism in the water column present a technical challenge to the mass balance based modeling of reservoir eutrophication. This study offers an alternative approach to quantifying the cause-and-effect relationship in reservoir eutrophication with a data-driven method, i.e., capturing non-linear relationships among the water quality variables in the reservoir. A commonly used back-propagation neural network was used to relate the key factors that influence a number of water quality indicators such as dissolved oxygen (DO), total phosphorus (TP), chlorophyll-a (Chl-a), and secchi disk depth (SD) in a reservoir in central Taiwan. Study results show that the neural network is able to predict these indicators with reasonable accuracy, suggesting that the neural network is a valuable tool for reservoir management in Taiwan. Keywords Artificial neural network Reservoir eutrophication Te-Chi Reservoir 1 Introduction and purpose In the present time, the reservoirs provide about 70% of drinking water for a population of nearly 23 millions and industrial water use in Taiwan. Nutrient loads from excessive watershed development continue to increase, resulting in accelerated eutrophication in many reservoirs. It is difficult to predict the behavior of nutrient enriched water bodies because of the complex physical, chemical and biological processes involved. Mass balance based eutrophication modeling of lakes and reservoirs started over 30 years ago (Chen, 1970; Di Toro et al., 1971; Thomann et al., 1975). With improved understanding of the eutrophication processes as well as advanced computing capabilities, multi-dimensional lake and reservoir hydrodynamic and water quality models have been developed and applied to study water quality problems (Orlob, 1983; Thomann and Mueller, 1987; Chapra, 1997; Martin and McCutcheon, 1999). In these studies, the models are very complex and require a significant amount of field data to support the analysis. The model calibration analysis is usually a daunting task for these models. The purpose of this study is to apply artificial neural networks (ANNs) as an alternative modeling approach to simulate the eutrophication processes. 2 Literature review Unlike many statistically based water quality models, which assume the relationship between response variable and prediction variables are linear and distributed normally, ANNs are able to map the non-linear relationships among variables that are characteristic of ecosystems (Lek et al., 1996). ANNs were first applied to the task of learning to predict algal blooms from water quality databases by French and Recknagel (1994). In their application, a feed-forward ANN was trained to make predictions of abundance of species of phytoplankton in Saidenbach Reservoir, Germany. Clair and Ehrman (1996) used 10 years of data to examine the relationships between climate and geography on discharge and dissolved organic C (DOC) and N (DON) from 15 rivers in Canada's Atlantic region. Recknagel et al. (1997) used 12 years of environment variables and algae data to model the time-variable freshwater system in Lake Kasumigaura. Yabunaka et al. (1997) also applied ANNs to predict algal bloom by simulating the future growth of five phytoplankton species and the chlorophyll-a (Chl-a) concentrations in the same lake. Maier et al. (1998) applied the ANNs for modeling the incidence of cyanobacteria in rivers was and forecasting the occurrence of a species group of cyanobacteria, i.e., Anabaena in River Murray at Morgan, Australia. Lek and Gu\u00e9an (1999) introduced two kinds of ANNs (back-propagation and Kohonen self-organizing network) in ecology. Karul et al. (2000) used a three-layer Levenberg\u2013Marquardt feedforward learning algorithm to model the eutrophication process in three water bodies of Turkey (Keban Dam Reservoir, Mogan and Eymir Lakes). Brion et al. (2001) tried to examine the relationship between multiple interrelated water quality and quantity parameters at the intake to a water treatment facility located on the Delaware River. Lee et al. (2003) used ANN to predict the algal bloom dynamics of the coastal waters of Hong Kong. Melesse and Hanley (2005) used energy fluxes and temperature to train a multilayer and error back-propagation algorithm ANN and to predict the CO2 flux in a simulation study of three different ecosystems (forest, grassland and wheat). 3 Modeling approach None of the above studies match the difficulties encountered in modeling the Te-Chi Reservoir with limited data on the inflows and highly variable water levels. The primary sources of inflows to the Te-Chi Reservoir are precipitation in the typhoon season from June to September and the persistent raining period from April to May. The mean annual precipitation of the Te-Chi Reservoir watershed is 2081mm, over 75% of which takes place during the months from May to October. Steep slopes in the watershed of intensive agricultural activities contribute to significant nutrient loads to the reservoir. The highly transient weather patterns between wet and dry seasons result in the fluctuation of the water surface elevation. For example, a drop of 25m in the water surface in 2 months has been recorded, indicating that the entire water content is replaced in almost 2 months. Considering a number of complicating factors such as limited inflow data, large weather uncertainty, sharp changes of water level of reservoirs, and excessive watershed development, a neural network model may be appropriate to simulate these eutrophications in the Te-Chi Reservoir. The Carlson Index of dissolved oxygen (DO), total phosphorus (TP), chlorophyll-a (Chl-a), and secchi disk depth (SD) are commonly used as indicators of eutrophication of reservoirs. To determine the non-linear relationships between the water quality factors and the eutrophication indicators, an ANN model based on back-propagation training algorithm was chosen for the investigation. The ANN was structured such that the data measurements fed to the input layer, representing forcing functions to control the in-lake bio-chemical processes. Eutrophication indicators such as DO, TP, Chl-a, and SD are represented in the output layers. The input and the output layers are interconnected via a hidden layer consisting of an arbitrary number of neurons. The back-propagation training algorithm is applied to the ANN model to establish the relationship between the input and output through the data collected over several years in the Te-Chi Reservoir. Once trained, the connection weights in the ANN were fixed and the model was validated by assessing its predictive performance on a testing set of data excluded from the training set. 4 Study area and water quality data The Te-Chi Reservoir is located in the downstream of Ta-Chia Creek in central Taiwan (Fig. 1 ). It is the fourth largest (in terms of storage volume) reservoir in Taiwan with a maximum water surface area of 4.54km2 and initial design storage volume of about 232\u00d7106 m3. The annual inflow is about 1.2\u00d7109 m3, about five times the reservoir volume, but over three-fourth comes during the wet season. The watershed area is 592km2. The watershed altitude varies from 3884m (highest mountain) to 1408m (normal water level)\u2014a drop of over 2400m. The slope of main branches in this field are mostly over 50% and the average slope usually exceed 30%. The water quality data used in this study were from 1982 to 1996, obtained from the Commission of the Te-Chi Reservoir Watershed Administration. Fig. 2 shows the Carlson (1977) Trophic State Index (CTSI) of the Te-Chi Reservoir from 1983 to 1999. CTSI is calculated with three variables: secchi disk depth, total phosphorus, and chlorophyll-a. A CTSI value above 50 indicates that, the water body is eutrophic (well-nourished), as shown in Fig. 2 for the Te-Chi Reservoir. Fig. 3 shows the landuse in the Te-Chi Reservoir watershed. Agricultural activities (fruit, vegetables, and tea) are the major source of nutrients and provide excessive nutrient loads to the reservoir. 5 Theory of back-propagation neural network Back-propagation neural network is popular because of its broad applicability to many problem domains such as: principal prediction, classification, and modeling. According to a supervised learning technique in the process, this neural network requires a set of training data in order to learn the relationships among data. The back-propagation neural network architecture consists of two or more layers of neurons connected by weights. The information is captured by the network when input data pass through the hidden layer of neurons to the output layer. The weights connecting from neuron i to neuron j are denoted as w j i . Each neuron calculates its output based on the amount of stimulation it receives from the given input vector x i ; x i is the input of neuron i. The net input of a neuron is calculated as the weighted sum of its inputs, and the output of the neuron is based on some active function, which indicates the magnitude of this net input. So the net output u j from a neuron can be indicated as (1) u j = \u2211 i = 1 p w j i x i This research chooses sigmoid function as its active function. The general form of sigmoid function is: (2) \u03c6 ( v ) = 1 1 + exp ( \u2212 v ) (3) y j = \u03c6 ( u j ) where y j is the output of the jth neuron in any layer. For a given input set, the network produces an output, and this response is compared to the known desired response of each neuron. The weights of the network are then changed to correct or reduce the error between the output of the neuron and the desired response, and this process goes on. The weights are continually changed until the total error of all training set is reduced below the acceptable error or other stop mechanism. The back-propagation neural network, with an algorithm for determining the optimal weights for a given training set of data, has the improved potential of the function approximation when it is learning highly complex and non-linear data because of the increased number of the hidden layer or the neurons in the hidden layers. New weights are calculated by adding a correction to the old weights. 6 Model descriptions 6.1 The parameters of ANNs There are a number of key parameters in back-propagation neural network. First, the number of input units should be determined. This study builds four models in order to predict four indicators; i.e., DO, Chl-a, TP, and SD. The initial values of the weights are assigned randomly based on an input random number seed. The initial values of the weights are determined by a random starting, and randomly set between \u22120.1 and +0.1. This range is chosen where all the models created are able to run. All neural network models used in this study are composed of three layers with nodes in adjacent layers fully connected. That is, only one hidden layer is employed. Since the focus is on single variable forecasting, one output node is exclusively used in the output layer. The number of input nodes and the number of hidden nodes are the two major experimental factors. To speed up the training, or learning, and convergence of the weight values, the learning rate can be adjustably made. It is necessary to have a learning rate that is small enough to converge but large enough that the computing time is reasonable. And it is better not to use a constant learning rate because the error will not smoothly converge to a minimum. Therefore we select the globally adaptive learning rate, where the learning rate is incremented or decremented by a small amount with each weight updated, depending on whether the error decreased or increased, respectively. This study uses a learning rate starting at 0.2 and finally reducing to 0.01. All inputs are standardized between 0.15 and 0.85. As training progresses, weights are modified to minimize the error in the output. At the end of training, the inputs that are most important in prediction have the largest weights while those that are less important have lower weights. Therefore, it is important to standardize the input variables so that the same percentage change in the weighted sum input causes a similar percentage change in the unit output. 6.2 Parameters of training and testing Four prediction models for DO, Chl-a, TP, and SD were built individually. Studies have shown that the cause-and-effect of eutrophication and potential mitigating actions are complex for lakes and impoundments, and are often accomplished with the help of models of various types (Orlob, 1983; Thomann and Mueller, 1987; Chapra, 1997; Martin and McCutcheon, 1999; Lung, 2001). Form those studies we can pre-screen the potential input variables through try-and-error processes. The pre-screen processes only consider the general condition, but the main reaction factors are staying unknown in different place. The field data were divided into training and testing sets randomly. The training set takes three-fourth of the field data, and the testing set takes one-fourth. According to these processes the TP model of the Te-Chi Reservoir is built by the input of PO4 and SS. Inputs of the SD model are month and SS while inputs of the DO model include month, pH, Chl-a, NH4, NO3, and water temperature. The Chl-a model is defined by the input of month, water temperature, pH, DO, SD, SS, NO3, and PO4. Table 1 shows the best parameters of each model. In order to prevent the over training of models, this study chose a study rate from 0.2 to 0.01 and the momentum of 0.5. Fig. 4 shows the structures of models. Each model has different input units, hidden units, and output units. The simplest structures in four models are the SD and TP models with only two input units. The most complex model is the Chl-a model with eight input units. The data used for the analysis were collected between 1982 and 1996. Samples in 1982 were collected on a monthly basis while the data near 1996 were measured seasonally. 7 Model results 7.1 TP model results Figs. 5 and 6 show the results of the TP model training and prediction, respectively. The results show that factors correlated with the TP in the Te-Chi Reservoir are PO4 and SS. The correlation coefficient of training and prediction are 0.88 and 0.83, respectively. Although this model is built for TP, we can still use this model to predict PO4. If we only know the result of TP and SS, we may use the try-and-error method to find the concentration of PO4-P. 7.2 SD model results Generally speaking, SD is usually influenced by water color, turbidity and scum. According to the SD model developed herein, there are two factors that influence the SD in Te-Chi Reservoir. One is suspend solid (SS), and the other is month. In Taiwan, the river is short and steep and brings much sediment during a storm period. And the SS concentration would influence the SD. The most interesting factor is month. The month factor shows that the SD changes seasonally. This factor is used to indicate that some variables change monthly, such as average rain, pollutant type, and waste loading, etc. Fig. 5 shows the results of the training case; the correlation coefficient is 0.85. Fig. 6 is the prediction results; the correlation coefficient is 0.81. 7.3 DO model results Dissolved oxygen (DO) concentration is a most common indicator of the quality of an aquatic ecosystem. The sources of DO in a water body include re-aeration from the atmosphere, photosynthetic oxygen production and DO loading. The sinks include oxidation of carbonaceous and nitrogenous material, sediment oxygen demand and respiration by aquatic plants. According to DO mechanism, we can establish an ANN model by using input of month, pH, Chl-a, NH4-H, NO3-N, and temperature. Fig. 5 is the training results; the correlation coefficient is 0.75. Fig. 6 is the prediction case; the correlation coefficient is 0.72. 7.4 Chl-a model results The growth rate of algae is influenced by sunlight, water temperature, and nutrients. The Chl-a model is related to month, water temperature, pH, DO, SD, SS, NO3, and PO4. According to these factors, we can see that the limiting nutrients of Chl-a are NO3 and PO4. Month, SD, and SS would influence the sunlight intensity in water. Water temperature and DO may indicate how much oxygen is produced by Chl-a. The factor \u201cpH\u201d variable may come from algae production or from upstream basin inflow. Because the photosynthesis is a chemical reaction and pH is a major factor which controls the chemical reaction speed. All factors fit the principle theory of Chl-a growth dynamics. Fig. 5 shows the results of the training case; the correlation coefficient is 0.92. Fig. 6 is the outcome of prediction and the correlation coefficient is 0.86. 8 Summary and conclusions Four ANN models were developed to predict major constituent concentrations of reservoir water quality. The ANN models can preserve non-linear characteristics between input and output variables, which is superior to traditional statistical models. The correlation coefficients between predicted values and measured data are well above 0.7 for these four models. During the modeling process, the best relationships between TP, DO, SD and Chl-a concentrations were found in the Te-Chi Reservoir. The complex mechanism in the Te-Chi Reservoir can be quantified and expressed by these four models. The ANN models established by this research perform well to address the water quality and eutrophication problems of the Te-Chi Reservoir. The modeling approach described in this study for analysis of the eutrophication problem in the Te-Chi Reservoir has yielded useful information for effective water quality management. References Brion et al., 2001 G.M. Brion T.R. Neelakantan S. Lingireddy Using neural networks to predict peak Cryptosporidium concentrations J. AWWA 93 2001 99 105 Carlson, 1977 R.E. Carlson Trophic state index for lake Limnol. Oceanogr. 22 2 1977 361 369 Chapra, 1997 S.C. Chapra Surface Water-Quality Modeling 1997 McGraw-Hill NY p. 844 Chen, 1970 C.W. Chen Concepts and utilities of ecologic model J. Sanitary Eng. Div., ASCE 1970 1085 1097 Clair and Ehrman, 1996 T.A. Clair J.M. Ehrman Variations in discharge and dissolved organic carbon and nitrogen export from terrestrial basins with changes in climate: a neural network approach Limnol. Oceanogr. 41 1996 921 927 Di Toro et al., 1971 D.M. Di Toro D.J. O\u2019Connor R.V. Thomann A dynamic model of phytoplankton population in the Sacramento-San Joaquin Delta Adv. Chem. Ser., Am. Chem. Soc. 106 1971 131 180 French and Recknagel, 1994 M. French F. Recknagel Modeling algal blooms in freshwaters using artificial neural networks P. Zanetti Computer Techniques in Environmental Studies V, vol. II: Environment Systems 1994 Computational Mechanics Publications Boston 87 94 Karul et al., 2000 C. Karul S. Soyupak A.F. Cilesiz N. Akbay E. Germen Case studies on the use of neural networks in eutrophication modelling Ecol. Model. 134 2000 145 152 Lee et al., 2003 Lee H.W. Joseph Y. Huang M. Dickman A.W. Jayawardena Neural network modelling of coastal algal blooms Ecol. Model. 159 2003 179 210 Lek and Gu\u00e9an, 1999 S. Lek J.F. Gu\u00e9an Artificial neural networks as a tool in ecological modeling, an introduction Ecol. Model. 120 1999 65 73 Lek et al., 1996 S. Lek M. Delacoste P. Baran I. Dimopoulos J. Lauga S. Aulagnier Application of neural networks to modelling nonlinear relationships in ecology Ecol. Model. 90 1996 36 52 Lung, 2001 W.S. Lung Water Quality Modeling for Wasteload Allocations and TMDLs 2001 John Wiley & Sons, Inc. Maier et al., 1998 H.R. Maier G.C. Dandy M.D. Burch Use of artificial neural networks for modeling cyano-bacteria Anabaena spp. in River Murray, South Australia Ecol. Model. 105 1998 257 272 Martin and McCutcheon, 1999 J.L. Martin S.C. McCutcheon Hydrodynamics and Transport for Water Quality Modeling 1999 CRC Press Boca Raton, FL, USA p. 794 Melesse and Hanley, 2005 A.M. Melesse R.S. Hanley Artificialneural network application for multi-ecosystem carbon flux simulation Ecol. Model. 189 2005 305 314 Orlob, 1983 G.T. Orlob Mathematical Modeling of Water Quality: Streams, Lakes, and Reservoirs 1983 John Willey & Sons NY 518 Recknagel et al., 1997 F. Recknagel M. French P. Harkonen K.-I. Yabunaka Artificial neural network approach for modeling and prediction of algal blooms Ecol. Model. 96 1997 11 28 Thomann and Mueller, 1987 R.V. Thomann J.A. Mueller Principles of Surface Water Quality Modeling and Control 1987 Harper & Row NY p. 644 Thomann et al., 1975 Thomann, R.V., Di Toro, D.M., Winfield, R.P., O\u2019Connor, D.J., 1975. Mathematical modeling of phytoplankton in Lake Ontario, 1: model development and verification, EPA-600/-75-005, USEPA ERL, Corvallis, OR. Yabunaka et al., 1997 K.-I. Yabunaka M. Hosomi A. Murakami Novel application of a backpropagation artificial neural network model formulated to predict algal bloom Water Sci. Technol. 36 5 1997 89 97"